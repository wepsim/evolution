var sim={systems:[],active:null,index:0};function simhw_add(a){sim.systems.push(a);sim.active=a;sim.index=sim.systems.length-1;check_behavior();compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references();compile_verbals()}function simhw_getActive(){return sim.index}function simhw_setActive(a){if((a>=0)&&(sim.systems.length>=a)){sim.active=sim.systems[a];sim.index=a}compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references();compile_verbals()}function simhw_getActiveByName(d){for(var a=0;a<sim.systems.length;a++){if(sim.systems[a].sim_short_name==d){return a}}return -1}function simhw_active(){return sim.active}function simhw_short_name(){return sim.active.sim_short_name}function simhw_sim_signals(){return sim.active.signals}function simhw_sim_signal(a){return sim.active.signals[a]}function simhw_sim_states(){return sim.active.states}function simhw_sim_state(a){return sim.active.states[a]}function simhw_syntax_behaviors(){return sim.active.behaviors}function simhw_syntax_behavior(a){return sim.active.behaviors[a]}function simhw_sim_components(){return sim.active.components}function simhw_sim_component(a){return sim.active.components[a]}function simhw_internalState(a){return sim.active.internal_states[a]}function simhw_internalState_get(a,d){return sim.active.internal_states[a][d]}function simhw_internalState_set(a,e,d){sim.active.internal_states[a][e]=d}function simhw_internalState_reset(a,d){ep_internal_states[a]=d;sim.active.internal_states[a]=ep_internal_states[a]}function simhw_sim_irInfo(){return sim.active.ir_info}function get_value(a){if(typeof a.value=="function"){return a.value()}else{if(typeof a.default_value=="object"){return a.value}else{return a.value}}}function set_value(a,d){if(typeof a.value=="function"){if(a.value()!=d){a.changed=true}a.value(d)}else{if(typeof a.default_value=="object"){if(a.value!=d){a.changed=true}a.value=d}else{if(a.value!=d){a.changed=true}a.value=d}}}function reset_value(d){if(typeof d.value=="function"){if(d.value()!=d.default_value){d.changed=true}set_value(d,d.default_value)}else{if(typeof d.default_value=="object"){d.changed=true;d.value=Object.create(d.default_value)}else{if(d instanceof Array){d.changed=true;for(var a=0;a<d.length;a++){set_value(d[a],d[a].default_value)}}else{if(d.value!=d.default_value){d.changed=true}set_value(d,d.default_value)}}}}function get_var(a){if(typeof a=="function"){return a()}else{return a}}function set_var(d,a){if(typeof d=="function"){d(a)}else{d=a}}var sim_references={};function compute_references(){for(var a in simhw_sim_signals()){sim_references[a]=simhw_sim_signal(a);simhw_sim_signal(a).changed=false}for(a in simhw_sim_states()){sim_references[a]=simhw_sim_state(a);simhw_sim_state(a).changed=false}}function get_reference(a){return sim_references[a]}function show_verbal(d){var a=simhw_sim_state(d);if(typeof a=="undefined"){a=simhw_sim_signal(d)}if("undefined"==typeof a){return d}if("undefined"==typeof a.verbal){return d}return a.verbal}function show_value(a){if(isNaN(a)){return"NaN"}return"0x"+(a>>>0).toString(16)}function check_behavior(){if(0==simhw_sim_signals().length){alert("ALERT: empty signals!!!")}if(0==simhw_sim_states().length){alert("ALERT: empty states!!!")}for(var k in simhw_sim_signals()){for(var h in simhw_sim_signal(k).behavior){var a=simhw_sim_signal(k).behavior[h].split(";");for(var g=0;g<a.length;g++){var e=a[g].trim();var d=e.split(" ");if(""==e){continue}if(typeof(simhw_syntax_behavior(d[0]))=="undefined"){alert("ALERT: Unknown operation -> "+d[0]+" ("+e+")");return}if(d.length!=simhw_syntax_behavior(d[0]).nparameters){alert("ALERT: Behavior has an incorrect number of elements --> "+e+"/"+simhw_syntax_behavior(d[0]).nparameters);return}for(var f=1;f<d.length;f++){var n=d[f].split("/");var m=simhw_syntax_behavior(d[0]).types[f-1];if(("E"==m)&&(typeof simhw_sim_state(n[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state -> '"+e);return}else{if(("S"==m)&&(typeof simhw_sim_signal(n[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a signal -> '"+e);return}else{if(("X"==m)&&(typeof simhw_sim_state(n[0])=="undefined")&&(typeof simhw_sim_signal(n[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state OR signal -> '"+e);return}}}}}}}}var jit_behaviors=false;var jit_verbals=false;var jit_fire_dep=null;var jit_fire_order=null;var jit_dep_network=null;var jit_fire_ndep=null;function firedep_to_fireorder(d){var a=false;jit_fire_order=new Array();jit_fire_ndep=new Array();for(var f in simhw_sim_signals()){if(typeof d[f]=="undefined"){jit_fire_order.push(f);continue}ndep=0;a=false;for(var e in d[f]){ndep++;if(d[f][e]==simhw_sim_signal(e).behavior.length){a=true}}jit_fire_ndep[f]=ndep;if(a==false){jit_fire_order.push(f)}}}function compile_behaviors(){var jit_bes="";jit_fire_dep=new Object();var sig_obj=null;var expr_obj=null;for(var sig in simhw_sim_signals()){jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn = new Array();\n";for(var val in simhw_sim_signal(sig).behavior){var input_behavior=simhw_sim_signal(sig).behavior[val];var jit_be="";var s_exprs=input_behavior.split(";");for(var i=0;i<s_exprs.length;i++){s_exprs[i]=s_exprs[i].trim();if(""==s_exprs[i]){continue}var s_expr=s_exprs[i].split(" ");if(s_expr[0]!="NOP"){jit_be+="simhw_syntax_behavior('"+s_expr[0]+"').operation("+JSON.stringify(s_expr)+");\t"}if("FIRE"==s_expr[0]){sig_obj=simhw_sim_signal(sig);expr_obj=simhw_sim_signal(s_expr[1]);if(typeof expr_obj=="undefined"){alert("ERROR: for signal '"+sig+"', unknow behavior '"+s_exprs[i]+"'")}else{if(sig_obj.type==expr_obj.type){if(typeof jit_fire_dep[s_expr[1]]=="undefined"){jit_fire_dep[s_expr[1]]=new Object()}if(typeof jit_fire_dep[s_expr[1]][sig]=="undefined"){jit_fire_dep[s_expr[1]][sig]=0}jit_fire_dep[s_expr[1]][sig]++}}}}jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn["+val+"] = \t function() {"+jit_be+"};\n"}}eval(jit_bes);jit_behaviors=true}function compute_behavior(e){var f=e.split(";");for(var d=0;d<f.length;d++){f[d]=f[d].trim();if(""==f[d]){continue}var a=f[d].split(" ");simhw_syntax_behavior(a[0]).operation(a)}}function compute_general_behavior(a){if(jit_behaviors){simhw_syntax_behavior(a).operation()}else{compute_behavior(a)}}function compute_signal_behavior(d,a){if(jit_behaviors){simhw_sim_signal(d).behavior_fn[a]()}else{compute_behavior(simhw_sim_signal(d).behavior[a])}}function compile_verbals(){var jit_vbl="";for(var sig in simhw_sim_signals()){jit_vbl+="simhw_sim_signal('"+sig+"').verbal_fn = new Array();\n";for(var val in simhw_sim_signal(sig).behavior){var input_behavior=simhw_sim_signal(sig).behavior[val];var jit_be=' var r = ""; ';var s_exprs=input_behavior.split(";");for(var i=0;i<s_exprs.length;i++){s_exprs[i]=s_exprs[i].trim();if(""==s_exprs[i]){continue}var s_expr=s_exprs[i].split(" ");jit_be+=" r = r + simhw_syntax_behavior('"+s_expr[0]+"').verbal("+JSON.stringify(s_expr)+");\t"}jit_vbl+="simhw_sim_signal('"+sig+"').verbal_fn["+val+"] = \t function() {"+jit_be+" return r; };\n"}}eval(jit_vbl);jit_verbals=true}function compute_verbal(e){var f="";var g=e.split(";");for(var d=0;d<g.length;d++){g[d]=g[d].trim();if(""==g[d]){continue}var a=g[d].split(" ");f=f+simhw_syntax_behavior(a[0]).verbal(a)}return f}function compute_signal_verbals(f,a){var e="";var g=null;g=simhw_sim_signal(f);if(typeof g.behavior=="undefined"){return e}var d=g.behavior.length-1;if(a<d){d=a}if((typeof g.verbal!="undefined")&&(typeof g.verbal[d]!="undefined")){return g.verbal[d]}if(jit_behaviors){e=g.verbal_fn[d]()}else{e=compute_verbal(g.behavior[d])}return e}var ep_components={};var ep_states={};var ep_events={};var ep_signals={};var ep_behaviors={};var ep_internal_states={};var ep_ir={};var ep_def={sim_name:"Elemental Processor",sim_short_name:"ep",sim_img_processor:"images/ep/processor6.svg",sim_img_controlunit:"images/ep/controlunit6.svg",sim_img_cpu:"images/ep/cpu6.svg",components:ep_components,states:ep_states,signals:ep_signals,behaviors:ep_behaviors,events:ep_events,internal_states:ep_internal_states,ir_info:ep_ir};simhw_add(ep_def);ep_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+ep_signals[a[1]].value.toString(16))},verbal:function(a){return"Print value of signal "+a[1]+": 0x"+ep_signals[a[1]].value.toString(16)+". "}};ep_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+ep_states[a[1]].value.toString(16))},verbal:function(a){return"Print value of state "+a[1]+": 0x"+ep_states[a[1]].value.toString(16)+". "}};ep_components.CPU={name:"CPU",version:"1",abilities:["CPU"],write_state:function(e){if(typeof e.CPU=="undefined"){e.CPU={}}var a=["PC","SR"];var f=0;for(var d=0;d<ep_states.BR.length;d++){f=parseInt(ep_states.BR[d].value);if(f!=0){e.CPU["R"+d]={type:"register",default_value:0,id:"R"+d,op:"=",value:"0x"+f.toString(16)}}}for(d=0;d<a.length;d++){f=parseInt(ep_states["REG_"+a[d]].value);if(f!=0){e.CPU[a[d]]={type:"register",default_value:0,id:a[d],op:"=",value:"0x"+f.toString(16)}}}return e},read_state:function(e,a){if(typeof e.CPU=="undefined"){e.CPU={}}var d=a.id.toUpperCase().trim();var f=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){e.CPU[d]={type:"register",default_value:0,id:d,op:a.condition,value:"0x"+f};return true}return false},get_state:function(d){var e=d.toUpperCase().trim();if(typeof ep_states["REG_"+e]!="undefined"){return"0x"+get_value(ep_states["REG_"+e]).toString(16)}e=e.replace("R","");var a=parseInt(e);if(typeof ep_states.BR[a]!="undefined"){return"0x"+get_value(ep_states.BR[a]).toString(16)}return null}};ep_ir.default_eltos={co:{begin:0,end:5,length:6},cop:{begin:28,end:31,length:4}};ep_internal_states.MC={};ep_internal_states.MC_dashboard={};ep_internal_states.ROM={};ep_internal_states.FIRMWARE={};ep_internal_states.io_hash={};ep_internal_states.fire_stack=[];ep_internal_states.tri_state_names=["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11"];ep_internal_states.fire_visible={databus:false,internalbus:false};ep_internal_states.filter_states=["REG_IR_DECO,col-12","REG_IR,col","REG_PC,col","REG_MAR,col","REG_MBR,col","REG_RT1,col","REG_RT2,col","REG_RT3,col","REG_SR,col","REG_MICROADDR,col"];ep_internal_states.filter_signals=["A0,0","B,0","C,0","SELA,5","SELB,5","SELC,2","SELCOP,0","MR,0","MC,0","C0,0","C1,0","C2,0","C3,0","C4,0","C5,0","C6,0","C7,0","T1,0","T2,0","T3,0","T4,0","T5,0","T6,0","T7,0","T8,0","T9,0","T10,0","T11,0","M1,0","M2,0","M7,0","MA,0","MB,0","SELP,0","LC,0","SE,0","SIZE,0","OFFSET,0","BW,0","R,0","W,0","TA,0","TD,0","IOR,0","IOW,0","TEST_I,0","TEST_U,0"];ep_internal_states.alu_flags={flag_n:0,flag_z:0,flag_v:0,flag_c:0};ep_states.BR=[];ep_states.BR[0]={name:"R0",verbal:"Register 0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[1]={name:"R1",verbal:"Register 1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[2]={name:"R2",verbal:"Register 2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[3]={name:"R3",verbal:"Register 3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[4]={name:"R4",verbal:"Register 4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[5]={name:"R5",verbal:"Register 5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[6]={name:"R6",verbal:"Register 6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[7]={name:"R7",verbal:"Register 7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[8]={name:"R8",verbal:"Register 8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[9]={name:"R9",verbal:"Register 9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[10]={name:"R10",verbal:"Register 10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[11]={name:"R11",verbal:"Register 11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[12]={name:"R12",verbal:"Register 12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[13]={name:"R13",verbal:"Register 13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[14]={name:"R14",verbal:"Register 14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[15]={name:"R15",verbal:"Register 15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[16]={name:"R16",verbal:"Register 16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[17]={name:"R17",verbal:"Register 17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[18]={name:"R18",verbal:"Register 18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[19]={name:"R19",verbal:"Register 19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[20]={name:"R20",verbal:"Register 20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[21]={name:"R21",verbal:"Register 21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[22]={name:"R22",verbal:"Register 22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[23]={name:"R23",verbal:"Register 23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[24]={name:"R24",verbal:"Register 24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[25]={name:"R25",verbal:"Register 25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[26]={name:"R26",verbal:"Register 26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[27]={name:"R27",verbal:"Register 27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[28]={name:"R28",verbal:"Register 28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[29]={name:"R29",verbal:"Register 29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[30]={name:"R30",verbal:"Register 30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[31]={name:"R31",verbal:"Register 31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_PC={name:"PC",verbal:"Program Counter Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MAR={name:"MAR",verbal:"Memory Address Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MBR={name:"MBR",verbal:"Memory Data Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_IR={name:"IR",verbal:"Instruction Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT1={name:"RT1",verbal:"Temporal 1 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT2={name:"RT2",verbal:"Temporal 2 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT3={name:"RT3",verbal:"Temporal 3 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_SR={name:"SR",verbal:"State Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_IB={name:"I_BUS",verbal:"Internal Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_AB={name:"A_BUS",verbal:"Address Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_CB={name:"C_BUS",verbal:"Control Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_DB={name:"D_BUS",verbal:"Data Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.C2_T2={name:"C2_T2",verbal:"Output of PC",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RA_T9={name:"RA_T9",verbal:"Input of T9 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RB_T10={name:"RB_T10",verbal:"Input of T10 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELEC_T3={name:"SELEC_T3",verbal:"Input of T3 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELP_M7={name:"SELP_M7",verbal:"Output of MUX SelP",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.ALU_C6={name:"ALU_C6",verbal:"Input of Temporal 3 Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MA_ALU={name:"MA_ALU",verbal:"Input ALU via MA",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MB_ALU={name:"MB_ALU",verbal:"Input ALU via MB",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.FLAG_C={name:"FLAG_C",verbal:"Flag Carry",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_V={name:"FLAG_V",verbal:"Flag Overflow",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_N={name:"FLAG_N",verbal:"Flag Negative",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_Z={name:"FLAG_Z",verbal:"Flag Zero",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_I={name:"FLAG_I",verbal:"Flag Interruption",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_U={name:"FLAG_U",verbal:"Flag User",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.REG_MICROADDR={name:"µADDR",verbal:"Microaddress Register",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};ep_states.REG_MICROINS={name:"µINS",verbal:"Microinstruction Register",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};ep_states.FETCH={name:"FETCH",verbal:"Input Fetch ",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.ROM_MUXA={name:"ROM_MUXA",verbal:"Input ROM ",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.SUM_ONE={name:"SUM_ONE",verbal:"Input next microinstruction ",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};ep_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",verbal:"Input microaddress from microinstruction",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.MUXC_MUXB={name:"MUXC_MUXB",verbal:"Output of MUX C",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.INEX={name:"INEX",verbal:"Illegal Instruction Exception",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.BS_M1={name:"BS_M1",verbal:"from Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BS_TD={name:"BS_TD",verbal:"Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.INTV={name:"INTV",verbal:"Interruption Vector",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};ep_states.M2_C2={name:"M2_C2",verbal:"Input of Program Counter",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M1_C1={name:"M1_C1",verbal:"Input of Memory Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M7_C7={name:"M7_C7",verbal:"Input of State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.VAL_ZERO={name:"VAL_ZERO",verbal:"Wired Zero",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.VAL_ONE={name:"VAL_ONE",verbal:"Wired One",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};ep_states.VAL_FOUR={name:"VAL_FOUR",verbal:"Wired Four",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};ep_states.REG_IR_DECO={name:"IR_DECO",verbal:"Instruction Decoded",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};ep_states.DECO_INS={name:"DECO_INS",verbal:"Instruction decoded in binary",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.CLK={name:"CLK",verbal:"Clock",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE B;","MBIT MUXC_MUXB INT 0 1; FIRE B;","MBIT MUXC_MUXB IORDY 0 1; FIRE B;","MBIT MUXC_MUXB MRDY 0 1; FIRE B;","MBIT MUXC_MUXB REG_SR 0 1; FIRE B;","MBIT MUXC_MUXB REG_SR 1 1; FIRE B;","MBIT MUXC_MUXB REG_SR 28 1; FIRE B;","MBIT MUXC_MUXB REG_SR 29 1; FIRE B;","MBIT MUXC_MUXB REG_SR 30 1; FIRE B;","MBIT MUXC_MUXB REG_SR 31 1; FIRE B;","MV MUXC_MUXB INEX; FIRE B;"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};ep_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};ep_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A0 1; FIRE A0A1","SBIT A0A1 A0 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};ep_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A1 0; FIRE A0A1","SBIT A0A1 A1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};ep_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["ADD MUXA_MICROADDR REG_MICROADDR VAL_ONE","CP_FIELD MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};ep_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};ep_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};ep_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_PC M2_C2; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3485"]],draw_name:[["svg_p:path3177"]]};ep_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339"]],draw_name:[["svg_p:path3337"]]};ep_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT1 BUS_IB"],fire_name:["svg_p:text3441"],draw_data:[["svg_p:path3263"]],draw_name:[["svg_p:path3255"]]};ep_signals.C5={name:"C5",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT2 BUS_IB"],fire_name:["svg_p:text3443"],draw_data:[["svg_p:path3277"]],draw_name:[["svg_p:path3269"]]};ep_signals.C6={name:"C6",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT3 ALU_C6"],fire_name:["svg_p:text3445"],draw_data:[["svg_p:path3325","svg_p:path3323"]],draw_name:[["svg_p:path3245"]]};ep_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};ep_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};ep_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB BS_TD; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3515","svg_p:path3071","svg_p:path3419","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3491","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};ep_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};ep_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};ep_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};ep_signals.T4={name:"T4",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT1; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3453"],draw_data:[["svg_p:path3261","svg_p:path3259","svg_p:path3049"]],draw_name:[["svg_p:path3305"]]};ep_signals.T5={name:"T5",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT2; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3455"],draw_data:[["svg_p:path3275","svg_p:path3273","svg_p:path3049"]],draw_name:[["svg_p:path3307"]]};ep_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_C6; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049"]],draw_name:[["svg_p:path3319"]]};ep_signals.T7={name:"T7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3459"],draw_data:[["svg_p:path3327","svg_p:path3311","svg_p:path3049"]],draw_name:[["svg_p:path3313"]]};ep_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};ep_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};ep_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};ep_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","CP_FIELD BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3145","svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};ep_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BS_M1"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};ep_signals.M2={name:"M2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M2_C2 BUS_IB","ADD M2_C2 REG_PC VAL_FOUR"],depends_on:["C2"],fire_name:["svg_p:text3471"],draw_data:[["svg_p:path3217","svg_p:path3215","svg_p:path3213","svg_p:path3213-9"],["svg_p:path3211","svg_p:path3209","svg_p:path3193","svg_p:path3207","svg_p:path3197","svg_p:path3201"]],draw_name:[[],["svg_p:path3467","svg_p:path3467"]]};ep_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 SELP_M7"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};ep_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU REG_RT1; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};ep_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_RT2; FIRE COP","MV MB_ALU VAL_FOUR; FIRE COP","MV MB_ALU VAL_ONE; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"],["svg_p:path3295","svg_p:path3293"],["svg_p:path3297","svg_p:path3299"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};ep_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"4",forbidden:true,behavior:["NOP_ALU; UPDATE_NZVC","AND ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","OR ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","NOT ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","XOR ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRA ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RR ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","ADD ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SUB ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MUL ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","DIV ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MOD ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","LUI ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};ep_signals.SELP={name:"SELP",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["NOP","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_U 0; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_I 1; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_C 31; SBIT SELP_M7 FLAG_V 30; SBIT SELP_M7 FLAG_N 29; SBIT SELP_M7 FLAG_Z 28; FIRE M7"],fire_name:["svg_p:text3703"],draw_data:[[],["svg_p:path3643"],["svg_p:path3705"],["svg_p:path3675","svg_p:path3331"]],draw_name:[[],["svg_p:path3697"]]};ep_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RA;"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};ep_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RB;"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};ep_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RC;"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};ep_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE MC;"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};ep_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};ep_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};ep_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};ep_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};ep_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};ep_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE","MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE"],depends_on:["T3"],fire_name:["svg_p:text3593","svg_p:text3431"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};ep_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};ep_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};ep_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 4; FIRE COP;","CP_FIELD COP REG_MICROINS/SELCOP; FIRE COP;"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};ep_signals.MR={name:"MR",verbal:["Copy from IR[SelA], from IR[SelB], and from IR[SelB] into RA, RB, and RC. ","Copy SelA, SelB, and SelB into RA, RB, and RC. "],visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC;","MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC;"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_cu:text3222","svg_cu:text3242","svg_cu:text3254","svg_cu:text3172-1"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260","svg_cu:path3196","svg_cu:path3278","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3270","svg_cu:path3282","svg_cu:path3300","svg_cu:path3258","svg_cu:path3260","svg_cu:path3258-4","svg_cu:path3278","svg_cu:path3196","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220","svg_cu:path3240","svg_cu:path3252"]]};ep_signals.MR_RA={name:"MR_RA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 5; FIRE RA;","CP_FIELD RA REG_MICROINS/SELA; FIRE RA;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RB={name:"MR_RB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 5; FIRE RB;","CP_FIELD RB REG_MICROINS/SELB; FIRE RB;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RC={name:"MR_RC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 5; FIRE RC;","CP_FIELD RC REG_MICROINS/SELC; FIRE RC;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.BW={name:"BW",verbal:["Select one byte (based on A1A0) from Word. ","Select two bytes (one Half Word based on A1A0) from Word. ","","Select the full Word. "],visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW"],fire_name:["svg_p:text3433"],draw_data:[["svg_p:path3061-2-6","svg_p:path3101-8","svg_p:path3535-8"]],draw_name:[[],[]]};ep_signals.A1A0={name:"A1A0",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA"],fire_name:["svg_p:text3603"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.BWA={name:"BWA",visible:false,type:"L",value:0,default_value:0,nbits:"4",behavior:["BSEL BS_TD 0 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 8 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 24 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W"],fire_name:["svg_p:text3533-5"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.SBWA={name:"SBWA",visible:false,type:"L",value:0,default_value:0,nbits:"5",behavior:["BSEL BS_M1 0 8 BUS_DB 0; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","BSEL BS_M1 0 8 BUS_DB 0; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS KBD_IOR 0 1 IOR; MOVE_BITS SCR_IOR 0 1 IOR; FIRE KBD_IOR; FIRE SCR_IOR"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3733","svg_p:path3491","svg_p:text3715"]],draw_name:[[],[]]};ep_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW; MOVE_BITS IO_IOW 0 1 IOW; FIRE IO_IOW;"],fire_name:["svg_p:text3717"],draw_data:[[],["svg_p:path3735","svg_p:path3491","svg_p:text3717"]],draw_name:[[],[]]};ep_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_C VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};ep_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_V VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};ep_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_N VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};ep_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_Z VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};ep_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_I VAL_ONE; FIRE_IFSET SELP 2"],depends_on:["CLK"],fire_name:["svg_p:text3669"],draw_data:[["svg_p:text3669"]],draw_name:[[]]};ep_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE_IFSET SELP 1","MV FLAG_U VAL_ONE; FIRE_IFSET SELP 1"],depends_on:["CLK"],fire_name:["svg_p:text3669-1"],draw_data:[["svg_p:text3669-1"]],draw_name:[[]]};ep_signals.TEST_INTV={name:"TEST_INTV",visible:true,type:"L",value:0,default_value:0,nbits:"8",forbidden:true,behavior:["MBIT INTV TEST_INTV 0 32"],depends_on:["INT"],fire_name:["svg_p:tspan4225"],draw_data:[["svg_p:path3749"]],draw_name:[[]]};ep_behaviors.NOP={nparameters:1,operation:function(a){},verbal:function(a){return""}};ep_behaviors.NOP_ALU={nparameters:1,operation:function(a){ep_internal_states.alu_flags.flag_n=0;ep_internal_states.alu_flags.flag_z=0;ep_internal_states.alu_flags.flag_c=0;ep_internal_states.alu_flags.flag_v=0},verbal:function(a){return""}};ep_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(a){var d=get_reference(a[2]);var e=get_value(d);return"Copy from "+show_verbal(a[2])+" to "+show_verbal(a[1])+" value "+show_value(e)+". "}};ep_behaviors.LOAD={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(a){var d=get_reference(a[2]);var e=get_value(d);return"Load from "+show_verbal(a[2])+" to "+show_verbal(a[1])+" value "+show_value(e)+". "}};ep_behaviors.CP_FIELD={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);newval=newval[r[1]];if(typeof newval!="undefined"){sim_elto_dst=get_reference(a[1]);set_value(sim_elto_dst,newval)}},verbal:function(a){var e=a[2].split("/");var d=get_reference(e[0]);var f=get_value(d);f=f[e[1]];if(typeof f=="undefined"){return""}return"Copy from Field "+e[1]+" of "+show_verbal(e[0])+" to "+show_verbal(a[1])+" value "+show_value(f)+". "}};ep_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(ep_signals[a[1]],Math.abs(get_value(ep_states[a[2]])-1))},verbal:function(a){var d=Math.abs(get_value(ep_states[a[2]])-1);return"Set "+show_verbal(a[1])+" with value "+show_value(d)+" (Logical NOT of "+a[2]+"). "}};ep_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(ep_states[a[1]],get_value(ep_states[a[2]][ep_signals[a[3]].value]))},verbal:function(a){var d=get_value(ep_states[a[2]][ep_signals[a[3]].value]);return"Set "+show_verbal(a[1])+" with value "+show_value(d)+" (Register File "+a[3]+"). "}};ep_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(ep_states[a[1]][ep_signals[a[2]].value],get_value(ep_states[a[3]]))},verbal:function(e){var f=get_value(ep_states[e[3]]);var d=ep_states[e[1]][ep_signals[e[2]].value];var a=d.name;if(typeof d.verbal!="undefined"){a=d.verbal}return"Copy to "+a+" the value "+show_value(f)+". "}};ep_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(ep_states[d[2]])&get_value(ep_states[d[3]]);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])&get_value(ep_states[d[3]]);return"ALU AND with result "+show_value(a)+". "}};ep_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(ep_states[d[2]])|get_value(ep_states[d[3]]);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])|get_value(ep_states[d[3]]);return"ALU OR with result "+show_value(a)+". "}};ep_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(d){var a=~(get_value(ep_states[d[2]]));set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=~(get_value(ep_states[d[2]]));return"ALU NOT with result "+show_value(a)+". "}};ep_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(ep_states[d[2]])^get_value(ep_states[d[3]]);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])^get_value(ep_states[d[3]]);return"ALU XOR with result "+show_value(a)+". "}};ep_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(ep_states[d[2]]))>>>1;set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))>>>1;return"ALU Shift Right Logical with result "+show_value(a)+". "}};ep_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(ep_states[d[2]]))>>1;set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))>>1;return"ALU Shift Right Arithmetic with result "+show_value(a)+". "}};ep_behaviors.SL={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(ep_states[d[2]]))<<1;set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=((a)>>>31)},verbal:function(d){var a=(get_value(ep_states[d[2]]))<<1;return"ALU Shift Left with result "+show_value(a)+". "}};ep_behaviors.RR={nparameters:3,types:["E","E"],operation:function(d){var a=((get_value(ep_states[d[2]]))>>>1)|(((get_value(ep_states[d[2]]))&1)<<31);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(ep_states[d[2]]))>>>1)|(((get_value(ep_states[d[2]]))&1)<<31);return"ALU Right Rotation with result "+show_value(a)+". "}};ep_behaviors.RL={nparameters:3,types:["E","E"],operation:function(d){var a=((get_value(ep_states[d[2]]))<<1)|(((get_value(ep_states[d[2]]))&2147483648)>>>31);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(ep_states[d[2]]))<<1)|(((get_value(ep_states[d[2]]))&2147483648)>>>31);return"ALU Left Rotation with result "+show_value(a)+". "}};ep_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f+e;set_value(ep_states[g[1]],d>>>0);ep_internal_states.alu_flags.flag_n=(d<0)?1:0;ep_internal_states.alu_flags.flag_z=(d==0)?1:0;ep_internal_states.alu_flags.flag_c=(f>>>31)&&(e>>>31);ep_internal_states.alu_flags.flag_v=0;if((d<0)&&(f>=0)&&(e>=0)){ep_internal_states.alu_flags.flag_v=1}if((d>=0)&&(f<0)&&(e<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f+e;return"ALU ADD with result "+show_value(d)+". "}};ep_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f-e;set_value(ep_states[g[1]],d>>>0);ep_internal_states.alu_flags.flag_n=(d<0)?1:0;ep_internal_states.alu_flags.flag_z=(d==0)?1:0;ep_internal_states.alu_flags.flag_c=(f>>>31)&&(e>>>31);ep_internal_states.alu_flags.flag_v=0;if((d<0)&&(f>=0)&&(e>=0)){ep_internal_states.alu_flags.flag_v=1}if((d>=0)&&(f<0)&&(e<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f-e;return"ALU SUB with result "+show_value(d)+". "}};ep_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f*e;set_value(ep_states[g[1]],d>>>0);ep_internal_states.alu_flags.flag_n=(d<0)?1:0;ep_internal_states.alu_flags.flag_z=(d==0)?1:0;ep_internal_states.alu_flags.flag_c=0;ep_internal_states.alu_flags.flag_v=0;if((d<0)&&(f>=0)&&(e>=0)){ep_internal_states.alu_flags.flag_v=1}if((d>=0)&&(f<0)&&(e<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f*e;return"ALU MUL with result "+show_value(d)+". "}};ep_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(g){var f=(get_value(ep_states[g[2]])<<0);var e=(get_value(ep_states[g[3]])<<0);if(0==e){set_value(ep_states[g[1]],0);ep_internal_states.alu_flags.flag_n=0;ep_internal_states.alu_flags.flag_z=1;ep_internal_states.alu_flags.flag_v=1;ep_internal_states.alu_flags.flag_c=0;return}var d=Math.floor(f/e);set_value(ep_states[g[1]],d);ep_internal_states.alu_flags.flag_n=(d<0)?1:0;ep_internal_states.alu_flags.flag_z=(d==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;if(0==e){return"ALU DIV zero by zero (oops!). "}var d=Math.floor(f/e);return"ALU DIV with result "+show_value(d)+". "}};ep_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(d){var a=(get_value(ep_states[d[2]])<<0)%(get_value(ep_states[d[3]])<<0);set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var e=get_value(ep_states[g[3]])<<0;var d=f%e;return"ALU MOD with result "+show_value(d)+". "}};ep_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(ep_states[d[2]]))<<16;set_value(ep_states[d[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))<<16;return"ALU Load Upper Immediate with result "+show_value(a)+". "}};ep_behaviors.PLUS1={nparameters:3,types:["E","E"],operation:function(f){var e=get_value(ep_states[f[2]])<<0;var d=e+1;set_value(ep_states[f[1]],d>>>0)},verbal:function(f){var e=get_value(ep_states[f[2]])<<0;var d=e+1;return"Copy to "+show_verbal(f[1])+" "+show_verbal(f[2])+" plus one with result "+show_value(d)+". "}};ep_behaviors.PLUS4={nparameters:3,types:["E","E"],operation:function(f){var e=get_value(ep_states[f[2]])<<0;var d=e+4;set_value(ep_states[f[1]],d>>>0)},verbal:function(f){var e=get_value(ep_states[f[2]])<<0;var d=e+4;return"Copy to "+show_verbal(f[1])+" "+show_verbal(f[2])+" plus four with result "+show_value(d)+". "}};ep_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){var h=get_reference(a[1]);var g=get_reference(a[2]);var k=parseInt(a[3]);var e=parseInt(a[4]);var f=get_value(g).toString(2);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;d=d.substr(31-(k+e-1),e);set_value(h,parseInt(d,2))},verbal:function(d){var k=get_reference(d[1]);var h=get_reference(d[2]);var m=parseInt(d[3]);var f=parseInt(d[4]);var g=get_value(h).toString(2);var e="00000000000000000000000000000000".substring(0,32-g.length)+g;e=e.substr(31-(m+f-1),f);var a=parseInt(e,2);return"Copy from "+show_verbal(d[2])+" to "+show_verbal(d[1])+" value "+show_value(a)+" (copied "+f+" bits from bit "+m+"). "}};ep_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(d){var h=0;var g=d[3].split("/");if(1==g.length){h=get_value(ep_states[d[3]])}else{if(typeof ep_states[g[0]].value[g[1]]!="undefined"){h=ep_states[g[0]].value[g[1]]}else{if(typeof ep_signals[g[1]].default_value!="undefined"){h=ep_signals[g[1]].default_value}else{if(typeof ep_states[g[1]].default_value!="undefined"){h=ep_states[g[1]].default_value}else{alert("WARN: undefined state/field pair -> "+g[0]+"/"+g[1])}}}}var k=parseInt(d[4]);var f=get_value(ep_states[d[2]]).toString(2);var e="00000000000000000000000000000000".substring(0,32-f.length)+f;var a=e.substr(31-(h+k-1),k);set_value(ep_signals[d[1]],parseInt(a,2))},verbal:function(a){return""}};ep_behaviors.SBIT={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var d=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(d>>>0))},verbal:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);return"Set bit "+show_verbal(a[3])+" of "+show_verbal(a[1])+" to value "+sim_elto_org.value+". "}};ep_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(d){var h=parseInt(ep_signals[d[4]].value);var f=parseInt(ep_signals[d[5]].value);var g=get_value(ep_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var a="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==ep_signals[d[7]].value)&&("1"==e.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-e.length)+e}set_value(ep_states[d[1]],parseInt(a,2))},verbal:function(d){var h=parseInt(ep_signals[d[4]].value);var f=parseInt(ep_signals[d[5]].value);var g=get_value(ep_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var a="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==ep_signals[d[7]].value)&&("1"==e.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-e.length)+e}g=parseInt(a,2);return"Copy from "+show_verbal(d[3])+" to "+show_verbal(d[1])+" value "+show_value(g)+" (copied "+f+" bits from bit "+h+"). "}};ep_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(f){var m=parseInt(f[2]);var k=parseInt(f[5]);var a=parseInt(f[3]);var h=get_value(ep_states[f[4]]).toString(2);var g="00000000000000000000000000000000".substring(0,32-h.length)+h;g=g.substr(31-(k+a)+1,a);var e="00000000000000000000000000000000".substring(0,32-g.length)+g;var d="00000000000000000000000000000000".substr(0,m);e=e+d;set_value(ep_states[f[1]],parseInt(e,2))},verbal:function(n){var g=parseInt(n[2]);var k=parseInt(n[3]);var a=parseInt(n[5]);var m=get_value(ep_states[n[4]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-m.length)+m;h=h.substr(31-(a+k)+1,k);var f="00000000000000000000000000000000".substring(0,32-h.length)+h;var e="00000000000000000000000000000000".substr(0,g);f=f+e;var d=parseInt(f,2);return"Copy from "+show_verbal(n[4])+" to "+show_verbal(n[1])+" value "+show_value(d)+" (copied "+k+" bits, from bit "+a+" of "+n[4]+" to bit "+g+" of "+n[1]+"). "}};ep_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(e){var g=get_value(ep_states[e[1]]).toString(2);var f=("00000000000000000000000000000000".substring(0,32-g.length)+g);var d=f.substr(31-e[2],31);var a=d;if("1"==f[31-e[2]]){a="11111111111111111111111111111111".substring(0,32-d.length)+a}set_value(ep_states[e[1]],parseInt(a,2))},verbal:function(f){var h=get_value(ep_states[f[1]]).toString(2);var g=("00000000000000000000000000000000".substring(0,32-h.length)+h);var e=g.substr(31-f[2],31);var d=e;if("1"==g[31-f[2]]){d="11111111111111111111111111111111".substring(0,32-e.length)+d}var a=parseInt(d,2);return"Sign Extension with value "+show_value(a)+". "}};ep_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(k){var e=parseInt(k[2]);var a=0;var g=parseInt(k[3]);var h=ep_signals[k[4]].value.toString(2);h=("00000000000000000000000000000000".substring(0,32-h.length)+h);h=h.substr(31-a-g+1,g);var f=ep_signals[k[1]].value.toString(2);f=("00000000000000000000000000000000".substring(0,32-f.length)+f);var n=f.substr(0,32-(e+g));var m=f.substr(31-e+1,e);var d=n+h+m;set_value(ep_signals[k[1]],parseInt(d,2))},verbal:function(a){return""}};ep_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(k){var e=parseInt(k[2]);var a=parseInt(k[5]);var g=parseInt(k[3]);var h=get_value(ep_states[k[4]]).toString(2);h=("00000000000000000000000000000000".substring(0,32-h.length)+h);h=h.substr(31-a-g+1,g);var f=ep_signals[k[1]].value.toString(2);f=("00000000000000000000000000000000".substring(0,32-f.length)+f);var n=f.substr(0,32-(e+g));var m=f.substr(31-e+1,e);var d=n+h+m;set_value(ep_signals[k[1]],parseInt(d,2))},verbal:function(a){return""}};ep_behaviors.DECO={nparameters:1,operation:function(d){ep_states.INEX.value=0;var g=decode_instruction(ep_internal_states.FIRMWARE,ep_ir,get_value(ep_states.REG_IR));if(null==g.oinstruction){alert("ERROR: undefined instruction code in firmware (co:"+g.op_code.toString(2)+", cop:"+g.cop_code.toString(2)+")");ep_states.ROM_MUXA.value=0;ep_states.INEX.value=1;return -1}var f=g.op_code<<6;if(typeof g.oinstruction.cop!="undefined"){f=f+g.cop_code}if(typeof ep_internal_states.ROM[f]=="undefined"){alert("ERROR: undefined rom address "+f+" in firmware");ep_states.ROM_MUXA.value=0;return -1}ep_states.ROM_MUXA.value=ep_internal_states.ROM[f];var h=get_value(ep_states.DECO_INS);set_value(ep_states.DECO_INS,h+1);var a=get_value(ep_states.REG_PC)-4;var e=get_deco_from_pc(a);set_value(ep_states.REG_IR_DECO,e);show_dbg_ir(get_value(ep_states.REG_IR_DECO))},verbal:function(a){return"Decode instruction. "}};ep_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(ep_internal_states.fire_stack.indexOf(a[1])!=-1){return}ep_internal_states.fire_stack.push(a[1]);update_draw(ep_signals[a[1]],ep_signals[a[1]].value);if("L"==ep_signals[a[1]].type){update_state(a[1])}ep_internal_states.fire_stack.pop(a[1]);check_buses(a[1])},verbal:function(a){return""}};ep_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(ep_signals[a[1]])!=parseInt(a[2])){return}ep_behaviors.FIRE.operation(a)},verbal:function(a){return""}};ep_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}ep_behaviors.FIRE.operation(a)},verbal:function(a){return""}};ep_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false},verbal:function(a){return""}};ep_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(ep_states.CLK);set_value(ep_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(ep_states.MUXA_MICROADDR);set_value(ep_states.REG_MICROADDR,new_maddr);if(typeof ep_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(ep_internal_states.MC[new_maddr])}else{var new_mins=Object.create(ep_states.REG_MICROINS.default_value)}ep_states.REG_MICROINS.value=new_mins;for(var key in ep_signals){if(typeof new_mins[key]!="undefined"){set_value(ep_signals[key],new_mins[key])}else{set_value(ep_signals[key],ep_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}},verbal:function(a){return""}};ep_behaviors.RESET={nparameters:1,operation:function(a){for(var d in ep_states){reset_value(ep_states[d])}for(var d in ep_signals){reset_value(ep_signals[d])}},verbal:function(a){return"Reset CPU. "}};ep_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()},verbal:function(a){return""}};ep_behaviors.UPDATE_NZVC={nparameters:1,operation:function(a){set_value(simhw_sim_state("FLAG_N"),ep_internal_states.alu_flags.flag_n);set_value(simhw_sim_state("FLAG_Z"),ep_internal_states.alu_flags.flag_z);set_value(simhw_sim_state("FLAG_V"),ep_internal_states.alu_flags.flag_v);set_value(simhw_sim_state("FLAG_C"),ep_internal_states.alu_flags.flag_c);set_value(simhw_sim_signal("TEST_N"),ep_internal_states.alu_flags.flag_n);set_value(simhw_sim_signal("TEST_Z"),ep_internal_states.alu_flags.flag_z);set_value(simhw_sim_signal("TEST_V"),ep_internal_states.alu_flags.flag_v);set_value(simhw_sim_signal("TEST_C"),ep_internal_states.alu_flags.flag_c);update_draw(ep_signals.TEST_N,ep_signals.TEST_N.value);update_draw(ep_signals.TEST_Z,ep_signals.TEST_Z.value);update_draw(ep_signals.TEST_V,ep_signals.TEST_V.value);update_draw(ep_signals.TEST_C,ep_signals.TEST_C.value)},verbal:function(a){return"Update flags N-Z-V-C."}};ep_components.MEMORY={name:"MEMORY",version:"1",abilities:["MEMORY","MEMORY_CONFIG"],write_state:function(e){if(typeof e.MEMORY=="undefined"){e.MEMORY={}}var d=0;var f=0;for(var a in ep_internal_states.MP){f=parseInt(ep_internal_states.MP[a]);if(f!=0){d=parseInt(a).toString(16);e.MEMORY["0x"+d]={type:"memory",default_value:0,id:"0x"+d,op:"=",value:"0x"+f.toString(16)}}}return e},read_state:function(e,a){if(typeof e.MEMORY=="undefined"){e.MEMORY={}}var d=parseInt(a.id).toString(16);var f=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){e.MEMORY["0x"+d]={type:"memory",default_value:0,id:"0x"+d,op:a.condition,value:"0x"+f};return true}return false},get_state:function(d){var a=parseInt(d);if(typeof ep_internal_states.MP[a]!="undefined"){return"0x"+parseInt(ep_internal_states.MP[a]).toString(16)}return null}};ep_internal_states.segments={};ep_internal_states.MP={};ep_internal_states.MP_wc=0;ep_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916","svg_p:text3909"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};ep_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-2","svg_p:text3713"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};ep_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-08","svg_p:text3527","svg_p:text3431-7"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};ep_behaviors.MEM_READ={nparameters:6,types:["E","E","S","S","E"],operation:function(d){var a=ep_states[d[1]].value;var e=ep_states[d[2]].value;var k=ep_signals[d[3]].value;var g=get_value(ep_states[d[5]].value);ep_signals[d[4]].value=0;var h=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[g-1]!="undefined")&&(ep_events.mem[g-1]>0)){h=ep_events.mem[g-1]-1}ep_events.mem[g]=h;if(h>0){return}var f=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){f=ep_internal_states.MP[a]}if(0==(k&12)){if(0==(k&3)){e=(e&4294967040)|(f&255)}if(1==(k&3)){e=(e&4294902015)|(f&65280)}if(2==(k&3)){e=(e&4278255615)|(f&16711680)}if(3==(k&3)){e=(e&16777215)|(f&4278190080)}}else{if(1==(k&12)){if(0==(k&2)){e=(e&4294901760)|(f&65535)}if(1==(k&2)){e=(e&65535)|(f&4294901760)}}else{e=f}}ep_states[d[2]].value=(e>>>0);ep_signals[d[4]].value=1;show_main_memory(ep_internal_states.MP,a,false,false)},verbal:function(d){var f="";var a=ep_states[d[1]].value;var e=ep_states[d[2]].value;var m=ep_signals[d[3]].value;var h=get_value(ep_states[d[5]].value);var k="word";if(0==(m&12)){k="byte"}else{if(1==(m&12)){k="half"}}var g=0;if(typeof ep_internal_states.MP[a]!="undefined"){g=ep_internal_states.MP[a]}f="Try to read a "+k+" from memory at address 0x"+a.toString(16)+" with value "+g.toString(16)+". ";return f}};ep_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","S","E"],operation:function(d){var a=ep_states[d[1]].value;var e=ep_states[d[2]].value;var k=ep_signals[d[3]].value;var g=get_value(ep_states[d[5]].value);ep_signals[d[4]].value=0;var h=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[g-1]!="undefined")&&(ep_events.mem[g-1]>0)){h=ep_events.mem[g-1]-1}ep_events.mem[g]=h;if(h>0){return}var f=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){f=ep_internal_states.MP[a]}if(0==(k&12)){if(0==(k&3)){f=(f&4294967040)|(e&255)}if(1==(k&3)){f=(f&4294902015)|(e&65280)}if(2==(k&3)){f=(f&4278255615)|(e&16711680)}if(3==(k&3)){f=(f&16777215)|(e&4278190080)}}else{if(1==(k&12)){if(0==(k&2)){f=(f&4294901760)|(e&65535)}if(1==(k&2)){f=(f&65535)|(e&4294901760)}}else{f=e}}ep_internal_states.MP[a]=(f>>>0);ep_signals[d[4]].value=1;show_main_memory(ep_internal_states.MP,a,true,true)},verbal:function(d){var f="";var a=ep_states[d[1]].value;var e=ep_states[d[2]].value;var m=ep_signals[d[3]].value;var h=get_value(ep_states[d[5]].value);var k="word";if(0==(m&12)){k="byte"}else{if(1==(m&12)){k="half"}}var g=0;if(typeof ep_internal_states.MP[a]!="undefined"){g=ep_internal_states.MP[a]}f="Try to write a "+k+" to memory at address 0x"+a.toString(16)+" with value "+g.toString(16)+". ";return f}};ep_behaviors.MEM_RESET={nparameters:1,operation:function(a){ep_events.mem={}},verbal:function(a){return"Reset the memory (all values will be zeroes). "}};ep_components.IO={name:"IO",version:"1",abilities:["IO","IO_CONFIG"],write_state:function(a){return a},read_state:function(d,a){return false},get_state:function(a){return null}};ep_internal_states.io_int_factory=[];ep_internal_states.io_int_factory[0]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[1]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[2]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[3]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[4]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[5]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[6]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[7]={period:0,probability:0.5,accumulated:0,active:false};var IOSR_ID=4352;var IOCR_ID=4356;var IODR_ID=4360;ep_internal_states.io_hash[IOSR_ID]="IOSR";ep_internal_states.io_hash[IOCR_ID]="IOCR";ep_internal_states.io_hash[IODR_ID]="IODR";ep_states.IOSR={name:"IOSR",verbal:"IO State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IOCR={name:"IOCR",verbal:"IO Control Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IODR={name:"IODR",verbal:"IO Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.INT={name:"INT",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE C","FIRE C"],fire_name:["svg_p:tspan4199"],draw_data:[[],["svg_p:path3809"]],draw_name:[[],[]]};ep_signals.IORDY={name:"IORDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED IORDY C","FIRE_IFCHANGED IORDY C"],fire_name:["svg_p:tspan4089","svg_p:path3793","svg_p:text3911"],draw_data:[[],["svg_p:path3897"]],draw_name:[[],[]]};ep_signals.IO_IOR={name:"IO_IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOR BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4173"],draw_data:[[],["svg_p:path3795","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IOW={name:"IO_IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOW BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:text3785-0-6-0-5-5"],draw_data:[[],["svg_p:path3805","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IE={name:"IO_IE",visible:true,type:"L",value:1,default_value:1,nbits:"1",behavior:["NOP","IO_CHK_I CLK INT INTV; FIRE C"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.INTA={name:"INTA",visible:true,type:"L",value:1,default_value:0,nbits:"1",behavior:["NOP","INTA CLK INT INTA BUS_DB INTV; FIRE BW; FIRE C"],fire_name:["svg_p:text3785-0-6-0-5-5-1-1"],draw_data:[[],["svg_p:path3807","svg_p:path3737"]],draw_name:[[],[]]};ep_behaviors.IO_IOR={nparameters:7,types:["E","E","E","E","E","E"],operation:function(a){var g=get_value(ep_states[a[1]]);var d=get_value(ep_states[a[3]]);var e=get_value(ep_states[a[4]]);var f=get_value(ep_states[a[5]]);if(g==IOSR_ID){set_value(ep_states[a[2]],d)}if(g==IOCR_ID){set_value(ep_states[a[2]],e)}if(g==IODR_ID){set_value(ep_states[a[2]],f)}},verbal:function(a){var f="";var h=get_value(ep_states[a[1]]);var d=get_value(ep_states[a[3]]);var e=get_value(ep_states[a[4]]);var g=get_value(ep_states[a[5]]);if(h==IOSR_ID){f="I/O device read at IOSR of value "+d+". "}if(h==IOCR_ID){f="I/O device read at IOCR of value "+e+". "}if(h==IODR_ID){f="I/O device read at IODR of value "+g+". "}return f}};ep_behaviors.IO_IOW={nparameters:7,types:["E","E","E","E","E","E"],operation:function(d){var g=get_value(ep_states[d[1]]);var e=get_value(ep_states[d[2]]);if((g!=IOSR_ID)&&(g!=IOCR_ID)&&(g!=IODR_ID)){return}if(g==IOSR_ID){set_value(ep_states[d[3]],e)}if(g==IOCR_ID){set_value(ep_states[d[4]],e)}if(g==IODR_ID){set_value(ep_states[d[5]],e)}var a=get_value(ep_states[d[4]]);var f=get_value(ep_states[d[5]]);if((a<0)||(a>7)){return}set_var(ep_internal_states.io_int_factory[a].period,f);set_var(ep_internal_states.io_int_factory[a].probability,1);if(0==f){set_var(ep_internal_states.io_int_factory[a].probability,0)}},verbal:function(a){var e="";var f=get_value(ep_states[a[1]]);var d=get_value(ep_states[a[2]]);if(f==IOSR_ID){e="I/O device write at IOSR with value "+d+". "}if(f==IOCR_ID){e="I/O device write at IOCR with value "+d+". "}if(f==IODR_ID){e="I/O device write at IODR with value "+d+". "}return e}};ep_behaviors.IO_CHK_I={nparameters:4,types:["E","S","E"],operation:function(a){var e=get_value(ep_states[a[1]]);for(var d=ep_internal_states.io_int_factory.length-1;d>=0;d--){if(get_var(ep_internal_states.io_int_factory[d].period)==0){continue}if(get_var(ep_internal_states.io_int_factory[d].active)==true){set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],d)}if((e%get_var(ep_internal_states.io_int_factory[d].period))==0){if(Math.random()>get_var(ep_internal_states.io_int_factory[d].probability)){continue}set_var(ep_internal_states.io_int_factory[d].accumulated,get_var(ep_internal_states.io_int_factory[d].accumulated)+1);set_var(ep_internal_states.io_int_factory[d].active,true);if(typeof ep_events.io[e]=="undefined"){ep_events.io[e]=[]}ep_events.io[e].push(d);set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],d)}}},verbal:function(a){return"Check I/O Interruption. "}};ep_behaviors.INTA={nparameters:6,types:["E","S","S","E","E"],operation:function(a){var e=get_value(ep_states[a[1]]);if(typeof ep_events.io[e]!="undefined"){set_value(ep_states[a[4]],ep_events.io[e][0]);return}set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],0);for(var d=0;d<ep_internal_states.io_int_factory.length;d++){if(get_var(ep_internal_states.io_int_factory[d].active)){set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],d);set_value(ep_states[a[4]],d);if(typeof ep_events.io[e]=="undefined"){ep_events.io[e]=[]}ep_events.io[e].push(d);set_var(ep_internal_states.io_int_factory[d].active,false);break}}},verbal:function(a){return"Signal an interruption ACK. "}};ep_behaviors.IO_RESET={nparameters:1,operation:function(a){ep_events.io={};for(var d=0;d<ep_internal_states.io_int_factory.length;d++){set_var(ep_internal_states.io_int_factory[d].accumulated,0);set_var(ep_internal_states.io_int_factory[d].active,false)}},verbal:function(a){return"Reset the I/O device. "}};ep_components.KBD={name:"KBD",version:"1",abilities:["KBD"],write_state:function(a){return a},read_state:function(d,a){return false},get_state:function(a){return null}};var KBDR_ID=256;var KBSR_ID=260;ep_internal_states.io_hash[KBDR_ID]="KBDR";ep_internal_states.io_hash[KBSR_ID]="KBSR";ep_states.KBDR={name:"KBDR",verbal:"Keyboard Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.KBSR={name:"KBSR",verbal:"Keyboard Status Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};ep_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(e){var g=get_value(ep_states[e[1]]);var f=get_value(ep_states[e[5]]);if((g!=KBDR_ID)&&(g!=KBSR_ID)){return}if(typeof ep_events.keybd[f]!="undefined"){if(g==KBDR_ID){set_value(ep_states[e[2]],ep_events.keybd[f])}if(g==KBSR_ID){set_value(ep_states[e[2]],1)}return}if(get_value(ep_states[e[4]])==0){var d=get_keyboard_content();if(d.length!=0){var a=d.substr(1,d.length-1);set_keyboard_content(a);set_value(ep_states[e[4]],1);set_value(ep_states[e[3]],d[0].charCodeAt(0))}}if(get_value(ep_states[e[4]])==1){ep_events.keybd[f]=get_value(ep_states[e[3]])}if(g==KBSR_ID){set_value(ep_states[e[2]],get_value(ep_states[e[4]]))}if(g==KBDR_ID){if(get_value(ep_states[e[4]])==1){set_value(ep_states[e[2]],get_value(ep_states[e[3]]))}set_value(ep_states[e[4]],0)}},verbal:function(a){var d="";var f=get_value(ep_states[a[1]]);var e=get_value(ep_states[a[5]]);if(f==KBDR_ID){d="Read the screen data: "+ep_states[a[2]]+". "}if(f==KBSR_ID){d="Read the screen state: "+ep_states[a[2]]+". "}return d}};ep_behaviors.KBD_RESET={nparameters:1,operation:function(a){ep_events.keybd={}},verbal:function(a){return"Reset the keyboard content. "}};ep_components.SCREEN={name:"SCREEN",version:"1",abilities:["SCREEN"],write_state:function(d){if(typeof d.SCREEN=="undefined"){d.SCREEN={}}var f=get_screen_content();var e=f.trim().split("\n");for(var a=0;a<e.length;a++){value=e[a];if(value!=""){d.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return d},read_state:function(d,a){if(typeof d.SCREEN=="undefined"){d.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){d.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var f=get_screen_content();var e=f.trim().split("\n");var d=parseInt(a);if(typeof e[d]!="undefined"){return e[d]}return null}};var DDR_ID=4096;var DSR_ID=4100;ep_internal_states.io_hash[DDR_ID]="DDR";ep_internal_states.io_hash[DSR_ID]="DSR";ep_states.DDR={name:"DDR",verbal:"Display Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.DSR={name:"DSR",verbal:"Display State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};ep_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};ep_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(ep_states[d[1]]);var e=get_value(ep_states[d[3]]);var a=get_value(ep_states[d[4]]);if(f==DDR_ID){set_value(ep_states[d[2]],e)}if(f==DSR_ID){set_value(ep_states[d[2]],a)}},verbal:function(d){var f="";var g=get_value(ep_states[d[1]]);var e=get_value(ep_states[d[3]]);var a=get_value(ep_states[d[4]]);if(g==DDR_ID){f="Try to read from the screen the DDR value "+e+". "}if(g==DDR_ID){f="Try to read into the screen the DSR value "+a+". "}return f}};ep_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(e){var m=get_value(ep_states[e[1]]);var g=get_value(ep_states[e[2]]);var k=get_value(ep_states[e[5]]);var h=String.fromCharCode(g);if(m!=DDR_ID){return}if(h==String.fromCharCode(7)){timbre.reset();var f=T("sin",{freq:440,mul:0.5});var d=T("sin",{freq:660,mul:0.5});T("perc",{r:500},f,d).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof ep_events.screen[k]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(g))}set_value(ep_states[e[3]],g);set_value(ep_states[e[4]],1);ep_events.screen[k]=g},verbal:function(a){var f="";var h=get_value(ep_states[a[1]]);var d=get_value(ep_states[a[2]]);var g=get_value(ep_states[a[5]]);var e=String.fromCharCode(d);if(h==DDR_ID){f="Try to write into the screen the code "+e+" at clock cycle "+g+". "}return f}};ep_behaviors.SCR_RESET={nparameters:1,operation:function(a){ep_events.screen={}},verbal:function(a){return"Reset the screen content. "}};var poc_components={};var poc_states={};var poc_events={};var poc_signals={};var poc_behaviors={};var poc_internal_states={};var poc_ir={};var poc_def={sim_name:"Proof-Of-Concept Processor",sim_short_name:"poc",sim_img_processor:"images/poc/processor3.svg",sim_img_controlunit:"images/poc/controlunit2.svg",sim_img_cpu:"images/poc/cpu2.svg",components:poc_components,states:poc_states,signals:poc_signals,behaviors:poc_behaviors,events:poc_events,internal_states:poc_internal_states,ir_info:poc_ir};simhw_add(poc_def);function poc_update_nzvc(e,a,f,d){set_value(simhw_sim_state("FLAG_N"),e);set_value(simhw_sim_state("FLAG_Z"),a);set_value(simhw_sim_state("FLAG_V"),f);set_value(simhw_sim_state("FLAG_C"),d);set_value(simhw_sim_signal("TEST_N"),e);set_value(simhw_sim_signal("TEST_Z"),a);set_value(simhw_sim_signal("TEST_V"),f);set_value(simhw_sim_signal("TEST_C"),d)}poc_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+poc_signals[a[1]].value.toString(16))},verbal:function(a){return"Print value of signal "+a[1]+": 0x"+poc_signals[a[1]].value.toString(16)+". "}};poc_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+poc_states[a[1]].value.toString(16))},verbal:function(a){return"Print value of state "+a[1]+": 0x"+poc_states[a[1]].value.toString(16)+". "}};poc_components.CPU={name:"CPU",version:"1",abilities:["CPU"],write_state:function(e){if(typeof e.CPU=="undefined"){e.CPU={}}var a=["PC","SR"];var f=0;for(var d=0;d<poc_states.BR.length;d++){f=parseInt(poc_states.BR[d].value);if(f!=0){e.CPU["R"+d]={type:"register",default_value:0,id:"R"+d,op:"=",value:"0x"+f.toString(16)}}}for(var d=0;d<a.length;d++){f=parseInt(poc_states["REG_"+a[d]].value);if(f!=0){e.CPU[a[d]]={type:"register",default_value:0,id:a[d],op:"=",value:"0x"+f.toString(16)}}}return e},read_state:function(e,a){if(typeof e.CPU=="undefined"){e.CPU={}}var d=a.id.toUpperCase().trim();var f=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){e.CPU[d]={type:"register",default_value:0,id:d,op:a.condition,value:"0x"+f};return true}return false},get_state:function(d){var e=d.toUpperCase().trim();if(typeof poc_states["REG_"+e]!="undefined"){return"0x"+get_value(poc_states["REG_"+e]).toString(16)}e=e.replace("R","");var a=parseInt(e);if(typeof poc_states.BR[a]!="undefined"){return"0x"+get_value(poc_states.BR[a]).toString(16)}return null}};poc_ir.default_eltos={co:{begin:0,end:5,length:6},cop:{begin:27,end:31,length:5}};poc_internal_states.MC={};poc_internal_states.MC_dashboard={};poc_internal_states.ROM={};poc_internal_states.FIRMWARE={};poc_internal_states.io_hash={};poc_internal_states.fire_stack=[];poc_internal_states.tri_state_names=["T1","T2","T3","T6","T8","T9","T10","T11"];poc_internal_states.fire_visible={databus:false,internalbus:false};poc_internal_states.filter_states=["REG_IR_DECO,col-12","REG_IR,col","REG_PC,col","REG_SR,col","REG_RT1,col","REG_MAR,col","REG_MBR,col","REG_MICROADDR,col"];poc_internal_states.filter_signals=["A0,0","B,0","C,0","SELA,5","SELB,5","SELC,2","SELCOP,0","MR,0","MC,0","C0,0","C1,0","C2,0","C3,0","C4,0","C7,0","T1,0","T2,0","T3,0","T6,0","T8,0","T9,0","T10,0","T11,0","M1,0","M7,0","MA,0","MB,0","LC,0","SE,0","SIZE,0","OFFSET,0","BW,0","R,0","W,0","TA,0","TD,0","IOR,0","IOW,0","TEST_I,0","TEST_U,0"];poc_internal_states.alu_flags={flag_n:0,flag_z:0,flag_v:0,flag_c:0};poc_states.BR=[];poc_states.BR[0]={name:"R0",verbal:"Register  0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[1]={name:"R1",verbal:"Register  1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[2]={name:"R2",verbal:"Register  2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[3]={name:"R3",verbal:"Register  3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[4]={name:"R4",verbal:"Register  4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[5]={name:"R5",verbal:"Register  5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[6]={name:"R6",verbal:"Register  6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[7]={name:"R7",verbal:"Register  7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[8]={name:"R8",verbal:"Register  8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[9]={name:"R9",verbal:"Register  9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[10]={name:"R10",verbal:"Register 10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[11]={name:"R11",verbal:"Register 11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[12]={name:"R12",verbal:"Register 12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[13]={name:"R13",verbal:"Register 13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[14]={name:"R14",verbal:"Register 14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[15]={name:"R15",verbal:"Register 15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[16]={name:"R16",verbal:"Register 16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[17]={name:"R17",verbal:"Register 17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[18]={name:"R18",verbal:"Register 18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[19]={name:"R19",verbal:"Register 19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[20]={name:"R20",verbal:"Register 20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[21]={name:"R21",verbal:"Register 21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[22]={name:"R22",verbal:"Register 22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[23]={name:"R23",verbal:"Register 23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[24]={name:"R24",verbal:"Register 24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[25]={name:"R25",verbal:"Register 25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[26]={name:"R26",verbal:"Register 26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[27]={name:"R27",verbal:"Register 27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[28]={name:"R28",verbal:"Register 28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[29]={name:"R29",verbal:"Register 29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[30]={name:"R30",verbal:"Register 30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[31]={name:"R31",verbal:"Register 31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[32]={name:"R32",verbal:"Register 32",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[33]={name:"R33",verbal:"Register 33",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[34]={name:"R34",verbal:"Register 34",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[35]={name:"R35",verbal:"Register 35",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[36]={name:"R36",verbal:"Register 36",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[37]={name:"R37",verbal:"Register 37",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[38]={name:"R38",verbal:"Register 38",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[39]={name:"R39",verbal:"Register 39",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[40]={name:"R40",verbal:"Register 40",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[41]={name:"R41",verbal:"Register 41",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[42]={name:"R42",verbal:"Register 42",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[43]={name:"R43",verbal:"Register 43",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[44]={name:"R44",verbal:"Register 44",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[45]={name:"R45",verbal:"Register 45",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[46]={name:"R46",verbal:"Register 46",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[47]={name:"R47",verbal:"Register 47",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[48]={name:"R48",verbal:"Register 48",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[49]={name:"R49",verbal:"Register 49",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[50]={name:"R50",verbal:"Register 50",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[51]={name:"R51",verbal:"Register 51",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[52]={name:"R52",verbal:"Register 52",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[53]={name:"R53",verbal:"Register 53",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[54]={name:"R54",verbal:"Register 54",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[55]={name:"R55",verbal:"Register 55",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[56]={name:"R56",verbal:"Register 56",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[57]={name:"R57",verbal:"Register 57",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[58]={name:"R58",verbal:"Register 58",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[59]={name:"R59",verbal:"Register 59",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[60]={name:"R60",verbal:"Register 60",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[61]={name:"R61",verbal:"Register 61",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[62]={name:"R62",verbal:"Register 62",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[63]={name:"R63",verbal:"Register 63",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_PC={name:"PC",verbal:"Program Counter Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MAR={name:"MAR",verbal:"Memory Address Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MBR={name:"MBR",verbal:"Memory Data Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_IR={name:"IR",verbal:"Instruction Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_SR={name:"SR",verbal:"State Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_RT1={name:"RT1",verbal:"Temporal Register 1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_IB={name:"I_BUS",verbal:"Internal Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_AB={name:"A_BUS",verbal:"Address Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_CB={name:"C_BUS",verbal:"Control Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_DB={name:"D_BUS",verbal:"Data Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RA_T9={name:"RA_T9",verbal:"Input of T9 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RB_T10={name:"RB_T10",verbal:"Input of T10 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.SELEC_T3={name:"SELEC_T3",verbal:"Input of T3 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.ALU_T6={name:"ALU_T6",verbal:"Input of T6 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MA_ALU={name:"MA_ALU",verbal:"Input ALU via MA",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MB_ALU={name:"MB_ALU",verbal:"Input ALU via MB",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.FLAG_C={name:"FLAG_C",verbal:"Flag Carry",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_V={name:"FLAG_V",verbal:"Flag Overflow",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_N={name:"FLAG_N",verbal:"Flag Negative",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_Z={name:"FLAG_Z",verbal:"Flag Zero",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_I={name:"FLAG_I",verbal:"Flag Interruption",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_U={name:"FLAG_U",verbal:"Flag User",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.REG_MICROADDR={name:"µADDR",verbal:"Microaddress Register",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};poc_states.REG_MICROINS={name:"µINS",verbal:"Microinstruction Register",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};poc_states.FETCH={name:"FETCH",verbal:"Input Fetch ",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.ROM_MUXA={name:"ROM_MUXA",verbal:"Input ROM ",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.SUM_ONE={name:"SUM_ONE",verbal:"Input next microinstruction ",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};poc_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",verbal:"Input microaddress from microinstruction",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.MUXC_MUXB={name:"MUXC_MUXB",verbal:"Output of MUX C",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.INEX={name:"INEX",verbal:"Illegal Instruction Exception",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.BS_M1={name:"BS_M1",verbal:"from Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BS_TD={name:"BS_TD",verbal:"Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.INTV={name:"INTV",verbal:"Interruption Vector",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};poc_states.M1_C1={name:"M1_C1",verbal:"Input of Memory Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.M7_C7={name:"M7_C7",verbal:"Input of State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.VAL_ZERO={name:"VAL_ZERO",verbal:"Wired Zero",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.VAL_ONE={name:"VAL_ONE",verbal:"Wired One",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};poc_states.VAL_FOUR={name:"VAL_FOUR",verbal:"Wired Four",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};poc_states.REG_IR_DECO={name:"IR_DECO",verbal:"Instruction Decoded",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};poc_states.DECO_INS={name:"DECO_INS",verbal:"Instruction decoded in binary",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.CLK={name:"CLK",verbal:"Clock",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB INT 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB IORDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB MRDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 1 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 28 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 29 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 30 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 31 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MV MUXC_MUXB INEX; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};poc_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};poc_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A0 1; FIRE A0A1","SBIT A0A1 A0 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};poc_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A1 0; FIRE A0A1","SBIT A0A1 A1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};poc_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["PLUS1 MUXA_MICROADDR REG_MICROADDR","CP_FIELD MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};poc_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};poc_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};poc_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_PC BUS_IB; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3217"]],draw_name:[["svg_p:path3177"]]};poc_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339","svg_p:path3913-4"]],draw_name:[["svg_p:path3337"]]};poc_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT1 BUS_IB"],fire_name:["svg_p:tspan482"],draw_data:[["svg_p:path3339-4"]],draw_name:[["svg_p:path3337-0"]]};poc_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};poc_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};poc_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB REG_MBR; FIRE R; FIRE W"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3419-8","svg_p:path3071","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3491","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};poc_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};poc_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};poc_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};poc_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_T6; FIRE M7; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049","svg_p:path3317-9","svg_p:path3321","svg_p:path3261-8"]],draw_name:[["svg_p:path3319"]]};poc_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};poc_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};poc_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};poc_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","CP_FIELD BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};poc_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BUS_DB"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};poc_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 REG_SR; SBIT M7_C7 FLAG_C 31; SBIT M7_C7 FLAG_V 30; SBIT M7_C7 FLAG_N 29; SBIT M7_C7 FLAG_Z 28"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};poc_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU BUS_IB; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};poc_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_PC; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};poc_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["NOP_ALU; UPDATE_NZVC","AND ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","OR ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","NOT ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","XOR ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SRL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SRA ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","RR ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","RL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SUB ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","MUL ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","DIV ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","MOD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","LUI ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADDFOUR ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADDONE ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FADD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FSUB ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FMUL ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FDIV ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FMOD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};poc_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MR_RA SELA; RESET_CHANGED SELA"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};poc_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MR_RB SELB; RESET_CHANGED SELB"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};poc_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MR_RC SELC; RESET_CHANGED SELC"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};poc_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MC SELCOP; RESET_CHANGED SELCOP"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};poc_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};poc_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};poc_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};poc_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};poc_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};poc_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3","MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3593"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};poc_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};poc_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};poc_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 5; FIRE_IFCHANGED COP MC","CP_FIELD COP REG_MICROINS/SELCOP; FIRE_IFCHANGED COP MC"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};poc_signals.MR={name:"MR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC","MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_cu:text3222","svg_cu:text3242","svg_cu:text3254","svg_cu:text3172-1"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260","svg_cu:path3196","svg_cu:path3502","svg_cu:path3278","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3270","svg_cu:path3282","svg_cu:path3300","svg_cu:path3258","svg_cu:path3260","svg_cu:path3278","svg_cu:path3196","svg_cu:path3502","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220","svg_cu:path3240","svg_cu:path3252"]]};poc_signals.MR_RA={name:"MR_RA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 6; FIRE RA;","CP_FIELD RA REG_MICROINS/SELA; FIRE RA;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.MR_RB={name:"MR_RB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 6; FIRE RB;","CP_FIELD RB REG_MICROINS/SELB; FIRE RB;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.MR_RC={name:"MR_RC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 6; FIRE RC;","CP_FIELD RC REG_MICROINS/SELC; FIRE RC;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS KBD_IOR 0 1 IOR; MOVE_BITS SCR_IOR 0 1 IOR; FIRE KBD_IOR; FIRE SCR_IOR"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3733","svg_p:path3491","svg_p:text3715"]],draw_name:[[],[]]};poc_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW;"],fire_name:["svg_p:text3717"],draw_data:[[],["svg_p:path3735","svg_p:path3491","svg_p:text3717"]],draw_name:[[],[]]};poc_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE M7","MV FLAG_C VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};poc_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE M7","MV FLAG_V VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};poc_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE M7","MV FLAG_N VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};poc_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE M7","MV FLAG_Z VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};poc_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE M7","MV FLAG_I VAL_ONE; FIRE M7"],depends_on:["CLK"],fire_name:["svg_cu:text3440"],draw_data:[["svg_cu:text3440"]],draw_name:[[]]};poc_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE M7","MV FLAG_U VAL_ONE; FIRE M7"],depends_on:["CLK"],fire_name:["svg_cu:text3442"],draw_data:[["svg_cu:text3442"]],draw_name:[[]]};poc_behaviors.NOP={nparameters:1,operation:function(a){},verbal:function(a){return""}};poc_behaviors.NOP_ALU={nparameters:1,operation:function(a){poc_update_nzvc(0,0,0,0)},verbal:function(a){return"Reset ALU flags. "}};poc_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(a){var d=get_reference(a[2]);var e=get_value(d);return"Copy from "+show_verbal(a[2])+" to "+show_verbal(a[1])+" value "+show_value(e)+". "}};poc_behaviors.LOAD={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(a){var d=get_reference(a[2]);var e=get_value(d);return"Load from "+show_verbal(a[2])+" to "+show_verbal(a[1])+" value "+show_value(e)+". "}};poc_behaviors.CP_FIELD={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);newval=newval[r[1]];if(typeof newval!="undefined"){sim_elto_dst=get_reference(a[1]);set_value(sim_elto_dst,newval)}},verbal:function(a){var e=a[2].split("/");var d=get_reference(e[0]);var f=get_value(d);f=f[e[1]];if(typeof f=="undefined"){return""}return"Copy from Field "+e[1]+" of "+show_verbal(e[0])+" to "+show_verbal(a[1])+" value "+show_value(f)+". "}};poc_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(poc_signals[a[1]],Math.abs(get_value(poc_states[a[2]])-1))},verbal:function(a){var d=Math.abs(get_value(poc_states[a[2]])-1);return"Set "+show_verbal(a[1])+" with value "+show_value(d)+" (Logical NOT of "+a[2]+"). "}};poc_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(poc_states[a[1]],get_value(poc_states[a[2]][poc_signals[a[3]].value]))},verbal:function(a){var d=get_value(poc_states[a[2]][poc_signals[a[3]].value]);return"Set "+show_verbal(a[1])+" with value "+show_value(d)+" (Register File "+a[3]+"). "}};poc_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(poc_states[a[1]][poc_signals[a[2]].value],get_value(poc_states[a[3]]))},verbal:function(e){var f=get_value(poc_states[e[3]]);var d=poc_states[e[1]][poc_signals[e[2]].value];var a=d.name;if(typeof d.verbal!="undefined"){a=d.verbal}return"Copy to "+a+" the value "+show_value(f)+". "}};poc_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(poc_states[d[2]])&get_value(poc_states[d[3]]);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=get_value(poc_states[d[2]])&get_value(poc_states[d[3]]);return"ALU AND with result "+show_value(a)+". "}};poc_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(poc_states[d[2]])|get_value(poc_states[d[3]]);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=get_value(poc_states[d[2]])|get_value(poc_states[d[3]]);return"ALU OR with result "+show_value(a)+". "}};poc_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(d){var a=~(get_value(poc_states[d[2]]));set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=~(get_value(poc_states[d[2]]));return"ALU NOT with result "+show_value(a)+". "}};poc_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(d){var a=get_value(poc_states[d[2]])^get_value(poc_states[d[3]]);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=get_value(poc_states[d[2]])^get_value(poc_states[d[3]]);return"ALU XOR with result "+show_value(a)+". "}};poc_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(poc_states[d[2]]))>>>1;set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=(get_value(poc_states[d[2]]))>>>1;return"ALU Shift Right Logical with result "+show_value(a)+". "}};poc_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(poc_states[d[2]]))>>1;set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=(get_value(poc_states[d[2]]))>>1;return"ALU Shift Right Arithmetic with result "+show_value(a)+". "}};poc_behaviors.SL={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(poc_states[d[2]]))<<1;set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,(a)>>>31)},verbal:function(d){var a=(get_value(poc_states[d[2]]))<<1;return"ALU Shift Left with result "+show_value(a)+". "}};poc_behaviors.RR={nparameters:3,types:["E","E"],operation:function(d){var a=((get_value(poc_states[d[2]]))>>>1)|(((get_value(poc_states[d[2]]))&1)<<31);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=((get_value(poc_states[d[2]]))>>>1)|(((get_value(poc_states[d[2]]))&1)<<31);return"ALU Right Rotation with result "+show_value(a)+". "}};poc_behaviors.RL={nparameters:3,types:["E","E"],operation:function(d){var a=((get_value(poc_states[d[2]]))<<1)|(((get_value(poc_states[d[2]]))&2147483648)>>>31);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=((get_value(poc_states[d[2]]))<<1)|(((get_value(poc_states[d[2]]))&2147483648)>>>31);return"ALU Left Rotation with result "+show_value(a)+". "}};poc_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k+f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var e=get_value(poc_states[g[3]])<<0;var d=f+e;return"ALU ADD with result "+show_value(d)+". "}};poc_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k-f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var e=get_value(poc_states[g[3]])<<0;var d=f-e;return"ALU SUB with result "+show_value(d)+". "}};poc_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k*f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var e=get_value(poc_states[g[3]])<<0;var d=f*e;return"ALU MUL with result "+show_value(d)+". "}};poc_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(g){var f=(get_value(poc_states[g[2]])<<0);var e=(get_value(poc_states[g[3]])<<0);if(0==e){set_value(poc_states[g[1]],0);poc_update_nzvc(0,1,1,0);return}var d=Math.floor(f/e);set_value(poc_states[g[1]],d);poc_update_nzvc((d<0)?1:0,(d==0)?1:0,0,0)},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var e=get_value(poc_states[g[3]])<<0;if(0==e){return"ALU DIV zero by zero (oops!). "}var d=Math.floor(f/e);return"ALU DIV with result "+show_value(d)+". "}};poc_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(d){var a=(get_value(poc_states[d[2]])<<0)%(get_value(poc_states[d[3]])<<0);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var e=get_value(poc_states[g[3]])<<0;var d=f%e;return"ALU MOD with result "+show_value(d)+". "}};poc_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(poc_states[d[2]]))<<16;set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=(get_value(poc_states[d[2]]))<<16;return"ALU Load Upper Immediate with result "+show_value(a)+". "}};poc_behaviors.ADDFOUR={nparameters:3,types:["E","E"],operation:function(k){var h=get_value(poc_states[k[2]])<<0;var e=h+4;set_value(poc_states[k[1]],e>>>0);var g=(e<0)?1:0;var d=(e==0)?1:0;var f=(h>>>31)&&(b>>>31);var m=0;if((e<0)&&(h>=0)&&(b>=0)){m=1}if((e>=0)&&(h<0)&&(b<0)){m=1}poc_update_nzvc(g,d,m,f)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+4;return"ALU ADD 4 with result "+show_value(d)+". "}};poc_behaviors.ADDONE={nparameters:3,types:["E","E"],operation:function(k){var h=get_value(poc_states[k[2]])<<0;var e=h+1;set_value(poc_states[k[1]],e>>>0);var g=(e<0)?1:0;var d=(e==0)?1:0;var f=(h>>>31)&&(b>>>31);var m=0;if((e<0)&&(h>=0)&&(b>=0)){m=1}if((e>=0)&&(h<0)&&(b<0)){m=1}poc_update_nzvc(g,d,m,f)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+1;return"ALU ADD 4 with result "+show_value(d)+". "}};poc_behaviors.FADD={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k.toFixed(2)+f.toFixed(2);set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(a){return""}};poc_behaviors.FSUB={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k.toFixed(2)-f.toFixed(2);set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(a){return""}};poc_behaviors.FMUL={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k.toFixed(2)*f.toFixed(2);set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}poc_update_nzvc(h,d,n,g)},verbal:function(a){return""}};poc_behaviors.FDIV={nparameters:4,types:["E","E","E"],operation:function(g){var f=(get_value(poc_states[g[2]])<<0);var e=(get_value(poc_states[g[3]])<<0);if(0==e){set_value(poc_states[g[1]],0);poc_update_nzvc(0,1,1,0);return}var d=Math.floor(f/e);set_value(poc_states[g[1]],d);poc_update_nzvc((d<0)?1:0,(d==0)?1:0,0,0)},verbal:function(a){return""}};poc_behaviors.FMOD={nparameters:4,types:["E","E","E"],operation:function(d){var a=(get_value(poc_states[d[2]])<<0)%(get_value(poc_states[d[3]])<<0);set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(a){return""}};poc_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(d){var a=(get_value(poc_states[d[2]]))<<16;set_value(poc_states[d[1]],a);poc_update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)},verbal:function(d){var a=(get_value(poc_states[d[2]]))<<16;return"ALU Load Upper Immediate with result "+show_value(a)+". "}};poc_behaviors.PLUS1={nparameters:3,types:["E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+1;set_value(poc_states[f[1]],d>>>0)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+1;return"Add one to "+show_verbal(f[2])+" and copy to "+show_verbal(f[1])+" with result "+show_value(d)+". "}};poc_behaviors.PLUS4={nparameters:3,types:["E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+4;set_value(poc_states[f[1]],d>>>0)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=e+4;return"Add four to "+show_verbal(f[2])+" and copy to "+show_verbal(f[1])+" with result "+show_value(d)+". "}};poc_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){var h=get_reference(a[1]);var g=get_reference(a[2]);var k=parseInt(a[3]);var e=parseInt(a[4]);var f=get_value(g).toString(2);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;d=d.substr(31-(k+e-1),e);set_value(h,parseInt(d,2))},verbal:function(d){var k=get_reference(d[1]);var h=get_reference(d[2]);var m=parseInt(d[3]);var f=parseInt(d[4]);var g=get_value(h).toString(2);var e="00000000000000000000000000000000".substring(0,32-g.length)+g;e=e.substr(31-(m+f-1),f);var a=parseInt(e,2);return"Copy from "+show_verbal(d[2])+" to "+show_verbal(d[1])+" value "+show_value(a)+" (copied "+f+" bits from bit "+m+"). "}};poc_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(d){var h=0;var g=d[3].split("/");if(1==g.length){h=get_value(poc_states[d[3]])}else{if(typeof poc_states[g[0]].value[g[1]]!="undefined"){h=poc_states[g[0]].value[g[1]]}else{if(typeof poc_signals[g[1]].default_value!="undefined"){h=poc_signals[g[1]].default_value}else{if(typeof poc_states[g[1]].default_value!="undefined"){h=poc_states[g[1]].default_value}else{alert("WARN: undefined state/field pair -> "+g[0]+"/"+g[1])}}}}var k=parseInt(d[4]);var f=get_value(poc_states[d[2]]).toString(2);var e="00000000000000000000000000000000".substring(0,32-f.length)+f;var a=e.substr(31-(h+k-1),k);set_value(poc_signals[d[1]],parseInt(a,2))},verbal:function(a){return""}};poc_behaviors.SBIT={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var d=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(d>>>0))},verbal:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);return"Set bit "+show_verbal(a[3])+" of "+show_verbal(a[1])+" to value "+sim_elto_org.value+". "}};poc_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(d){var h=parseInt(poc_signals[d[4]].value);var f=parseInt(poc_signals[d[5]].value);var g=get_value(poc_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var a="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==poc_signals[d[7]].value)&&("1"==e.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-e.length)+e}set_value(poc_states[d[1]],parseInt(a,2))},verbal:function(d){var h=parseInt(poc_signals[d[4]].value);var f=parseInt(poc_signals[d[5]].value);var g=get_value(poc_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var a="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==poc_signals[d[7]].value)&&("1"==e.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-e.length)+e}g=parseInt(a,2);return"Copy from "+show_verbal(d[3])+" to "+show_verbal(d[1])+" value "+show_value(g)+" (copied "+f+" bits from bit "+h+"). "}};poc_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(f){var m=parseInt(f[2]);var k=parseInt(f[5]);var a=parseInt(f[3]);var h=get_value(poc_states[f[4]]).toString(2);var g="00000000000000000000000000000000".substring(0,32-h.length)+h;g=g.substr(31-(k+a)+1,a);var e="00000000000000000000000000000000".substring(0,32-g.length)+g;var d="00000000000000000000000000000000".substr(0,m);e=e+d;set_value(poc_states[f[1]],parseInt(e,2))},verbal:function(n){var g=parseInt(n[2]);var k=parseInt(n[3]);var a=parseInt(n[5]);var m=get_value(poc_states[n[4]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-m.length)+m;h=h.substr(31-(a+k)+1,k);var f="00000000000000000000000000000000".substring(0,32-h.length)+h;var e="00000000000000000000000000000000".substr(0,g);f=f+e;var d=parseInt(f,2);return"Copy from "+show_verbal(n[4])+" to "+show_verbal(n[1])+" value "+show_value(d)+" (copied "+k+" bits, from bit "+a+" of "+n[4]+" to bit "+g+" of "+n[1]+"). "}};poc_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(e){var g=get_value(poc_states[e[1]]).toString(2);var f=("00000000000000000000000000000000".substring(0,32-g.length)+g);var d=f.substr(31-e[2],31);var a=d;if("1"==f[31-e[2]]){a="11111111111111111111111111111111".substring(0,32-d.length)+a}set_value(poc_states[e[1]],parseInt(a,2))},verbal:function(f){var h=get_value(poc_states[f[1]]).toString(2);var g=("00000000000000000000000000000000".substring(0,32-h.length)+h);var e=g.substr(31-f[2],31);var d=e;if("1"==g[31-f[2]]){d="11111111111111111111111111111111".substring(0,32-e.length)+d}var a=parseInt(d,2);return"Sign Extension with value "+show_value(a)+". "}};poc_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(k){var e=parseInt(k[2]);var a=0;var g=parseInt(k[3]);var h=poc_signals[k[4]].value.toString(2);h=("00000000000000000000000000000000".substring(0,32-h.length)+h);h=h.substr(31-a-g+1,g);var f=poc_signals[k[1]].value.toString(2);f=("00000000000000000000000000000000".substring(0,32-f.length)+f);var n=f.substr(0,32-(e+g));var m=f.substr(31-e+1,e);var d=n+h+m;set_value(poc_signals[k[1]],parseInt(d,2))},verbal:function(a){return""}};poc_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(k){var e=parseInt(k[2]);var a=parseInt(k[5]);var g=parseInt(k[3]);var h=get_value(poc_states[k[4]]).toString(2);h=("00000000000000000000000000000000".substring(0,32-h.length)+h);h=h.substr(31-a-g+1,g);var f=poc_signals[k[1]].value.toString(2);f=("00000000000000000000000000000000".substring(0,32-f.length)+f);var n=f.substr(0,32-(e+g));var m=f.substr(31-e+1,e);var d=n+h+m;set_value(poc_signals[k[1]],parseInt(d,2))},verbal:function(a){return""}};poc_behaviors.DECO={nparameters:1,operation:function(d){poc_states.INEX.value=0;var g=decode_instruction(poc_internal_states.FIRMWARE,poc_ir,get_value(poc_states.REG_IR));if(null==g.oinstruction){alert("ERROR: undefined instruction code in firmware (co:"+g.op_code.toString(2)+", cop:"+g.cop_code.toString(2)+")");poc_states.ROM_MUXA.value=0;poc_states.INEX.value=1;return -1}var f=g.op_code<<6;if(typeof g.oinstruction.cop!="undefined"){f=f+g.cop_code}if(typeof poc_internal_states.ROM[f]=="undefined"){alert("ERROR: undefined rom address "+f+" in firmware");poc_states.ROM_MUXA.value=0;return -1}poc_states.ROM_MUXA.value=poc_internal_states.ROM[f];var h=get_value(poc_states.DECO_INS);set_value(poc_states.DECO_INS,h+1);var a=get_value(poc_states.REG_PC)-4;var e=get_deco_from_pc(a);set_value(poc_states.REG_IR_DECO,e);show_dbg_ir(get_value(poc_states.REG_IR_DECO))},verbal:function(a){return"Decode instruction. "}};poc_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(poc_internal_states.fire_stack.indexOf(a[1])!=-1){return}poc_internal_states.fire_stack.push(a[1]);update_draw(poc_signals[a[1]],poc_signals[a[1]].value);if("L"==poc_signals[a[1]].type){update_state(a[1])}poc_internal_states.fire_stack.pop(a[1]);check_buses(a[1])},verbal:function(a){return""}};poc_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(poc_signals[a[1]])!=parseInt(a[2])){return}poc_behaviors.FIRE.operation(a)},verbal:function(a){return""}};poc_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}poc_behaviors.FIRE.operation(a)},verbal:function(a){return""}};poc_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false},verbal:function(a){return""}};poc_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(poc_states.CLK);set_value(poc_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(poc_states.MUXA_MICROADDR);set_value(poc_states.REG_MICROADDR,new_maddr);if(typeof poc_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(poc_internal_states.MC[new_maddr])}else{var new_mins=Object.create(poc_states.REG_MICROINS.default_value)}poc_states.REG_MICROINS.value=new_mins;for(var key in poc_signals){if(typeof new_mins[key]!="undefined"){set_value(poc_signals[key],new_mins[key])}else{set_value(poc_signals[key],poc_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}},verbal:function(a){return""}};poc_behaviors.RESET={nparameters:1,operation:function(a){for(var d in poc_states){reset_value(poc_states[d])}for(var d in poc_signals){reset_value(poc_signals[d])}},verbal:function(a){return"Reset CPU. "}};poc_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()},verbal:function(a){return""}};poc_behaviors.UPDATE_NZVC={nparameters:1,operation:function(a){update_draw(poc_signals.TEST_N,poc_signals.TEST_N.value);update_draw(poc_signals.TEST_Z,poc_signals.TEST_Z.value);update_draw(poc_signals.TEST_V,poc_signals.TEST_V.value);update_draw(poc_signals.TEST_C,poc_signals.TEST_C.value)},verbal:function(a){return"Update flags N-Z-V-C."}};poc_components.MEMORY={name:"MEMORY",version:"1",abilities:["MEMORY"],write_state:function(e){if(typeof e.MEMORY=="undefined"){e.MEMORY={}}var d=0;var f=0;for(var a in poc_internal_states.MP){f=parseInt(poc_internal_states.MP[a]);if(f!=0){d=parseInt(a).toString(16);e.MEMORY["0x"+d]={type:"memory",default_value:0,id:"0x"+d,op:"=",value:"0x"+f.toString(16)}}}return e},read_state:function(e,a){if(typeof e.MEMORY=="undefined"){e.MEMORY={}}var d=parseInt(a.id).toString(16);var f=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){e.MEMORY["0x"+d]={type:"memory",default_value:0,id:"0x"+d,op:a.condition,value:"0x"+f};return true}return false},get_state:function(d){var a=parseInt(d);if(typeof poc_internal_states.MP[a]!="undefined"){return"0x"+parseInt(poc_internal_states.MP[a]).toString(16)}return null}};poc_internal_states.segments={};poc_internal_states.MP={};poc_internal_states.MP_wc=0;poc_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};poc_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB MRDY CLK; FIRE MRDY; FIRE M1"],fire_name:["svg_p:text3533-5-2","svg_p:text3713"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};poc_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-08","svg_p:text3527"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};poc_behaviors.MEM_READ={nparameters:6,types:["E","E","S","E"],operation:function(d){var a=poc_states[d[1]].value;var e=poc_states[d[2]].value;var g=get_value(poc_states[d[4]]);poc_signals[d[3]].value=0;var h=get_var(poc_internal_states.MP_wc);if((typeof poc_events.mem[g-1]!="undefined")&&(poc_events.mem[g-1]>0)){h=poc_events.mem[g-1]-1}poc_events.mem[g]=h;if(h>0){return}var f=0;a=a&4294967292;if(typeof poc_internal_states.MP[a]!="undefined"){f=poc_internal_states.MP[a]}e=f;poc_states[d[2]].value=(e>>>0);poc_signals[d[3]].value=1;show_main_memory(poc_internal_states.MP,a,false,false)},verbal:function(d){var f="";var a=poc_states[d[1]].value;var e=poc_states[d[2]].value;var h=get_value(poc_states[d[4]]);var g=0;if(typeof poc_internal_states.MP[a]!="undefined"){g=poc_internal_states.MP[a]}f="Try to read a word from memory at address 0x"+a.toString(16)+" with value "+g.toString(16)+". ";return f}};poc_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","E"],operation:function(d){var a=poc_states[d[1]].value;var e=poc_states[d[2]].value;var g=get_value(poc_states[d[4]]);poc_signals[d[3]].value=0;var h=get_var(poc_internal_states.MP_wc);if((typeof poc_events.mem[g-1]!="undefined")&&(poc_events.mem[g-1]>0)){h=poc_events.mem[g-1]-1}poc_events.mem[g]=h;if(h>0){return}var f=0;a=a&4294967292;if(typeof poc_internal_states.MP[a]!="undefined"){f=poc_internal_states.MP[a]}f=e;poc_internal_states.MP[a]=(f>>>0);poc_signals[d[3]].value=1;show_main_memory(poc_internal_states.MP,a,false,true)},verbal:function(d){var f="";var a=poc_states[d[1]].value;var e=poc_states[d[2]].value;var h=get_value(poc_states[d[4]]);var g=0;if(typeof poc_internal_states.MP[a]!="undefined"){g=poc_internal_states.MP[a]}f="Try to write a word to memory at address 0x"+a.toString(16)+" with value "+g.toString(16)+". ";return f}};poc_behaviors.MEM_RESET={nparameters:1,operation:function(a){poc_events.mem={}},verbal:function(a){return"Reset the memory (all values will be zeroes). "}};poc_components.KBD={name:"KBD",version:"1",abilities:["KBD"],write_state:function(a){return a},read_state:function(d,a){return false},get_state:function(a){return null}};var KBDR_ID=256;var KBSR_ID=260;poc_internal_states.io_hash[KBDR_ID]="KBDR";poc_internal_states.io_hash[KBSR_ID]="KBSR";poc_states.KBDR={name:"KBDR",verbal:"Keyboard Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.KBSR={name:"KBSR",verbal:"Keyboard Status Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE M1"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};poc_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(e){var g=get_value(poc_states[e[1]]);var f=get_value(poc_states[e[5]]);if((g!=KBDR_ID)&&(g!=KBSR_ID)){return}if(typeof poc_events.keybd[f]!="undefined"){if(g==KBDR_ID){set_value(poc_states[e[2]],poc_events.keybd[f])}if(g==KBSR_ID){set_value(poc_states[e[2]],1)}return}if(get_value(poc_states[e[4]])==0){var d=get_keyboard_content();if(d.length!=0){var a=d.substr(1,d.length-1);set_keyboard_content(a);set_value(poc_states[e[4]],1);set_value(poc_states[e[3]],d[0].charCodeAt(0))}}if(get_value(poc_states[e[4]])==1){poc_events.keybd[f]=get_value(poc_states[e[3]])}if(g==KBSR_ID){set_value(poc_states[e[2]],get_value(poc_states[e[4]]))}if(g==KBDR_ID){if(get_value(poc_states[e[4]])==1){set_value(poc_states[e[2]],get_value(poc_states[e[3]]))}set_value(poc_states[e[4]],0)}},verbal:function(a){var d="";var f=get_value(poc_states[a[1]]);var e=get_value(poc_states[a[5]]);if(f==KBDR_ID){d="Read the screen data: "+poc_states[a[2]]+". "}if(f==KBSR_ID){d="Read the screen state: "+poc_states[a[2]]+". "}return d}};poc_behaviors.KBD_RESET={nparameters:1,operation:function(a){poc_events.keybd={}},verbal:function(a){return"Reset the keyboard content. "}};poc_components.SCREEN={name:"SCREEN",version:"1",abilities:["SCREEN"],write_state:function(d){if(typeof d.SCREEN=="undefined"){d.SCREEN={}}var f=get_screen_content();var e=f.trim().split("\n");for(var a=0;a<e.length;a++){value=e[a];if(value!=""){d.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return d},read_state:function(d,a){if(typeof d.SCREEN=="undefined"){d.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){d.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var f=get_screen_content();var e=f.trim().split("\n");var d=parseInt(a);if(typeof e[d]!="undefined"){return e[d]}return null}};var DDR_ID=4096;var DSR_ID=4100;poc_internal_states.io_hash[DDR_ID]="DDR";poc_internal_states.io_hash[DSR_ID]="DSR";poc_states.DDR={name:"DDR",verbal:"Display Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.DSR={name:"DSR",verbal:"Display State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};poc_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};poc_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(poc_states[d[1]]);var e=get_value(poc_states[d[3]]);var a=get_value(poc_states[d[4]]);if(f==DDR_ID){set_value(poc_states[d[2]],e)}if(f==DSR_ID){set_value(poc_states[d[2]],a)}},verbal:function(d){var f="";var g=get_value(poc_states[d[1]]);var e=get_value(poc_states[d[3]]);var a=get_value(poc_states[d[4]]);if(g==DDR_ID){f="Try to read from the screen the DDR value "+e+". "}if(g==DDR_ID){f="Try to read into the screen the DSR value "+a+". "}return f}};poc_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(e){var m=get_value(poc_states[e[1]]);var g=get_value(poc_states[e[2]]);var k=get_value(poc_states[e[5]]);var h=String.fromCharCode(g);if(m!=DDR_ID){return}if(h==String.fromCharCode(7)){timbre.reset();var f=T("sin",{freq:440,mul:0.5});var d=T("sin",{freq:660,mul:0.5});T("perc",{r:500},f,d).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof poc_events.screen[k]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(g))}set_value(poc_states[e[3]],g);set_value(poc_states[e[4]],1);poc_events.screen[k]=g},verbal:function(a){var f="";var h=get_value(poc_states[a[1]]);var d=get_value(poc_states[a[2]]);var g=get_value(poc_states[a[5]]);var e=String.fromCharCode(d);if(h==DDR_ID){f="Try to write into the screen the code "+e+" at clock cycle "+g+". "}return f}};poc_behaviors.SCR_RESET={nparameters:1,operation:function(a){poc_events.screen={}},verbal:function(a){return"Reset the screen content. "}};function nextToken(e){var a="";var h="";var g="";var f="";while(("# \t\n\r".indexOf(e.text[e.t])!=-1)&&(e.t<e.text.length)){if(e.text[e.t]=="#"){h=e.t+1;while(("\n".indexOf(e.text[e.t])==-1)&&(e.t<e.text.length)){e.t++}g=e.t;a=e.text.substring(h,g);a=a.trim();e.comments.push(a)}if(e.text[e.t]=="\n"){e.line++;e.newlines.push(e.t)}e.t++}if(("{},()=:".indexOf(e.text[e.t])!=-1)&&(e.t<e.text.length)){a=e.text[e.t];e.t++;e.tokens.push(a);e.token_types.push("TOKEN");e.i=e.tokens.length-1;return e}if('"'==e.text[e.t]){h=e.t;e.t++;while(('"'.indexOf(e.text[e.t])==-1)&&(e.t<e.text.length)){if("\\".indexOf(e.text[e.t])!=-1){e.t++}e.t++}e.t++;g=e.t;f="STRING"}else{if("'"==e.text[e.t]){h=e.t;e.t++;while(("'".indexOf(e.text[e.t])==-1)&&(e.t<e.text.length)){if("\\".indexOf(e.text[e.t])!=-1){e.t++}e.t++}e.t++;g=e.t;f="STRING"}else{h=e.t;while(("{},()=:# \t\n\r".indexOf(e.text[e.t])==-1)&&(e.t<e.text.length)){e.t++}g=e.t;f="TOKEN"}}var d=e.t;while(("# \t\n\r".indexOf(e.text[d])!=-1)&&(d<e.text.length)){if(e.text[d]=="#"){while(("\n".indexOf(e.text[d])==-1)&&(d<e.text.length)){d++}}d++}if(":"==e.text[d]){f="TAG";e.t=d+1}a=e.text.substring(h,g);a=a.trim();if("TAG"==f){a=a+":"}e.tokens.push(a);e.token_types.push(f);e.i=e.tokens.length-1;return e}function getToken(a){return a.tokens[a.i]}function getTokenType(a){return a.token_types[a.i]}function isToken(a,d){return(getToken(a)==d.trim())}function langError(g,h){var a=0;if(g.newlines.length>0){a=g.newlines[g.newlines.length-1]+1}var e=0;if(g.newlines.length>1){e=g.newlines[g.newlines.length-2]+1}var d=e;var k=Math.min(g.t-1,a+32);for(;(typeof g.text[k+1]!="undefined")&&(g.text[k+1]!="\n");k++){}var m=k+2;k++;for(;(typeof g.text[k+1]!="undefined")&&(g.text[k+1]!="\n");k++){}k++;g.error="<pre style='background-color: inherit !important'>...\n";for(var f=d;f<k;f++){if(f==e){g.error+=" "+(g.line-1)+"\t"}if(f==a){g.error+="*"+g.line+"\t"}if(f==m){g.error+=" "+(g.line+1)+"\t"}if(typeof g.text[f]!="undefined"){g.error+=g.text[f]}else{g.error+="&lt;EOF&gt;"}}g.error+="\n...\n</pre>(*) Problem around line "+g.line+":<br>"+h+".<br>";if(typeof ga!=="undefined"){ga("send","event","compile","compile.error","compile.error."+h)}return g}function getLabelContext(a){return{t:a.t,line:a.line,newlines:a.newlines.slice()}}function setLabelContext(d,a){d.t=a.t;d.line=a.line;d.newlines=a.newlines}function getComments(a){return a.comments.join("\n")}function resetComments(a){a.comments=[]}function nextNative(d){var g=d.t;var e=d.t;var f=1;while((d.t<d.text.length)&&(f!=0)){if("{"==d.text[d.t]){f++}if("}"==d.text[d.t]){f--}d.t++}e=d.t-1;var a=d.text.substring(g,e);d.tokens.push(a);d.token_types.push("NATIVE");d.i=d.tokens.length-1;return d}function read_microprg(a){var f=[];var q=[];resetComments(a);if(!isToken(a,"{")){return langError(a,"Expected '{' not found")}nextToken(a);while(!isToken(a,"}")){var n={};if(!isToken(a,"(")){var o=getToken(a);o=o.substring(0,o.length-1);if("TAG"!=getTokenType(a)){return langError(a,"Expected '<label>:' not found but '"+o+"'.")}for(var e in a.etiquetas){if(a.etiquetas[e]==o){return langError(a,"Label is repeated: "+getToken(a))}}a.etiquetas[a.contadorMC]=o;if(o.match("[a-zA-Z_0-9]*")[0]!=o){return langError(a,"Label format is not valid for '"+getToken(a)+"'")}nextToken(a)}if(!isToken(a,"(")){return langError(a,"Expected '(' not found")}nextToken(a);while(!isToken(a,")")){var h=getToken(a).toUpperCase();if(h=="MADDR"){nextToken(a);if(!isToken(a,"=")){return langError(a,"Expected '=' not found")}nextToken(a);var p={};p.nombre=getToken(a);p.cycle=f.length;p.index=a.i;p.instruction=a.instrucciones.length;var g=0;for(var m in a.etiquetas){if(isToken(a,a.etiquetas[m])){n[h]=m.toString();g=1}}if(g==0){a.labelsNotFound.push(p)}nextToken(a);if(isToken(a,",")){nextToken(a)}continue}if(typeof simhw_sim_signal(h)=="undefined"){return langError(a,"Signal does not exists: '"+h+"'")}if(typeof simhw_sim_signal(h).forbidden!="undefined"){return langError(a,"Signal '"+h+"' cannot be used directly, please use the Control Unit signals instead.")}n[h]=1;nextToken(a);if(isToken(a,"=")){nextToken(a);n[h]=parseInt(getToken(a),2);if(getToken(a).match("[01]*")[0]!=getToken(a)){return langError(a,"Incorrect binary format: "+getToken(a))}if(n[h]>=Math.pow(2,simhw_sim_signal(h).nbits)){return langError(a,"Value out of range: "+getToken(a))}nextToken(a)}if(isToken(a,",")){nextToken(a)}}var d=getComments(a);q.push(d);resetComments(a);f.push(n);a.contadorMC++;nextToken(a);if(isToken(a,",")){nextToken(a)}}if(f.length==0){return langError(a,"Empty microcode")}nextToken(a);return{microprograma:f,microcomments:q}}function read_native(d){var f=[];var a=[];if(!isToken(d,"{")){return langError(d,"Expected '{' not found")}nextNative(d);var e={};e.NATIVE=getToken(d);f.push(e);a.push("");nextToken(d);return{microprograma:f,microcomments:a}}function loadFirmware(text){var ir_info=simhw_sim_irInfo();var all_ones_co="1".repeat(ir_info.default_eltos.co.length);var context={};context.line=1;context.error=null;context.i=0;context.contadorMC=0;context.etiquetas={};context.labelsNotFound=[];context.instrucciones=[];context.co_cop={};context.registers=[];context.text=text;context.tokens=[];context.token_types=[];context.t=0;context.newlines=[];context.pseudoInstructions=[];context.stackRegister=null;context.comments=[];nextToken(context);while(context.t<context.text.length){if(isToken(context,"registers")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var nombre_reg=getToken(context);nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);context.registers[nombre_reg]=getToken(context);nextToken(context);if(isToken(context,"(")){if(context.stackRegister!=null){return langError(context,"Duplicate definition of stack pointer")}nextToken(context);if(!isToken(context,"stack_pointer")){return langError(context,"Expected stack_pointer token not found")}context.stackRegister=nombre_reg;nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context)}if(isToken(context,",")){nextToken(context)}}nextToken(context);continue}if(isToken(context,"pseudoinstructions")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var pseudoInstructionAux={};var pseudoInitial={};pseudoInitial.signature="";pseudoInitial.name="";pseudoInitial.fields=[];pseudoInitial.name=getToken(context);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);while(!isToken(context,"{")){var pseudoFieldAux={};pseudoFieldAux.name=getToken(context);pseudoFieldAux.type=getToken(context).replace("num","inm");pseudoFieldAux.type=pseudoFieldAux.type.replace(/[_0-9]+$/,"");switch(pseudoFieldAux.type){case"reg":case"inm":case"addr":case"address":break;default:return langError(context,"Invalid parameter '"+pseudoFieldAux.type+"'. It only allows the following fields: reg, num, inm, addr, address")}pseudoInitial.fields.push(pseudoFieldAux);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);if(isToken(context,",")){nextToken(context)}}nextToken(context);pseudoInitial.signature=pseudoInitial.signature.substr(0,pseudoInitial.signature.length-1).replace(/num/g,"inm");pseudoInstructionAux.initial=pseudoInitial;var contPseudoFinish=0;var pseudoFinishAux={};pseudoFinishAux.signature="";var inStart=0;var cont=false;while(!isToken(context,"}")){if(inStart==0){for(i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name==getToken(context)){cont=true;break}}if(!cont){return langError(context,"Undefined instruction '"+getToken(context)+"'")}}if(getToken(context)==";"){inStart=0}else{inStart++}pseudoFinishAux.signature=pseudoFinishAux.signature+getToken(context)+" ";nextToken(context)}pseudoInstructionAux.finish=pseudoFinishAux;pseudoInstructionAux.finish.signature=pseudoInstructionAux.finish.signature.replace(";","\n");context.pseudoInstructions.push(pseudoInstructionAux);nextToken(context)}nextToken(context);continue}if(isToken(context,"begin")){var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;nextToken(context);if(isToken(context,",")){nextToken(context)}instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}context.etiquetas[context.contadorMC]="fetch"}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.signature="begin";instruccionAux.signatureGlobal="begin";instruccionAux.signatureUser="begin";instruccionAux.signatureRaw="begin";instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;continue}var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;if(instruccionAux.name.match("[a-zA-Z_0-9]*")[0]!=instruccionAux.name){return langError(context,"Instruction name '"+instruccionAux.name+"' is not valid for [a-zA-Z_0-9]*")}var firma="";var firmaGlobal="";var firmaUsuario="";var numeroCampos=0;var campos=[];firma=getToken(context)+",";firmaUsuario=getToken(context)+" ";nextToken(context);while(isToken(context,",")){nextToken(context)}while(!isToken(context,"{")){while(isToken(context,",")){nextToken(context)}var plus_found=false;if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};var auxValue=getToken(context);if(auxValue[auxValue.length-1]=="+"){auxValue=auxValue.substring(0,auxValue.length-1);plus_found=true}campoAux.name=auxValue;campos.push(campoAux);numeroCampos++;firma=firma+auxValue;firmaUsuario=firmaUsuario+auxValue;nextToken(context);if(numeroCampos>100){return langError(context,"more than 100 fields in a single instruction.")}if(auxValue=="co"){return langError(context,"instruction field has 'co' as name.")}if(auxValue=="nwords"){return langError(context,"instruction field has 'nwords' as name.")}}if(isToken(context,"(")){firma=firma+",(";if(plus_found){firmaUsuario=firmaUsuario+"+("}else{firmaUsuario=firmaUsuario+" ("}nextToken(context);if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};campoAux.name=getToken(context);campos.push(campoAux);numeroCampos++;firma=firma+getToken(context);firmaUsuario=firmaUsuario+getToken(context);nextToken(context)}else{return langError(context,"'token' is missing after '(' on: "+context.co_cop[instruccionAux.co].signature)}if(isToken(context,")")){firma=firma+")";firmaUsuario=firmaUsuario+")";nextToken(context)}else{return langError(context,"')' is missing on: "+context.co_cop[instruccionAux.co].signature)}}firma=firma+",";firmaUsuario=firmaUsuario+" "}firma=firma.substr(0,firma.length-1);firma=firma.replace(/,,/g,",");firmaUsuario=firmaUsuario.substr(0,firmaUsuario.length-1);firmaUsuario=firmaUsuario.replace(/  /g," ");instruccionAux.signature=firma;instruccionAux.signatureGlobal=firma;instruccionAux.signatureUser=firmaUsuario;instruccionAux.signatureRaw=firmaUsuario;nextToken(context);if(!isToken(context,"co")){return langError(context,"Expected keyword 'co' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.co=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!=ir_info.default_eltos.co.length)){return langError(context,"Incorrect binary format on 'co': "+getToken(context))}if(instruccionAux.co!=all_ones_co){if((typeof context.co_cop[instruccionAux.co]!="undefined")&&(context.co_cop[instruccionAux.co].cop==null)){return langError(context,"'co' is already been used by: "+context.co_cop[instruccionAux.co].signature)}if(typeof context.co_cop[instruccionAux.co]=="undefined"){context.co_cop[instruccionAux.co]={};context.co_cop[instruccionAux.co].signature=instruccionAux.signature;context.co_cop[instruccionAux.co].cop=null}}nextToken(context);if(isToken(context,",")){nextToken(context)}if(isToken(context,"cop")){nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.cop=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!=ir_info.default_eltos.cop.length)){return langError(context,"Incorrect binary format on 'cop': "+getToken(context))}if((context.co_cop[instruccionAux.co].cop!=null)&&(typeof context.co_cop[instruccionAux.co].cop[instruccionAux.cop]!="undefined")){return langError(context,"'co+cop' is already been used by: "+context.co_cop[instruccionAux.co].cop[instruccionAux.cop])}if(context.co_cop[instruccionAux.co].cop==null){context.co_cop[instruccionAux.co].cop={}}context.co_cop[instruccionAux.co].cop[instruccionAux.cop]=instruccionAux.signature;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(!isToken(context,"nwords")){return langError(context,"Expected keyword 'nwords' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.nwords=getToken(context);nextToken(context);if(isToken(context,",")){nextToken(context)}var camposInsertados=0;var overlapping={};while(camposInsertados<numeroCampos){var tmp_name=getToken(context);if(campos[camposInsertados]["name"]!=tmp_name){return langError(context,"Unexpected field found: '"+tmp_name+"'")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);if(!isToken(context,"reg")&&!isToken(context,"inm")&&!isToken(context,"address")){return langError(context,"Incorrect type of field (reg, inm or address)")}campos[camposInsertados]["type"]=getToken(context);firma=firma.replace(","+campos[camposInsertados]["name"],","+campos[camposInsertados]["type"]);firma=firma.replace("("+campos[camposInsertados]["name"],"("+campos[camposInsertados]["type"]);firma=firma.replace(")"+campos[camposInsertados]["name"],")"+campos[camposInsertados]["type"]);firmaUsuario=firmaUsuario.replace(campos[camposInsertados]["name"],campos[camposInsertados]["type"]);instruccionAux.signature=firma;instruccionAux.signatureUser=firmaUsuario;firmaGlobal=firma.replace("address","num");firmaGlobal=firmaGlobal.replace("inm","num");instruccionAux.signatureGlobal=firmaGlobal;nextToken(context);if(!isToken(context,"(")){return langError(context,"Expected '(' not found")}nextToken(context);campos[camposInsertados]["startbit"]=getToken(context);var start=parseInt(campos[camposInsertados]["startbit"]);if(start>32*parseInt(instruccionAux.nwords)-1){return langError(context,"startbit out of range: "+getToken(context))}nextToken(context);if(!isToken(context,",")){return langError(context,"Expected ',' not found")}nextToken(context);campos[camposInsertados]["stopbit"]=getToken(context);var stop=parseInt(campos[camposInsertados]["stopbit"]);if(stop>32*parseInt(instruccionAux.nwords)){return langError(context,"stopbit out of range: "+getToken(context))}for(var i=stop;i<=start;i++){if(typeof overlapping[i]!="undefined"){return langError(context,"overlapping field: "+campos[camposInsertados]["name"])}overlapping[i]=1}nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context);if(campos[camposInsertados]["type"]=="address"){if(getToken(context)!="abs"&&getToken(context)!="rel"){return langError(context,"Type of addressing incorrect (abs or rel)")}campos[camposInsertados]["address_type"]=getToken(context);nextToken(context)}if(isToken(context,",")){nextToken(context)}camposInsertados++}instruccionAux.fields=campos;instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;if(!isToken(context,"}")){return langError(context,"Expected '}' not found")}nextToken(context)}if(context.stackRegister==null){return langError(context,"Stack pointer register was not defined")}var found=false;for(var i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name=="begin"){for(var j=0;j<context.instrucciones[i].microcode.length;j++){if((typeof context.etiquetas[j]!="undefined")&&(context.etiquetas[j]=="fetch")){found=true}}if(found===false){return langError(context,"label 'fetch' not defined")}}}if(found===false){return langError(context,"'begin' not found")}var first_co=0;var last_co=Math.pow(2,6)-1;var label="";for(var i=0;i<context.instrucciones.length;i++){if((context.instrucciones[i].name!="begin")&&(context.instrucciones[i].co=="111111")){for(var j=first_co;j<last_co;j++){label=j.toString(2);label="000000".substring(0,6-label.length)+label;if(typeof context.co_cop[label]=="undefined"){break}}if(j>=last_co){return langError(context,"There is not enough 'co' codes available for instructions")}context.instrucciones[i].co=label;context.co_cop[label]={};context.co_cop[label].signature=context.instrucciones[i].signature;context.co_cop[label].cop=null;first_co=j}}var labelsFounded=0;if(context.labelsNotFound.length>0){for(var i=0;i<context.labelsNotFound.length;i++){for(var j in context.etiquetas){if(context.etiquetas[j]==context.labelsNotFound[i].nombre){context.instrucciones[context.labelsNotFound[i].instruction].microcode[context.labelsNotFound[i].cycle].MADDR=j;labelsFounded++}}if(labelsFounded==0){return langError(context,"MADDR label not found : "+context.labelsNotFound[i].nombre)}labelsFounded=0}}var mk_native="";for(var i=0;i<context.instrucciones.length;i++){var ins=context.instrucciones[i];if(false==ins["native"]){continue}for(var j=0;j<ins.microcode.length;j++){if(typeof ins.microcode[j].NATIVE!="undefined"){mk_native+="context.instrucciones["+i+']["microcode"]['+j+']["NATIVE_JIT"] =  function() {\n\t var fields = simcore_native_get_fields("'+ins.signatureRaw+'");\n'+ins.microcode[j].NATIVE+"\n};\n "}}}eval(mk_native);var fico=0;var ficop=0;context.cocop_hash={};for(var fi in context.instrucciones){if(context.instrucciones[fi].name=="begin"){continue}fico=context.instrucciones[fi].co;if(typeof context.cocop_hash[fico]=="undefined"){context.cocop_hash[fico]={}}if(typeof context.instrucciones[fi].cop=="undefined"){context.cocop_hash[fico].withcop=false;context.cocop_hash[fico].i=context.instrucciones[fi]}else{ficop=context.instrucciones[fi].cop;context.cocop_hash[fico].withcop=true;context.cocop_hash[fico][ficop]=context.instrucciones[fi]}}var ret={};ret.error=null;ret.firmware=context.instrucciones;ret.labels_firm=context.etiquetas;ret.mp={};ret.seg={};ret.registers=context.registers;ret.pseudoInstructions=context.pseudoInstructions;ret.stackRegister=context.stackRegister;ret.cocop_hash=context.cocop_hash;return ret}function saveFirmware(a){var g="";for(var f=0;f<a.firmware.length;f++){g+=a.firmware[f].signatureRaw;g+=" {\n";if(typeof a.firmware[f].co!="undefined"){g+="\tco="+a.firmware[f].co+",\n"}if(typeof a.firmware[f].cop!="undefined"){g+="\tcop="+a.firmware[f].cop+",\n"}if(typeof a.firmware[f].nwords!="undefined"){g+="\tnwords="+a.firmware[f].nwords+",\n"}if(typeof a.firmware[f].fields!="undefined"){if(a.firmware[f].fields.length>0){for(var e=0;e<a.firmware[f].fields.length;e++){g+="\t"+a.firmware[f].fields[e].name+" = "+a.firmware[f].fields[e].type;g+="("+a.firmware[f].fields[e].startbit+","+a.firmware[f].fields[e].stopbit+")";if(a.firmware[f].fields[e].type=="address"){g+=a.firmware[f].fields[e].address_type}g+=",\n"}}}if(typeof a.firmware[f].microcode!="undefined"){var n=a.firmware[f]["mc-start"];if(a.firmware[f].name!="begin"){g+="\t{"}for(var e=0;e<a.firmware[f].microcode.length;e++){if(""!=a.firmware[f].microcomments[e]){g+="\n\t\t# "+a.firmware[f].microcomments[e]}if(typeof a.labels_firm[n]!="undefined"){g+="\n"+a.labels_firm[n]+":\t"}else{g+="\n\t\t"}g+="(";var h=0;for(var d in a.firmware[f].microcode[e]){if("MADDR"==d){var m=a.firmware[f].microcode[e][d];if(typeof a.labels_firm[m]=="undefined"){g+=d+"="+m.toString(2)+", "}else{g+=d+"="+a.labels_firm[m]+", "}continue}g+=d+"="+a.firmware[f].microcode[e][d].toString(2)+", ";h=1}if(h==1){g=g.substr(0,g.length-2)}g+="),";n++}g=g.substr(0,g.length-1);if(a.firmware[f].name!="begin"){g+="\n\t}"}}g+="\n}\n\n"}if((typeof a.registers!="undefined")&&(a.registers.length>0)){g+="registers\n{\n";for(var f=0;f<a.registers.length;f++){if(a.stackRegister==f){g+="\t"+f+"="+a.registers[f]+" (stack_pointer),\n"}else{g+="\t"+f+"="+a.registers[f]+",\n"}}g=g.substr(0,g.length-2);g+="\n}\n"}return g}function decode_instruction(d,f,g){var a={oinstruction:null,op_code:0,cop_code:0};var e=g.toString(2);e="00000000000000000000000000000000".substring(0,32-e.length)+e;var h=e.substr(f.default_eltos.co.begin,f.default_eltos.co.length);a.op_code=parseInt(h,2);var k=e.substr(f.default_eltos.cop.begin,f.default_eltos.cop.length);a.cop_code=parseInt(k,2);if(false==d.cocop_hash[h].withcop){a.oinstruction=d.cocop_hash[h].i}else{a.oinstruction=d.cocop_hash[h][k]}return a}function decode_ram(){var h="\n";var e=simhw_sim_irInfo();var f=simhw_internalState("FIRMWARE");var d=simhw_internalState("MP");for(var a in d){var g=d[a].toString(2);g="00000000000000000000000000000000".substring(0,32-g.length)+g;h+="0x"+parseInt(a).toString(16)+":"+decode_instruction(f,e,g).oinstruction+"\n"}return h}BYTE_LENGTH=8;WORD_BYTES=4;WORD_LENGTH=WORD_BYTES*BYTE_LENGTH;directives={};directives[".kdata"]={name:".kdata",kindof:"segment",size:0};directives[".ktext"]={name:".ktext",kindof:"segment",size:0};directives[".data"]={name:".data",kindof:"segment",size:0};directives[".text"]={name:".text",kindof:"segment",size:0};directives[".byte"]={name:".byte",kindof:"datatype",size:1};directives[".half"]={name:".half",kindof:"datatype",size:2};directives[".word"]={name:".word",kindof:"datatype",size:4};directives[".space"]={name:".space",kindof:"datatype",size:1};directives[".ascii"]={name:".ascii",kindof:"datatype",size:1};directives[".asciiz"]={name:".asciiz",kindof:"datatype",size:1};directives[".align"]={name:".align",kindof:"datatype",size:0};function get_datatype_size(a){if(typeof directives[a]=="undefined"){console.log("data type: "+a+" is not defined!!!\n");return 0}return directives[a].size}function isTokenKindOf(d,a){if(typeof directives[d]=="undefined"){return false}return(directives[d].kindof==a)}function is_directive(a){return(typeof directives[a]!="undefined")}function is_directive_segment(a){return isTokenKindOf(a,"segment")}function is_directive_datatype(a){return isTokenKindOf(a,"datatype")}function isDecimal(d){if(d.length>1&&d[0]=="0"){return false}if(!isNaN(parseFloat(d))&&isFinite(d)){var a=parseInt(d);if(typeof d=="string"&&d.includes(".")){alert("Truncating conversion has occurred: "+d+" became "+a)}return a}return false}function isOctal(e){if(e.substring(0,1)=="0"){var d=e.substring(1).replace(/\b0+/g,"");var a=parseInt(d,8);return(a.toString(8)===d)?a:false}return false}function isHex(e){if(e.substring(0,2).toLowerCase()=="0x"){var d=e.substring(2).toLowerCase().replace(/\b0+/g,"");if(d==""){d="0"}var a=parseInt(d,16);return(a.toString(16)===d)?a:false}return false}function isChar(e){var d=treatControlSequences(e);if(true==d.error){return false}var a=d.string;if(a[0]=="'"&&a[2]=="'"){return a.charCodeAt(1)}return false}function decimal2binary(e,d){var a=e.toString(2);if(a.length>WORD_LENGTH){return[a,d-a.length]}a=(e>>>0).toString(2);if(e>=0){return[a,d-a.length]}a="1"+a.replace(/^[1]+/g,"");if(a.length>d){return[a,d-a.length]}a="1".repeat(d-a.length)+a;return[a,d-a.length]}function isValidTag(a){if(!(isDecimal(a[0])===false)){return false}var d=/[^a-z,_\d]/i;return !(d.test(a))}function sum_array(d){return d.reduce(function(f,e){return f+e},0)}function get_candidate(h,a){var f=false;var g={};var k={};for(d=0;d<h.length;d++){if(h[d]){g[d]=a[d].nwords;k[a[d].signature]=0}}if(Object.keys(k).length==1){var e=false;for(var d in g){if(e==false){e=g[d];f=d}else{if(e==g[d]){f=false}else{if(e>g[d]){e=g[d];f=d}}}}}return f?parseInt(f):f}function reset_assembly(a){return"0".repeat(WORD_LENGTH*a)}function assembly_replacement(h,e,f,d,a){var g=h.substring(0,h.length-f+a);h=g+e+h.substring(h.length-d);return h}function assembly_co_cop(f,d,e){var a=simhw_sim_irInfo();if(d!==false){f=assembly_replacement(f,d,WORD_LENGTH,WORD_LENGTH-6,0)}if(e!==false){f=assembly_replacement(f,e,a.default_eltos.cop.length,0,0)}return f}function writememory_and_reset(d,e,a){if(e.byteWord>=WORD_BYTES){d["0x"+e.seg_ptr.toString(16)]=e.machineCode;e.seg_ptr=e.seg_ptr+WORD_BYTES;e.byteWord=0;e.machineCode=reset_assembly(a)}}function is_end_of_file(a){return""===getToken(a)&&a.t>=a.text.length}function treatControlSequences(a){var d={};d.string="";d.error=false;for(var e=0;e<a.length;e++){if("\\"!=a[e]){d.string=d.string+a[e];continue}e++;switch(a[e]){case"b":d.string=d.string+"\b";break;case"f":d.string=d.string+"\f";break;case"n":d.string=d.string+"\n";break;case"r":d.string=ret_string+"\r";break;case"t":d.string=d.string+"\t";break;case"v":d.string=d.string+"\v";break;case"a":d.string=d.string+String.fromCharCode(7);break;case"'":d.string=d.string+"'";break;case'"':d.string=d.string+'"';break;case"0":d.string=d.string+"\0";break;default:d.string="Unknown escape char '\\"+a[e]+"'";d.error=true;return d}}return d}function read_data(d,s,n){var m=getToken(d);var h={};h.byteWord=0;h.machineCode=reset_assembly(1);h.seg_ptr=n.seg[m].begin;nextToken(d);while(!is_directive_segment(getToken(d))&&!is_end_of_file(d)){var t="";while(!is_directive_datatype(getToken(d))&&!is_end_of_file(d)){t=getToken(d);if("TAG"!=getTokenType(d)){return langError(d,"Expected tag or directive but found '"+t+"' instead")}var v=t.substring(0,t.length-1);if(!isValidTag(v)){return langError(d,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+v+"' instead")}if(d.firmware[v]){return langError(d,"A tag can not have the same name as an instruction ("+v+")")}if(n.labels2[v]){return langError(d,"Repeated tag: '"+v+"'")}n.labels2[v]="0x"+(h.seg_ptr+h.byteWord).toString(16);nextToken(d)}if(is_end_of_file(d)){break}var e=getToken(d);if((".word"==e)||(".half"==e)||(".byte"==e)){nextToken(d);var g=getToken(d);while(!is_directive(getToken(d))&&!is_end_of_file(d)){var f;var o=false;if((f=isOctal(g))!==false){}else{if((f=isHex(g))!==false){}else{if((f=isDecimal(g))!==false){}else{if((f=isChar(g))!==false){}else{if(".word"==e){if(!isValidTag(g)){return langError(d,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+g+"' instead")}if(d.firmware[g]){return langError(d,"A tag can not have the same name as an instruction ("+g+")")}f=0;o=true}else{return langError(d,"Expected value for numeric datatype but found '"+g+"' instead")}}}}}var u=get_datatype_size(e);var q=decimal2binary(f,u*BYTE_LENGTH);num_bits=q[0];free_space=q[1];if(free_space<0){return langError(d,"Expected value that fits in a '"+e+"' ("+u*BYTE_LENGTH+" bits), but inserted '"+g+"' ("+num_bits.length+" bits) instead")}writememory_and_reset(n.mp,h,1);while(((h.seg_ptr+h.byteWord)%u)!=0){h.byteWord++;writememory_and_reset(n.mp,h,1)}if(""!=t){n.labels2[t.substring(0,t.length-1)]="0x"+(h.seg_ptr+h.byteWord).toString(16);t=""}if(o){n.labels["0x"+h.seg_ptr.toString(16)]={name:g,addr:h.seg_ptr,startbit:31,stopbit:0,rel:undefined,nwords:1,labelContext:getLabelContext(d)}}h.machineCode=assembly_replacement(h.machineCode,num_bits,BYTE_LENGTH*(u+h.byteWord),BYTE_LENGTH*h.byteWord,free_space);h.byteWord+=u;nextToken(d);if(","==getToken(d)){nextToken(d)}if(is_directive(getToken(d))||("TAG"==getTokenType(d))||"."==getToken(d)[0]){break}g=getToken(d)}}else{if(".space"==e){nextToken(d);var g=getToken(d);if(!isDecimal(g)){return langError(d,"Expected number of bytes to reserve in .space but found '"+g+"' as number")}if(g<0){return langError(d,"Expected positive number but found '"+g+"' as positive number")}for(i=0;i<g;i++){writememory_and_reset(n.mp,h,1);h.byteWord++}nextToken(d)}else{if(".align"==e){nextToken(d);var g=getToken(d);if(!isDecimal(g)&&g>=0){return langError(d,"Expected the align parameter as positive number but found '"+g+"'. Remember that number is the power of two for alignment, see MIPS documentation..")}writememory_and_reset(n.mp,h,1);var k=Math.pow(2,parseInt(g));switch(k){case 1:break;case 2:if(h.byteWord&1==1){h.byteWord++}break;default:while(true){writememory_and_reset(n.mp,h,1);if(h.seg_ptr%k==0&&h.byteWord==0){break}h.byteWord++}}nextToken(d)}else{if(".ascii"==e||".asciiz"==e){nextToken(d);var g=getToken(d);var p=treatControlSequences(g);if(true==p.error){return langError(d,p.string)}g=p.string;while(!is_directive(getToken(d))&&!is_end_of_file(d)){writememory_and_reset(n.mp,h,1);if(""==g){return langError(d,"String is not closed (forgot to end it with quotation marks)")}if("STRING"!=getTokenType(d)){return langError(d,"Expected string between quotation marks but found '"+g+"' instead")}for(i=0;i<g.length;i++){writememory_and_reset(n.mp,h,1);if(g[i]=='"'){continue}num_bits=g.charCodeAt(i).toString(2);h.machineCode=assembly_replacement(h.machineCode,num_bits,BYTE_LENGTH*(1+h.byteWord),BYTE_LENGTH*h.byteWord,BYTE_LENGTH-num_bits.length);h.byteWord++}if(".asciiz"==e){writememory_and_reset(n.mp,h,1);num_bits="\0".charCodeAt(0).toString(2);h.machineCode=assembly_replacement(h.machineCode,num_bits,BYTE_LENGTH*(1+h.byteWord),BYTE_LENGTH*h.byteWord,BYTE_LENGTH-num_bits.length);h.byteWord++}nextToken(d);if(","==getToken(d)){nextToken(d)}if(is_directive(getToken(d))||("TAG"==getTokenType(d))||"."==getToken(d)[0]){break}g=getToken(d);p=treatControlSequences(g);if(true==p.error){return langError(d,p.string)}g=p.string}}else{return langError(d,"Unexpected datatype name '"+e)}}}}}if(h.byteWord>0){n.mp["0x"+h.seg_ptr.toString(16)]=h.machineCode;h.seg_ptr=h.seg_ptr+WORD_BYTES}n.seg[m].end=h.seg_ptr}function read_text(U,d,F){var I=getToken(U);var h=F.seg[I].begin;var E=U.firmware;var z=U.pseudoInstructions;var w=false;var f=-1;var S={};for(i=0;i<d.registers.length;i++){var o="$"+i;S[o]=i;S[d.registers[i]]=S[o]}nextToken(U);while(!is_directive_segment(getToken(U))&&!is_end_of_file(U)){while(!w&&typeof E[getToken(U)]=="undefined"&&!is_end_of_file(U)){var e=getToken(U);if("TAG"!=getTokenType(U)){return langError(U,"Expected tag or instruction but found '"+e+"' instead")}var N=e.substring(0,e.length-1);if(!isValidTag(N)){return langError(U,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+N+"' instead")}if(E[N]){return langError(U,"A tag can not have the same name as an instruction ("+N+")")}if(F.labels2[N]){return langError(U,"Repeated tag: '"+N+"'")}F.labels2[N]="0x"+h.toString(16);nextToken(U)}if(is_end_of_file(U)){break}if(!w){var y=getToken(U);var n=[]}else{var y=n[O][f++]}var P=[];var a=[];var m=[];var R=0;var M=[];for(i=0;i<E[y].length;i++){P[i]=E[y][i].signature.split(",");a[i]=E[y][i].signatureUser.split(" ");P[i].shift();a[i].shift();m[i]=1;M[i]=[];R=Math.max(R,P[i].length);if(z[y]){n[i]=E[y][i].finish.replace(/ ,/g,"").replace(/num/g,"inm").split(" ");n[i].pop();w=true;var Q=0;var v={}}}var L=[];L[0]=y;for(i=0;i<R;i++){if(f==-1){nextToken(U);if(","==getToken(U)){nextToken(U)}var K=getToken(U)}else{var H=n[O][f++];if(v[H]){var K=v[H]}else{var K=H}}var J;if("TAG"!=getTokenType(U)&&!E[K]){L[i+1]=K}for(j=0;j<m.length;j++){if(m[j]==0){continue}if(i>=P[j].length){if("TAG"!=getTokenType(U)&&!E[K]){m[j]=0}continue}var k=E[y][j].fields[i];var g=k.startbit-k.stopbit+1;var x=false;var q=false;switch(k.type){case"address":case"inm":if(w&&"sel"==K){f++;var B=n[O][f++];var t=n[O][f++];var K=v[n[O][f++]];f++;q=true}if((J=isOctal(K))!==false){}else{if((J=isHex(K))!==false){}else{if((J=isDecimal(K))!==false){}else{if((J=isChar(K))!==false){}else{if((K[0]=="'")){var C="Unexpected inmediate value, found: '"+K+"' instead";m[j]=0;break}if(!isValidTag(K)){var C="A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+K+"' instead";m[j]=0;break}if(E[K]){var C="A tag can not have the same name as an instruction ("+K+")";m[j]=0;break}x=true}}}}if(q){G=decimal2binary(J,WORD_LENGTH);if(G[1]<0){return langError(U,"'"+K+"' is bigger than "+WORD_LENGTH+" bits")}J="0".repeat(G[1])+G[0];J=J.substring(WORD_LENGTH-B-1,WORD_LENGTH-t);J=parseInt(J,2);L[i+1]="0x"+J.toString(16)}if(!x){var G=decimal2binary(J,g);if(k.type=="address"&&"rel"==k.address_type){G=decimal2binary(J-h-WORD_BYTES,g)}}break;case"reg":var o=false;if("("==K){if("(reg)"!=P[j][i]){var C="Expected register but found register beween parenthesis";m[j]=0;break}if(f==-1){nextToken(U);K=getToken(U)}else{K=v[n[O][f++]]}o=true}else{if("(reg)"==P[j][i]){var C="Expected register between parenthesis but found '"+K+"' instead";m[j]=0;break}}if(typeof S[K]=="undefined"){var C="Expected register ($1, ...) but found '"+K+"' instead";m[j]=0;break}if(o){L[i+1]="("+K+")";if(f==-1){nextToken(U);o=getToken(U)}else{o=n[O][f++]}if(")"!=o){var C="String without end parenthesis ')'";m[j]=0;break}}J=isDecimal(S[K]);var G=decimal2binary(J,g);break;default:return langError(U,"An unknown error ocurred (1)")}if(m[j]==1&&!x){if(G[1]<0){if(k.type=="address"&&"rel"==k.address_type){C="Relative value ("+(J-h-WORD_BYTES)+" in decimal) needs "+G[0].length+" bits in binary but there is space for only "+g+" bits"}else{var C="'"+K+"' needs "+G[0].length+" bits in binary but there is space for only "+g+" bits"}m[j]=0}}if(m[j]==1&&(!(w&&f==-1))){M[j][i]={num_bits:(x?false:G[0]),free_space:(x?false:G[1]),startbit:k.startbit,stopbit:k.stopbit,rel:(x?k.address_type:false),islabel:x,field_name:K}}}if(sum_array(m)==0){break}if("TAG"==getTokenType(U)||E[K]){break}}var O;for(i=0;i<m.length;i++){if(m[i]==1){O=i}}var D="";for(i=0;i<E[y].length;i++){if(i>0&&i<E[y].length-1){D+=", "}if(i>0&&i==E[y].length-1){D+=" or "}D+="'"+E[y][i].signatureUser+"'"}var A=sum_array(m);if(A==0){if(m.length==1){return langError(U,C+". Remember that the instruction format has been defined as: "+D)}return langError(U,"Instruction and fields don't match with microprogram. Remember that the instruction formats have been defined as: "+D+". Please check the microcode. Probably you forgot to add a field, a number does not fit in its space, or you just used a wrong instruction")}if(A>1){O=get_candidate(m,E[y]);if(O===false){return langError(U,"Instruction and fields match with more than one microprogram. Please check the microcode. Currently, the instruction format can be: "+D)}}if(w){if(f==-1){var p="";for(i=0;i<L.length;i++){p=p+L[i]+" "}p=p.substring(0,p.length-1);for(i=0;i<P[O].length;i++){v[P[O][i]]=L[i+1]}f++;continue}else{Q++}if(Q>1){p="&nbsp;"}if(n[O][f]=="\n"){f++}}var u=reset_assembly(E[y][O].nwords);u=assembly_co_cop(u,E[y][O].co,E[y][O].cop);for(i=0;i<M[O].length;i++){if(M[O][i].islabel){F.labels["0x"+h.toString(16)]={name:M[O][i].field_name,addr:h,startbit:M[O][i].startbit,stopbit:M[O][i].stopbit,rel:M[O][i].rel,nwords:E[y][O].nwords,labelContext:getLabelContext(U)}}else{u=assembly_replacement(u,M[O][i].num_bits,M[O][i].startbit-(-1),M[O][i].stopbit,M[O][i].free_space)}}s_def=L[0];for(i=0,j=1;i<a[O].length;i++,j++){switch(a[O][i]){case"address":case"inm":case"reg":case"(reg)":s_def=s_def+" "+L[j];break;default:s_def=s_def+" "+L[j]+L[j+1];j++}}if(!w){var p=s_def}for(i=E[y][O].nwords-1;i>=0;i--){if(i<E[y][O].nwords-1){s_def="---"}F.assembly["0x"+h.toString(16)]={breakpoint:false,binary:u.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH),source:s_def,source_original:p};F.mp["0x"+h.toString(16)]=u.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH);h=h+WORD_BYTES}if(!w&&R==P[O].length){nextToken(U)}if(w&&f==n[O].length){f=-1;Q=0;w=false;nextToken(U)}if(U.t>=U.text.length){break}}F.seg[I].end=h}function simlang_compile(t,u){var e={};e.line=1;e.error=null;e.i=0;e.contadorMC=0;e.etiquetas={};e.labelsNotFound=[];e.instrucciones=[];e.co_cop={};e.registers=[];e.text=t;e.tokens=[];e.token_types=[];e.t=0;e.newlines=[];e.pseudoInstructions=[];e.stackRegister=null;e.firmware={};e.pseudoInstructions={};e.comments=[];for(i=0;i<u.firmware.length;i++){var f=u.firmware[i];if(typeof e.firmware[f.name]=="undefined"){e.firmware[f.name]=[]}e.firmware[f.name].push({name:f.name,nwords:parseInt(f.nwords),co:(typeof f.co!="undefined"?f.co:false),cop:(typeof f.cop!="undefined"?f.cop:false),fields:(typeof f.fields!="undefined"?f.fields:false),signature:f.signature,signatureUser:(typeof f.signatureUser!="undefined"?f.signatureUser:f.name),isPseudoinstruction:false})}for(i=0;i<u.pseudoInstructions.length;i++){var h=u.pseudoInstructions[i].initial;var p=u.pseudoInstructions[i].finish;if(typeof e.pseudoInstructions[h.name]=="undefined"){e.pseudoInstructions[h.name]=0;e.firmware[h.name]=[]}e.pseudoInstructions[h.name]++;e.firmware[h.name].push({name:h.name,fields:(typeof h.fields!="undefined"?h.fields:false),signature:h.signature,signatureUser:h.signature.replace(/,/g," "),finish:p.signature,isPseudoinstruction:true})}var k={};k.seg={".kdata":{name:".kdata",begin:0,end:255,color:"#FF99CC",kindof:"data"},".ktext":{name:".ktext",begin:256,end:4095,color:"#A9D0F5",kindof:"text"},".data":{name:".data",begin:4096,end:32767,color:"#FACC2E",kindof:"data"},".text":{name:".text",begin:32768,end:65280,color:"#BEF781",kindof:"text"},".stack":{name:".stack",begin:65535,end:65535,color:"#F1F2A3",kindof:"stack"}};k.mp={};k.labels={};k.labels2={};k.assembly={};data_found=false;text_found=false;nextToken(e);while(!is_end_of_file(e)){var g=getToken(e);if(typeof k.seg[g]=="undefined"){return langError(e,"Expected .data/.text/... segment but found '"+g+"' as segment")}if("data"==k.seg[g].kindof){read_data(e,u,k);data_found=true}if("text"==k.seg[g].kindof){read_text(e,u,k);text_found=true}if(e.error!=null){k.error=e.error;return k}}for(i in k.labels){var q=k.labels2[k.labels[i].name];if(typeof q==="undefined"){setLabelContext(e,k.labels[i].labelContext);return langError(e,"Label '"+k.labels[i].name+"' used but not defined in the assembly code")}var o="";var d=k.labels[i].addr;for(j=0;j<k.labels[i].nwords;j++){o=k.mp["0x"+d.toString(16)]+o;d+=WORD_BYTES}var v=k.labels[i].startbit-k.labels[i].stopbit+1;var s;if((s=isHex(q))!==false){var n=decimal2binary(s,v);num_bits=n[0];free_space=n[1];var m="'"+k.labels[i].name+"' needs "+num_bits.length+" bits in binary but there is space for only "+v+" bits";if("rel"==k.labels[i].rel){var n=decimal2binary(s-k.labels[i].addr-WORD_BYTES,v);num_bits=n[0];free_space=n[1];m="Relative value ("+(s-k.labels[i].addr-WORD_BYTES)+" in decimal) needs "+num_bits.length+" bits in binary but there is space for only "+v+" bits"}}else{return langError(e,"Unexpected error (2)")}if(free_space<0){setLabelContext(e,k.labels[i].labelContext);return langError(e,m)}o=assembly_replacement(o,num_bits,k.labels[i].startbit-(-1),k.labels[i].stopbit,free_space);d=k.labels[i].addr;for(j=k.labels[i].nwords-1;j>=0;j--){k.mp["0x"+d.toString(16)]=o.substring(j*WORD_LENGTH,(j+1)*WORD_LENGTH);d+=WORD_BYTES}}if(text_found){if((typeof k.labels2.main=="undefined")&&(typeof k.labels2.kmain=="undefined")){return langError(e,"Tags 'main' or 'kmain' are not defined in the text segment(s). It is compulsory to define at least one of those tags in order to execute a program")}}return k}var WSCFG={};WSCFG.version={value:"1.9.5",type:"string"};function get_cfg(a){return WSCFG[a].value}function set_cfg(d,a){WSCFG[d].value=a}function is_mobile(){if(typeof navigator=="undefined"){return false}return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function reset_cfg(){WSCFG.color_data_active={value:"#0066FF",type:"string"};WSCFG.color_data_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.color_name_active={value:"red",type:"string"};WSCFG.color_name_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.size_active={value:1.25,type:"float"};WSCFG.size_inactive={value:0.02,type:"float"};WSCFG.is_byvalue={value:false,type:"boolean"};WSCFG.RF_display_format={value:16,type:"int"};WSCFG.RF_display_name={value:"numerical",type:"string"};WSCFG.is_editable={value:true,type:"boolean"};WSCFG.DBG_delay={value:5,type:"int"};WSCFG.DBG_level={value:"instruction",type:"string"};WSCFG.DBG_limitins={value:10000,type:"int"};WSCFG.DBG_limitick={value:1000,type:"int"};WSCFG.ICON_theme={value:"classic",type:"string"};WSCFG.NOTIF_delay={value:1000,type:"int"};WSCFG.CPUCU_size={value:6,type:"int"};WSCFG.C1C2_size={value:8,type:"int"};WSCFG.is_interactive={value:true,type:"boolean"};WSCFG.ws_idiom={value:"en",type:"string"};WSCFG.ws_mode={value:"newbie",type:"string"};WSCFG.use_voice={value:false,type:"boolean"};WSCFG.editor_theme={value:"default",type:"string"};WSCFG.editor_mode={value:"default",type:"string"};if(is_mobile()){WSCFG.NOTIF_delay.value=2000;WSCFG.ICON_theme.value="cat1";WSCFG.CPUCU_size.value=6;WSCFG.C1C2_size.value=12}set_secondary_cfg()}function set_secondary_cfg(){cfg_show_eltos_delay=130;if(get_cfg("DBG_delay")<5){cfg_show_eltos_delay=390}cfg_show_rf_delay=125;if(get_cfg("DBG_delay")<5){cfg_show_rf_delay=375}cfg_show_main_memory_delay=150;if(get_cfg("DBG_delay")<5){cfg_show_main_memory_delay=450}cfg_show_control_memory_delay=120;if(get_cfg("DBG_delay")<5){cfg_show_control_memory_delay=360}cfg_show_asmdbg_pc_delay=50;if(get_cfg("DBG_delay")<3){cfg_show_asmdbg_pc_delay=200}cfg_show_dbg_ir_delay=100;if(get_cfg("DBG_delay")<5){cfg_show_dbg_ir_delay=300}cfg_show_rf_refresh_delay=30;if(get_cfg("DBG_delay")<5){cfg_show_rf_refresh_delay=120}}function save_cfg(){try{for(var d in WSCFG){localStorage.setItem("wepsim_"+d,get_cfg(d))}}catch(a){console.log("WepSIM can not save the configuration in a persistent way on this web browser, found error: \n"+a.message)}set_secondary_cfg()}function restore_cfg(){reset_cfg();for(var d in WSCFG){if(d=="version"){continue}try{set_cfg(d,localStorage.getItem("wepsim_"+d));if(WSCFG[d].type!="string"){set_cfg(d,JSON.parse(get_cfg(d)))}if(get_cfg(d)==null){throw"null values discarted"}}catch(a){console.log("WepSIM can not restore the configuration on this web browser, found error: \n"+a.message);reset_cfg();return}}set_secondary_cfg()}function update_cfg(d,a){WSCFG[d].value=a;ga("send","event","config","config."+WSCFG.version.value,"config."+WSCFG.version.value+"."+d+"."+a);save_cfg()}function get_simware(){var a=simhw_internalState("FIRMWARE");if(typeof a.firmware=="undefined"){a.firmware=new Array()}if(typeof a.mp=="undefined"){a.mp=new Object()}if(typeof a.seg=="undefined"){a.seg=new Object()}if(typeof a.assembly=="undefined"){a.assembly=new Object()}if(typeof a.labels=="undefined"){a.labels=new Object()}if(typeof a.labels2=="undefined"){a.labels2=new Object()}if(typeof a.labels_firm=="undefined"){a.labels_firm=new Object()}if(typeof a.registers=="undefined"){a.registers=new Object()}if(typeof a.pseudoInstructions=="undefined"){a.pseudoInstructions=new Object()}if(typeof a.stackRegister=="undefined"){a.stackRegister=new Object()}if(typeof a.cihash=="undefined"){a.cihash=new Object()}if(typeof a.cocop_hash=="undefined"){a.cocop_hash=new Object()}return a}function set_simware(d){var a=simhw_internalState("FIRMWARE");if(typeof d.firmware!="undefined"){a.firmware=d.firmware}if(typeof d.mp!="undefined"){a.mp=d.mp}if(typeof d.registers!="undefined"){a.registers=d.registers}if(typeof d.assembly!="undefined"){a.assembly=d.assembly}if(typeof d.pseudoInstructions!="undefined"){a.pseudoInstructions=d.pseudoInstructions}if(typeof d.seg!="undefined"){a.seg=d.seg}if(typeof d.labels!="undefined"){a.labels=d.labels}if(typeof d.labels2!="undefined"){a.labels2=d.labels2}if(typeof d.labels_firm!="undefined"){a.labels_firm=d.labels_firm}if(typeof d.stackRegister!="undefined"){a.stackRegister=d.stackRegister}if(typeof d.cihash!="undefined"){a.cihash=d.cihash}if(typeof d.cocop_hash!="undefined"){a.cocop_hash=d.cocop_hash}}function array_includes(a,e){if(typeof a.includes!="undefined"){return a.includes(e)}for(var d=0;d<a.length;d++){if(a[d]==e){return true}}return false}function check_buses(k){var g=simhw_internalState("tri_state_names");if(simhw_internalState_get("fire_visible","databus")==true){var m=document.getElementById("svg_p");if(m!=null){m=m.contentDocument}if(m!=null){m=m.getElementById("databus_fire")}if(m!=null){m.setAttributeNS(null,"visibility","hidden")}if(m!=null){m.style.visibility="hidden"}simhw_internalState_set("fire_visible","databus",false)}if((simhw_sim_signal("TD").value!=0)&&(simhw_sim_signal("R").value!=0)){var m=document.getElementById("svg_p");if(m!=null){m=m.contentDocument}if(m!=null){m=m.getElementById("databus_fire")}if(m!=null){m.setAttributeNS(null,"visibility","visible")}if(m!=null){m.style.visibility="visible"}simhw_internalState_set("fire_visible","databus",true);simhw_sim_state("BUS_DB").value=4294967295}if(g.indexOf(k)==-1){return}var a="";var f=0;var h="";var e=0;for(var d=0;d<g.length;d++){h=g[d];e=parseInt(get_value(simhw_sim_signal(h)));f+=e;if(e>0){a=h}if(f>1){break}}if(f>0){update_draw(simhw_sim_signal(a),1)}if(simhw_internalState_get("fire_visible","internalbus")==true){var m=document.getElementById("svg_p");if(m!=null){m=m.contentDocument}if(m!=null){m=m.getElementById("internalbus_fire")}if(m!=null){m.setAttributeNS(null,"visibility","hidden")}if(m!=null){m.style.visibility="hidden"}simhw_internalState_set("fire_visible","internalbus",false)}if(f>1){var m=document.getElementById("svg_p");if(m!=null){m=m.contentDocument}if(m!=null){m=m.getElementById("internalbus_fire")}if(m!=null){m.setAttributeNS(null,"visibility","visible")}if(m!=null){m.style.visibility="visible"}simhw_internalState_set("fire_visible","internalbus",true);simhw_sim_state("BUS_IB").value=4294967295}}function fn_updateE_now(a){if("E"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateE_future(a){if(jit_fire_ndep[a]<1){fn_updateE_now(a)}else{return new Promise(function(e,d){fn_updateE_now(a)})}}function fn_updateL_now(a){update_draw(simhw_sim_signal(a),simhw_sim_signal(a).value);if("L"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateL_future(a){if(jit_fire_ndep[a]<1){fn_updateL_now(a)}else{return new Promise(function(e,d){fn_updateL_now(a)})}}function update_state(d){var a=0;switch(simhw_sim_signal(d).behavior.length){case 0:return;break;case 1:a=0;break;default:a=simhw_sim_signal(d).value;if(simhw_sim_signal(d).behavior.length<a){alert("ALERT: there are more signals values than behaviors defined!!!!\nkey: "+d+" and signal value: "+a);return}break}compute_signal_behavior(d,a)}function show_memories_values(){var a=new Promise(function(f,e){show_main_memory(simhw_internalState("MP"),get_value(simhw_sim_state("REG_PC")),true,true);f(1)});var d=new Promise(function(f,e){show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),get_value(simhw_sim_state("REG_MICROADDR")),true);f(1)});Promise.all([a,d])}function update_signal_firmware(e){var a=get_simware();var h=-1;for(var d=0;d<a.firmware.length;d++){if(parseInt(a.firmware[d]["mc-start"])>get_value(simhw_sim_state("REG_MICROADDR"))){break}h=d}if(-1==h){alert("A new 'unknown' instruction is inserted,\nplease edit it (co, nwords, etc.) in the firmware textarea.");var f=new Object();f.name="unknown";f.signature="unknown";f.signatureGlobal="unknown";f.co=0;f.nwords=0;f["mc-start"]=0;f.fields=new Array();f.microcode=new Array();f.microcomments=new Array();a.firmware.push(f);h=a.firmware.length-1}var k=get_value(simhw_sim_state("REG_MICROADDR"))-parseInt(a.firmware[h]["mc-start"]);if(typeof a.firmware[h]["microcode"][k]=="undefined"){a.firmware[h]["microcode"][k]=new Object();a.firmware[h]["microcomments"][k]=""}a.firmware[h]["microcode"][k][e]=simhw_sim_signal(e).value;if(simhw_sim_signal(e).default_value==simhw_sim_signal(e).value){delete a.firmware[h]["microcode"][k][e]}var g=get_value(simhw_sim_state("REG_IR")).toString(2);g="00000000000000000000000000000000".substring(0,32-g.length)+g;show_memories_values()}function update_signal(d){if(false===get_cfg("is_interactive")){return}for(var v in simhw_sim_signals()){for(var m=0;m<simhw_sim_signal(v).fire_name.length;m++){var a=simhw_sim_signal(v).fire_name[m].split(":");if(a[1]==d.currentTarget.id){var t=(simhw_sim_signal(v).value>>>0);var u="";var o="";var s="";var e="";var w="";var f=0;var q=Math.pow(2,simhw_sim_signal(v).nbits);if(simhw_sim_signal(v).behavior.length==q){s='<ol start="0" class="list-group list-group-flush">';for(var h=0;h<simhw_sim_signal(v).behavior.length;h++){o=" ";if(h==t){o=' checked="checked" '}u=" ";if(h==simhw_sim_signal(v).default_value){u='<span class="badge badge-info">default value</span>'}e=simhw_sim_signal(v).behavior[h];w=compute_signal_verbals(v,h);if(""==w.trim()){w="&lt;without main effect&gt;"}f=h.toString(10);s+='<li class="list-group-item p-1"><label class="m-1">  <input aria-label="value '+f+'" type="radio" name="ask_svalue"          value="'+f+'" '+o+' />  <span class="badge badge-secondary badge-pill">'+f+"</span>&nbsp;  <span>"+w+"</span>&nbsp;"+u+'  <p class="m-0 ml-3 bg-light collapse bh-all"><small>'+e+"</small></p></label></li>"}s+="</ol>"}else{s+='<ol start="0"><span><center><label><input aria-label="value for '+v+'" type="number" size=4 min=0 max='+(q-1)+' class=dial        name="ask_svalue" value="'+simhw_sim_signal(v).value+'"/>&nbsp;&nbsp; 0 - '+(q-1)+"</center></label></span>\n</ol>"}var g=simhw_short_name();if(""==g){g="ep"}var p=bootbox.dialog({title:"<center>"+v+':  <div class="btn-group">   <button onclick="$(\'#bot_signal\').carousel(0);"            type="button" class="btn btn-info">Value</button>   <button onclick="$(\'#bot_signal\').carousel(1); update_signal_loadhelp(\'#help2\',$(\'#ask_shard\').val(),$(\'#ask_skey\').val());"            type="button" class="btn btn-success">Help</button>   <button type="button" class="btn btn-success dropdown-toggle dropdown-toggle-split"            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">     <span class="caret"></span>     <span class="sr-only">Toggle Help Idiom</span>   </button>   <div class="dropdown-menu">        <a href="#" class="dropdown-item"                     onclick="set_cfg(\'ws_idiom\',\'es\'); save_cfg(); i18n_update_tags(\'gui\', \'es\');                              $(\'#bot_signal\').carousel(1);                              update_signal_loadhelp(\'#help2\',$(\'#ask_shard\').val(),$(\'#ask_skey\').val());"         >ES<span class="d-none d-sm-inline-flex">&nbsp;(Spanish)</span></a>        <a href="#" class="dropdown-item"                     onclick="set_cfg(\'ws_idiom\',\'en\'); save_cfg(); i18n_update_tags(\'gui\', \'en\');                              $(\'#bot_signal\').carousel(1);                              update_signal_loadhelp(\'#help2\',$(\'#ask_shard\').val(),$(\'#ask_skey\').val());"         >EN<span class="d-none d-sm-inline-flex">&nbsp;(English)</span></a>   </div> </div></center>',message:'<div id="bot_signal" class="carousel" data-ride="carousel" data-interval="false">  <div class="carousel-inner" role="listbox">    <div class="carousel-item active">         <div style="max-height:70vh; width:inherit; overflow:auto; -webkit-overflow-scrolling:touch;">         <form class="form-horizontal" style="white-space:wrap;">         <input aria-label="value for '+v+'" id="ask_skey"  name="ask_skey"  type="hidden" value="'+v+'" class="form-control input-md">          <input aria-label="value for '+g+'" id="ask_shard" name="ask_shard" type="hidden" value="'+g+'" class="form-control input-md"> '+s+'         </form>         </div>    </div>    <div class="carousel-item">         <div id=help2 style="max-height:65vh; width:inherit; overflow:auto; -webkit-overflow-scrolling:touch;">Loading...</div>    </div>  </div></div>',value:simhw_sim_signal(v).value,animate:false,size:"large",buttons:{description:{label:'&plusmn; Desc<span class="d-none d-sm-inline-flex">ription</span>',className:"btn-outline-dark btn-sm col-xs-3 col-sm-3 col-lg-2",callback:function(){$(".bh-all").collapse("toggle");return false}},success:{label:"Save",className:"btn-primary btn-sm col-xs-3 col-sm-2 float-right",callback:function(){v=$("#ask_skey").val();user_input=$("input[name='ask_svalue']:checked").val();if(typeof user_input=="undefined"){user_input=$("input[name='ask_svalue']").val()}simhw_sim_signal(v).value=user_input;if(true===get_cfg("is_interactive")){if(simhw_sim_signal(v).value!=simhw_sim_signal(v).default_value){simhw_sim_state("REG_MICROINS").value[v]=simhw_sim_signal(v).value}else{delete (simhw_sim_state("REG_MICROINS").value[v])}var n=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof simhw_internalState_get("MC",n)=="undefined"){simhw_internalState_set("MC",n,new Object());simhw_internalState_set("MC_dashboard",n,new Object())}simhw_internalState_get("MC",n)[v]=simhw_sim_signal(v).value;simhw_internalState_get("MC_dashboard",n)[v]={comment:"",breakpoint:false,state:false,notify:new Array()};update_signal_firmware(v);var k=get_simware();document.getElementById("inputFirmware").value=saveFirmware(k)}compute_behavior("FIRE "+v)}},close:{label:"Close",className:"btn-danger btn-sm col-xs-3 col-sm-2 float-right",callback:function(){}}}});p.find(".modal-title").addClass("mx-auto");p.find(".bootbox-close-button").addClass("mx-1");$(".dial").knob({min:0,max:(q-1)}).val(simhw_sim_signal(v).value).trigger("change")}}}show_states();show_rf_values()}function update_memories(v){set_simware(v);var g=get_simware();simhw_internalState_reset("MC",{});simhw_internalState_reset("MC_dashboard",{});for(var t=0;t<g.firmware.length;t++){var u=false;var n=false;var p=new Array();var m=g.firmware[t]["microcode"].length;var s=g.firmware[t]["mc-start"];for(var q=0;q<m;q++){var d=g.firmware[t]["microcomments"][q];u=(d.trim().split("state:").length>1);n=(d.trim().split("break:").length>1);p=d.trim().split("notify:");for(var o=0;o<p.length;o++){p[o]=p[o].split("\n")[0]}simhw_internalState_set("MC",s,g.firmware[t]["microcode"][q]);simhw_internalState_set("MC_dashboard",s,{comment:d,state:u,breakpoint:n,notify:p});s++}}simhw_internalState_reset("ROM",{});for(var t=0;t<g.firmware.length;t++){if("begin"==g.firmware[t]["name"]){continue}var a=g.firmware[t]["mc-start"];var h=parseInt(g.firmware[t]["co"],2);var f=0;if(typeof g.firmware[t]["cop"]!="undefined"){f=parseInt(g.firmware[t]["cop"],2)}var e=64*h+f;simhw_internalState_set("ROM",e,a);g.cihash[e]=g.firmware[t]["signature"]}simhw_internalState_reset("MP",{});for(var y in g.mp){var w=parseInt(y);var x=parseInt(g.mp[y].replace(/ /g,""),2);simhw_internalState_set("MP",w,x)}simhw_internalState_reset("segments",{});for(var y in g.seg){simhw_internalState_set("segments",y,g.seg[y])}show_main_memory(simhw_internalState("MP"),0,true,true);show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),0,true)}function obj_draw(a,h,m,f,g,e){var d=a.split(":");var k=document.getElementById(d[0]);if(k==null){return}k=k.contentDocument;if(k==null){return}k=k.getElementById(d[1]);if(k==null){return}if(h){k.style.setProperty("stroke",m,"");k.style.setProperty("fill",m,"");k.style.setProperty("stroke-width",g,"")}else{if(k.style.getPropertyValue("stroke")==f){return}k.style.setProperty("stroke",f,"");k.style.setProperty("fill",f,"");k.style.setProperty("stroke-width",e,"")}}var DRAW_stop=false;function start_drawing(){DRAW_stop=false}function stop_drawing(){DRAW_stop=true}function is_drawing(){return DRAW_stop}function update_draw(h,g){if(true==DRAW_stop){return}var m=get_cfg("is_byvalue");if(typeof simhw_sim_state("REG_MICROINS").value[h.name]!="undefined"){m=true}if((false==m)&&(typeof h.depends_on!="undefined")){for(var d=0;d<h.depends_on.length;d++){var a=h.depends_on[d];if(typeof simhw_sim_state("REG_MICROINS").value[a]!="undefined"){m=true;break}else{if("CLK"==a){m=true;break}}}}if(h.draw_data.length>1){for(var f=0;f<h.draw_data.length;f++){for(var e=0;e<h.draw_data[f].length;e++){obj_draw(h.draw_data[f][e],(f==g)&&m,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}else{if(h.nbits==1){for(var e=0;e<h.draw_data[0].length;e++){obj_draw(h.draw_data[0][e],(0!=g)&&m,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}else{if(h.draw_data.length==1){for(var e=0;e<h.draw_data[0].length;e++){obj_draw(h.draw_data[0][e],m,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}}if(h.draw_name.length>1){for(var f=0;f<h.draw_name.length;f++){for(var e=0;e<h.draw_name[f].length;e++){obj_draw(h.draw_name[f][e],(f==g)&&m,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}else{if(h.nbits==1){for(var e=0;e<h.draw_name[0].length;e++){obj_draw(h.draw_name[0][e],(0!=g)&&m,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}else{if(h.draw_name.length==1){for(var e=0;e<h.draw_name[0].length;e++){obj_draw(h.draw_name[0][e],m,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}}}function refresh(){for(var a in simhw_sim_signals()){update_draw(simhw_sim_signals()[a],simhw_sim_signals()[a].value);check_buses(a)}show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")))}function hex2float(e){var a=(e&2147483648)?-1:1;var g=((e>>23)&255)-127;var d=1+((e&8388607)/8388608);var f=a*d*Math.pow(2,g);if(-127==g){if(1==d){f=(a==1)?"+0":"-0"}else{f=a*((e&8388607)/8388607)*Math.pow(2,-126)}}if(128==g){if(1==d){f=(a==1)?"+Inf":"-Inf"}else{f="NaN"}}return f}function hex2char8(a){var d=new Array();d[0]=String.fromCharCode((a&4278190080)>>24);d[1]=String.fromCharCode((a&16711680)>>16);d[2]=String.fromCharCode((a&65280)>>8);d[3]=String.fromCharCode((a&255)>>0);return d}function pack5(a){return"00000".substring(0,5-a.length)+a}function pack8(a){return"00000000".substring(0,8-a.length)+a}function pack32(a){return"00000000000000000000000000000000".substring(0,32-a.length)+a}function hex2bin(a){var d=a.toString(2);d=pack32(d);d=d.substring(0,4)+" "+d.substring(4,8)+" "+d.substring(8,12)+" "+d.substring(12,16)+"<br>"+d.substring(16,20)+" "+d.substring(20,24)+" "+d.substring(24,28)+" "+d.substring(28,32);return d}function hex2values_update(a){var e=parseInt($("#popover1")[0].value);var d=simhw_internalState("filter_states");if(typeof simhw_sim_states()["BR"][a]!="undefined"){set_value(simhw_sim_states()["BR"][a],e);fullshow_rf_values();$("#rf"+a).click();$("#rf"+a).click()}if(typeof simhw_sim_states()[a]!="undefined"){if(1==simhw_sim_states()[a].nbits){e=e%2}set_value(simhw_sim_states()[a],e);fullshow_eltos(simhw_sim_states(),d);$("#rp"+a).click();$("#rp"+a).click()}}function hex2values(p,n){var m=/[0-9A-F]{1,8}/gi;if(!m.test(p)){p=0}var g=p>>0;var o=p>>>0;var a=hex2char8(o);var k=hex2float(o);var e=hex2bin(o);var h=o.toString(16).toUpperCase();h="0x"+pack8(h);var d="";if(get_cfg("is_editable")==true){d="<tr><td class='py-1 px-1' colspan='5' align='center'><input type='text' id='popover1' value='"+o+"' data-mini='true' style='width:65%'>&nbsp;<span class='badge badge-secondary'       onclick='hex2values_update(\""+n+"\");'>update</span></td></tr>"}var f="<table class='table table-bordered table-hover table-sm mb-1'><tbody><tr><td class='p-0 pb-1 pl-1'><strong>hex.</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>"+h+"</strong></td></tr><tr><td class='p-0 pb-1 pl-1'><strong>binary</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>"+e+"</strong></td></tr><tr><td class='p-0 pb-1 pl-1'><strong>signed</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>"+g+"</strong></td></tr><tr><td class='p-0 pb-1 pl-1'><strong>unsig.</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>"+o+"</strong></td></tr><tr><td class='p-0 pb-1 pl-1'><strong>char</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>&nbsp;"+a[0]+"&nbsp;</strong>&nbsp;<strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>&nbsp;"+a[1]+"&nbsp;</strong>&nbsp;<strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>&nbsp;"+a[2]+"&nbsp;</strong>&nbsp;<strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>&nbsp;"+a[3]+"&nbsp;</strong>&nbsp;</td></tr><tr><td class='p-0 pb-1 pl-1'><strong>float</strong></td>    <td class='p-0 pb-1 pl-1'><strong class='rounded' style='background-color:#CEECF5; color:black; font-family:monospace;'>"+k+"</strong></td></tr>"+d+"</tbody></table>";return f}function init_rf(f){if(f==""){return}var a="";var e="";for(var d=0;d<simhw_sim_states()["BR"].length;d++){e="R"+d;if(d<10){e=e+"&nbsp;"}a+="<div class='col pb-1 px-1'><button type='button' class='btn p-0 ml-0'         style='width:inherit; border-color:#cecece; background-color:#f5f5f5' data-role='none'         data-toggle='popover-up' data-popover-content='"+d+"' data-container='body'         id='rf"+d+"'><span id='name_RF"+d+"' class='p-0 text-monospace' style='float:center; color:black;'>"+e+"</span>&nbsp;<span class='badge badge-secondary' style='background-color:#CEECF5; color:black;' id='tbl_RF"+d+"'>"+(get_value(simhw_sim_states()["BR"][d])>>>0).toString(get_cfg("RF_display_format")).toUpperCase()+"</span></button></div>"}$(f).html("<div class='d-flex flex-row flex-wrap justify-content-around'>"+a+"</div>");$("[data-toggle=popover-up]").popover({html:true,placement:"auto",animation:false,trigger:"click",template:'<div class="popover shadow" role="tooltip"><div class="arrow"></div><h3  class="popover-header"></h3><div class="popover-body"></div></div>',container:"body",content:function(){var h=$(this).attr("data-popover-content");var g=get_value(simhw_sim_states()["BR"][h]);return hex2values(g,h)},title:function(){var g=$(this).attr("data-popover-content");var h="&quot;#rf"+g+"&quot;";return'<span class="text-dark"><strong>R'+g+'</strong></span><button type="button" id="close" class="close"         onclick="$('+h+').click();">&times;</button>'}})}function fullshow_rf_values(){if(typeof document=="undefined"){return}var d=get_simware();for(var e=0;e<simhw_sim_states()["BR"].length;e++){var a=(get_value(simhw_sim_states()["BR"][e])>>>0).toString(get_cfg("RF_display_format")).toUpperCase();if(16==get_cfg("RF_display_format")){a=pack8(a)}$("#tbl_RF"+e).html(a)}}var show_rf_values_deferred=null;function innershow_rf_values(){fullshow_rf_values();show_rf_values_deferred=null}function show_rf_values(){if(null!=show_rf_values_deferred){return}show_rf_values_deferred=setTimeout(innershow_rf_values,cfg_show_rf_delay)}function show_rf_names(){if(typeof document=="undefined"){return}var d=get_simware();var a="";for(var e=0;e<simhw_sim_states()["BR"].length;e++){a="R"+e;if(e<10){a=a+"&nbsp;"}if("logical"==get_cfg("RF_display_name")){if(typeof d.registers[e]!="undefined"){a=d.registers[e]}}var f=document.getElementById("name_RF"+e);if(f!=null){f.innerHTML=a}}}function init_eltos(h,n,a){if(h==""){return}var f="";var e="";var d="";for(var k=0;k<a.length;k++){var o=a[k].split(",")[0];var g=n[o].name;if(n[o].nbits>1){e=g.substring(0,3);d=g.substring(3,g.length);if(g.length<3){g='<span class="text-monospace">'+e+"&nbsp;</span>"}else{g='<span class="text-monospace">'+e+"</span>"}if(d.length>0){g+='<span class="d-none d-sm-inline-flex text-monospace">'+d+"</span>"}}var m=a[k].split(",")[1];f+="<div class='"+m+" pb-1 px-1'><button type='button' class='btn p-0 ml-0'         style='width:inherit; border-color:#cecece; background-color:#f5f5f5' data-role='none'         data-toggle='popover-bottom' data-popover-content='"+o+"' data-container='body'         id='rp"+o+"'>"+g+" <span class='badge badge-secondary' style='background-color:#CEECF5; color:black;' id='tbl_"+o+"'>"+n[o].value.toString(get_cfg("RF_display_format"))+"</span></button></div>"}$(h).html("<div class='d-flex flex-row flex-wrap justify-content-around'>"+f+"</div>");$("[data-toggle=popover-bottom]").popover({html:true,placement:"bottom",animation:false,content:function(){var q=$(this).attr("data-popover-content");var p=get_value(simhw_sim_states()[q]);return hex2values(p,q)},title:function(){var p=$(this).attr("data-popover-content");var q="&quot;#rp"+p+"&quot;";return'<span class="text-dark"><strong>'+simhw_sim_states()[p].name+'</strong></span><button type="button" id="close" class="close"         onclick="$('+q+').click();">&times;</button>'}})}function fullshow_eltos(k,e){if(typeof document=="undefined"){return}for(var d=0;d<e.length;d++){var f=e[d].split(",");var a=f[0];var g=k[a].value.toString(get_cfg("RF_display_format"));if(k[a].nbits>1){g=(simhw_sim_state(a).value>>>0).toString(get_cfg("RF_display_format")).toUpperCase();if(16==get_cfg("RF_display_format")){g=pack8(g)}}var h=document.getElementById("tbl_"+a);if(h!=null){h.innerHTML=g}}}var show_eltos_deferred=null;function show_eltos(d,a){if(null!=show_eltos_deferred){return}show_eltos_deferred=setTimeout(function(){fullshow_eltos(d,a);show_eltos_deferred=null},cfg_show_eltos_delay)}function init_states(d){var a=simhw_internalState("filter_states");return init_eltos(d,simhw_sim_states(),a)}function show_states(){var a=simhw_internalState("filter_states");return show_eltos(simhw_sim_states(),a)}function ko_observable(a){if(typeof ko!="undefined"){return ko.observable(a).extend({rateLimit:cfg_show_rf_refresh_delay})}else{return a}}function ko_rebind_state(e,f){if(typeof ko=="undefined"){return}var d=simhw_sim_state(e);if(typeof d.value!="function"){d.value=ko.observable(d.value).extend({rateLimit:cfg_show_rf_refresh_delay})}var a=document.getElementById(f);ko.cleanNode(a);ko.applyBindings(simhw_sim_state(e),a)}function init_io(g){var f=simhw_internalState("io_int_factory");if(typeof f=="undefined"){return}if(g==""){for(var d=0;d<f.length;d++){f[d].accumulated=ko_observable(f[d].accumulated);f[d].active=ko_observable(f[d].active)}return}var e="<div class='col-12'><table class='table table-hover table-sm table-bordered'>";for(var d=0;d<f.length;d++){e+="<tr id='int"+d+"_context'><td align=center width=50%><span data-bind=\"style: {fontWeight: active() ? 'bold' : ''}\">Interrupt "+d+"</span></td><td align=center width=50%><span data-bind='text: accumulated'>&nbsp;</span></td></tr>"}e+="</table></div>";$(g).html("<div class='row'>"+e+"</div>");for(var d=0;d<f.length;d++){if(typeof f[d].accumulated!="function"){f[d].accumulated=ko_observable(f[d].accumulated)}if(typeof f[d].active!="function"){f[d].active=ko_observable(f[d].active)}var a=document.getElementById("int"+d+"_context");ko.cleanNode(a);ko.applyBindings(f[d],a)}}function init_cpu(d){if(d==""){simhw_sim_state("CLK").value=ko_observable(simhw_sim_state("CLK").value);simhw_sim_state("DECO_INS").value=ko_observable(simhw_sim_state("DECO_INS").value);return}var a="<div class='col-12'><table class='table table-hover table-sm table-bordered'><tr><td align=center width=50%>Instructions</td><td align=center width=50%><div id='ins_context'><span data-bind='text: value'>&nbsp;</span></div></td></tr><tr><td align=center width=50%>CLK ticks</td><td align=center width=50%><div id='clk_context'><span data-bind='text: value'>&nbsp;</span></div></td></tr></table></div>";$(d).html("<div class='row'>"+a+"</div>");ko_rebind_state("CLK","clk_context");ko_rebind_state("DECO_INS","ins_context")}function init_config_mp(e){if(e==""){simhw_internalState_reset("MP_wc",ko_observable(0));return}var d="<div class='container-fluid'><div class='row'>";d+="<div class='col-12' style='padding:0 0 10 0;'><div class='card bg-light'><div class='card-body p-0' id='mempanel'><table class='table table-hover table-sm table-bordered'        style='margin:0'><tbody class='no-ui-mini'><tr><td align=center'>Wait cycles (<b>0</b> - &infin;)</td>    <td align=center'><div id='mp_wc'><input type=number data-bind='value: simhw_internalState(\"MP_wc\")' min='0' max='99999999'></div>    </td></tr></tbody></table></div></div></div>";$(e).html(d);simhw_internalState_reset("MP_wc",ko_observable(0));var a=document.getElementById("mp_wc");ko.applyBindings(simhw_internalState("MP_wc"),a)}function init_config_io(g){var f=simhw_internalState("io_int_factory");if(typeof f=="undefined"){return}if(g==""){for(var d=0;d<f.length;d++){f[d].period=ko_observable(f[d].period);f[d].probability=ko_observable(f[d].probability)}return}var e="<div class='container-fluid'><div class='row'>";e+="<div class='col-12 p-0'><div class='card bg-light' style='margin:0 0 0 0;'><div class='card-body' id='iopanel' style='padding: 0 0 0 0'>";e+="<center><table class='table table-hover table-sm table-bordered'        style='margin:0'><tbody class='no-ui-mini'><tr><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>Interrupt identificator</span>  <span class='d-sm-none'>Int. Id.<br>(0 - 7)</span></td><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>CLK period (<b>0</b> - &infin;)</span>  <span class='d-sm-none'>CLK ticks <br>(<b>0</b> - &infin;)</span></td><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>Probability (0 - 1)</span>  <span class='d-sm-none'>Probability <br>(0 - 1)</span></td></tr>";for(var d=0;d<8;d++){e+="<tr><td align='center' style='padding:0 0 0 0; vertical-align: middle !important'><span class='p-0 m-0'>"+d+"</span></td><td align='center' class='p-0'><div id='int"+d+"_per' style='margin:0 3 0 3'><input type=number data-bind='value: period' min='0' max='99999999'></div></td><td align='center' class='p-0'><div id='int"+d+"_pro' style='margin:0 3 0 3'><input type='number' data-bind='value: probability' min='0' max='1' step='.05'></div></td></tr>"}e+="</tbody></table></center>";e+="</div></div></div>";$(g).html(e);for(var d=0;d<f.length;d++){if(typeof f[d].period!="function"){f[d].period=ko_observable(f[d].period)}var a=document.getElementById("int"+d+"_per");ko.cleanNode(a);ko.applyBindings(f[d],a);if(typeof f[d].probability!="function"){f[d].probability=ko_observable(f[d].probability)}var a=document.getElementById("int"+d+"_pro");ko.cleanNode(a);ko.applyBindings(f[d],a)}}function get_deco_from_pc(a){var e="0x"+a.toString(16);var d=simhw_internalState("FIRMWARE");if((typeof d.assembly=="undefined")||(typeof d.assembly[e]=="undefined")||(typeof d.assembly[e].source=="undefined")){return""}return d.assembly[e].source}function show_visgraph(o,q){var n=new Object();var h=new Array();var k=0;for(var t in simhw_sim_signals()){n[t]=k;h.push({id:k,label:t,title:t});k++}for(var e=0;e<q.length;e++){h[n[q[e]]].color="#7BE141"}var m=new vis.DataSet(h);var p=new Array();for(var t in simhw_sim_signals()){for(var a in o[t]){p.push({from:n[a],to:n[t],arrows:"to"})}}var s=new vis.DataSet(p);var d=document.getElementById("depgraph1");var f={nodes:m,edges:s};var g={interaction:{hover:true},nodes:{borderWidth:2,shadow:true},edges:{width:2,shadow:true}};jit_dep_network=new vis.Network(d,f,g)}function simcoreui_voice_canSpeak(){if(typeof window.speechSynthesis=="undefined"){return false}if(false==get_cfg("use_voice")){return false}return true}function simcoreui_voice_speak(d){var a=null;if(simcoreui_voice_canSpeak()){a=new SpeechSynthesisUtterance(d);a.lang="es-ES";if("en"==get_cfg("ws_idiom")){a.lang="en-US"}if("es"==get_cfg("ws_idiom")){a.lang="es-EN"}window.speechSynthesis.speak(a)}}function simcoreui_voice_stopSpeak(){if(simcoreui_voice_canSpeak()){window.speechSynthesis.cancel()}}function get_verbal_from_current_mpc(){var a="";var e="";var f=get_value(simhw_sim_state("REG_MICROINS"));for(var d in f){a=a+d+" ";e=e+compute_signal_verbals(d,f[d])}return"Activated signals are: "+a.trim()+". Associated actions are: "+e}function get_verbal_from_current_pc(){var a=get_value(ep_states.REG_PC)-4;var d=get_deco_from_pc(a);if(""==d.trim()){d="not jet defined"}return"Current instruction is: "+d+" and PC points to "+show_value(a)+". "}function simcore_init(a,f){var e={};e.msg="";e.ok=true;var d=simhw_getActiveByName(f);if(d<0){e.msg="ERROR: unknown hardware: "+f+".\n";e.ok=false;return e}if(a){restore_cfg()}else{reset_cfg();stop_drawing()}simhw_setActive(d);var g=simcore_init_ui("","","","","","");if(false==g.ok){e.msg=e.msg;e.ok=false;return e}return e}function simcore_init_ui(h,e,f,d,o,g){var m={};m.msg="";m.ok=true;var a='<div class="bg-warning"><b>Not available in this hardware</b></div>';if(""!=h){$(h).html(a)}if(""!=e){$(e).html(a)}if(""!=f){$(f).html(a)}if(""!=d){$(d).html(a)}if(""!=o){$(o).html(a)}if(""!=g){$(g).html(a)}var n=simhw_sim_components();for(var p in n){for(var k in n[p].abilities){switch(n[p].abilities[k]){case"CPU":init_states(h);init_rf(e);init_cpu(d);break;case"MEMORY_CONFIG":init_config_mp(o);break;case"IO":init_io(f);break;case"IO_CONFIG":init_config_io(g);break;default:break}}}return m}function simcore_init_eventlistener(f){for(var e in simhw_sim_signals()){for(var d=0;d<simhw_sim_signal(e).fire_name.length;d++){var g=simhw_sim_signal(e).fire_name[d].split(":");if(g[0]!=f){continue}var h=document.getElementById(g[0]).contentDocument;if(null==h){console.log('warning: unreferenced graphic element context named "'+g[0]+'".');continue}var a=h.getElementById(g[1]);if(null==a){console.log('warning: unreferenced graphic element named "'+g[0]+":"+g[1]+'".');continue}a.addEventListener("click",update_signal,false)}}}function simcore_check_if_can_execute(){var d={};d.msg="";d.ok=true;var e=simhw_internalState("segments");if((typeof e[".ktext"]=="undefined")&&(typeof e[".text"]=="undefined")){d.msg="code segment .ktext/.text does not exist!\nPlease load some assembly code.";d.ok=false;return d}var a=get_simware();if((!((typeof e[".ktext"]!="undefined")&&(a.labels2.kmain)))&&(!((typeof e[".text"]!="undefined")&&(a.labels2.main)))){d.msg="labels 'kmain' (in .ktext) or 'main' (in .text) do not exist!";d.ok=false;return d}return d}function simcore_check_if_can_continue(){var a={};a.ok=true;a.msg="";var f=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof simhw_internalState_get("MC",f)=="undefined"){a.ok=false;a.msg="Error: undefined microinstruction at "+f+".";return a}var g=get_cfg("ws_mode");if(("wepmips"!=g)&&(f!=0)){return a}var e=simhw_internalState("segments");var d=parseInt(get_value(simhw_sim_state("REG_PC")));if((d<e[".ktext"].end)&&(d>=e[".ktext"].begin)){return a}if((d<e[".text"].end)&&(d>=e[".text"].begin)){return a}a.ok=false;a.msg="The program has finished because the PC register points outside .ktext/.text code segments";return a}function simcore_reset(){var e={};e.msg="";e.ok=true;var a=get_simware();var g=simhw_internalState("FIRMWARE");var h=simhw_internalState("segments");var f=simhw_sim_components();for(var d in f){switch(f[d].name){case"CPU":compute_general_behavior("RESET");if((typeof h[".ktext"]!="undefined")&&(a.labels2.kmain)){set_value(simhw_sim_state("REG_PC"),parseInt(a.labels2.kmain));show_asmdbg_pc()}else{if((typeof h[".text"]!="undefined")&&(a.labels2.main)){set_value(simhw_sim_state("REG_PC"),parseInt(a.labels2.main));show_asmdbg_pc()}}if((typeof h[".stack"]!="undefined")&&(typeof simhw_sim_states().BR[g.stackRegister]!="undefined")){set_value(simhw_sim_states().BR[g.stackRegister],parseInt(h[".stack"].begin))}break;case"MEMORY":compute_general_behavior("MEM_RESET");break;case"SCREEN":compute_general_behavior("SCR_RESET");break;case"KBD":compute_general_behavior("KBD_RESET");break;case"IO":compute_general_behavior("IO_RESET");break;default:break}}var k=get_cfg("ws_mode");if("wepmips"!=k){compute_general_behavior("CLOCK")}for(d in f){switch(f[d].name){case"CPU":show_states();show_rf_values();show_rf_names();show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")));show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),0,true);break;case"MEMORY":show_main_memory(simhw_internalState("MP"),0,true,false);break;case"SCREEN":set_screen_content("");break;default:break}}return e}function simcore_execute_microinstruction(){var a=simcore_check_if_can_continue();if(false==a.ok){return a}compute_general_behavior("CLOCK");show_states();show_rf_values();show_dbg_mpc();return a}function simcore_execute_microprogram(f,a){var k=simcore_check_if_can_continue();if(false==k.ok){return k}var h=get_cfg("ws_mode");if("wepmips"==h){compute_general_behavior("CLOCK");compute_general_behavior("CLOCK");show_states();show_rf_values();return k}var n=false;if(a<0){n=true}var o=null;var m=null;var g="";var p=simhw_internalState("MC");var e=0;var d=0;do{if(3==f){o=simcore_simstate_current2state()}else{if(4==f){g="0x"+d.toString(16);k.msg=k.msg+"Micropc at "+g+".\t"+get_verbal_from_current_mpc()+"\n"}}compute_general_behavior("CLOCK");if(3==f){m=simcore_simstate_current2state();g="0x"+d.toString(16);k.msg=k.msg+"micropc("+g+"):\t"+controlmemory_lineToString(p,d).trim()+":\t\t\t"+simcore_simstate_diff_states(o,m)+"\n"}e++;if(n){a=e+1}if(e>=a){k.msg="Warning: clock cycles limit reached in a single instruction.";k.ok=false;break}d=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof p[d]=="undefined"){k.msg="Error: undefined microinstruction at "+d+".";k.ok=false;break}}while((e<a)&&(0!=d));show_states();show_rf_values();if(get_cfg("DBG_level")=="microinstruction"){show_dbg_mpc()}return k}function simcore_execute_program(f,g,t){var h={};h.ok=true;h.msg="";var a=simhw_internalState("segments");var n=get_value(simhw_sim_state("REG_PC"));var v=get_value(simhw_sim_state("REG_PC"))-4;var p=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].begin!="undefined")){p=parseInt(a[".text"].begin)}var s=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].end!="undefined")){s=parseInt(a[".text"].end)}var u=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].begin!="undefined")){u=parseInt(a[".ktext"].begin)}var d=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].end!="undefined")){d=parseInt(a[".ktext"].end)}var o=null;var q=null;var m=null;var e="";var k=get_simware();var w=0;while((n!=v)&&(((n<s)&&(n>=p))||((n<d)&&(n>=u)))){if(2==f){q=simcore_simstate_current2state()}o=simcore_execute_microprogram(f,t);if(false==o.ok){return o}if(2==f){m=simcore_simstate_current2state();e="0x"+n.toString(16);h.msg=h.msg+"pc("+e+"):\t"+k.assembly[e].source_original+":\t\t\t"+simcore_simstate_diff_states(q,m)+"\n"}else{if(3==f){h.msg=h.msg+o.msg}else{if(4==f){h.msg=h.msg+o.msg}}}w++;if(w>g){h.ok=false;h.msg="more than "+g+" instructions executed before application ends.";return h}v=n;n=get_value(simhw_sim_state("REG_PC"))}return h}function simcore_compile_firmware(g){var d={};d.msg="";d.ok=true;if(""==g){d.msg="Empty Firmware";d.ok=false;return d}var a=null;try{a=loadFirmware(g);d.simware=a}catch(f){d.msg="ERROR: at line: "+f.lineNumber+" and column: "+f.columnNumber;d.ok=false;return d}if(a.error!=null){d.msg=a.error;d.ok=false;return d}update_memories(a);simcore_reset();return d}function simcore_compile_assembly(d){var e={};e.msg="";e.ok=true;var a=get_simware();if(a.firmware.length==0){e.msg="Empty microcode, please load the microcode first.";e.ok=false;return e}var f=simlang_compile(d,a);e.simware=f;if(f.error!=null){e.msg=f.error;e.ok=false;return e}set_simware(f);update_memories(a);simcore_reset();return e}function simcore_native_get_signal(a){return(get_value(simhw_sim_signal(a))>>>0)}function simcore_native_set_signal(a,d){set_value(simhw_sim_signal(a),d);compute_behavior("FIRE "+a);return d}function simcore_native_get_value(f,a){var e=0;if(("CPU"==f)||("BR"==f)){if(Number.isInteger(a)){e=a}else{e=parseInt(a)}if(isNaN(e)){return(get_value(simhw_sim_state(a))>>>0)}return(get_value(simhw_sim_states().BR[e])>>>0)}if("MEMORY"==f){return(simhw_internalState_get("MP",a)>>>0)}if("DEVICE"==f){var g=simhw_internalState_get("io_hash",a);var h=(get_value(simhw_sim_state(g))>>>0);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_signal("IOR"),1);compute_behavior("FIRE IOR");h=get_value(simhw_sim_state("BUS_DB"));return h}if("SCREEN"==f){var d=get_screen_content();return d}return false}function simcore_native_set_value(e,a,g){var d=0;if(("CPU"==e)||("BR"==e)){if(Number.isInteger(a)){d=a}else{d=parseInt(a)}if(isNaN(d)){set_value(simhw_sim_state(a),g);if("REG_PC"==a){show_asmdbg_pc()}return g}return set_value(simhw_sim_states().BR[d],g)}if("MEMORY"==e){simhw_internalState_set("MP",a,g);return g}if("DEVICE"==e){var f=simhw_internalState_get("io_hash",a);set_value(simhw_sim_state(f),g);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_state("BUS_DB"),g);set_value(simhw_sim_signal("IOW"),1);compute_behavior("FIRE IOW");return g}if("SCREEN"==e){set_screen_content(g);return g}return false}function simcore_native_get_fields(d){var a=get_simware();for(var e in a.firmware){if(a.firmware[e].signatureRaw==d){return a.firmware[e].fields}}}function simcore_native_get_field_from_ir(a,d){if(typeof a[d]=="undefined"){return false}var f=get_value(simhw_sim_state("REG_IR"));var g=(31-parseInt(a[d].startbit));var e=parseInt(a[d].stopbit);f=f<<g;f=f>>>g;f=f>>>e;return f}function simcore_native_deco(){compute_behavior("DECO")}function simcore_native_go_maddr(a){set_value(simhw_sim_state("MUXA_MICROADDR"),a)}function simcore_native_go_opcode(){var a=get_value(simhw_sim_state("ROM_MUXA"));set_value(simhw_sim_state("MUXA_MICROADDR"),a)}function simcore_native_go_instruction(d){var a=get_simware();for(var f in a.firmware){if(a.firmware[f].signatureRaw==d){var e=a.firmware[f]["mc-start"];set_value(simhw_sim_state("MUXA_MICROADDR"),e);return}}}function simcore_simstate_checklist2state(k){var d={};var h=false;k=k.replace(/;|==|!=|>=|<=|=|>|</gi,function(o){return" "+o+" "});k=k.replace(/  /g," ");var m=k.split(";");for(var f=0;f<m.length;f++){var n=m[f].trim();if(""==n){continue}var e=n.split(" ");if(e.length<4){continue}var a={type:e[0],id:e[1],condition:e[2],value:decodeURI(e[3])};for(var g in simhw_sim_components()){h=simhw_sim_component(g).read_state(d,a);if(true==h){break}}if(false==h){console.log("ERROR in checklist at component "+a.type+": "+n)}}return d}function simcore_simstate_current2state(){var d={};for(var a in simhw_sim_components()){simhw_sim_component(a).write_state(d)}return d}function simcore_simstate_state2checklist(g){var f="";for(var e in g){for(var d in g[e]){var a=g[e][d];f=f+a.type+" "+a.id+" "+a.op+" "+encodeURI(a.value)+"; "}}return f}function simcore_simstate_check_results(h,g,k){var n={};n.result=[];n.errors=0;n.neltos_expected=0;n.neltos_obtained=0;var a=null;var m={};var f=0;for(var e in simhw_sim_components()){if(typeof h[e]!="undefined"){for(a in h[e]){n.neltos_expected++;f=h[e][a].default_value;if((typeof g[e]!="undefined")&&(typeof g[e][a]!="undefined")){f=g[e][a].value}m={};m.expected=h[e][a].value;m.obtained=f;m.elto_type=e.toLowerCase();m.elto_id=h[e][a].id;m.elto_op=h[e][a].op;m.fulfill=false;if("="==h[e][a].op){m.fulfill=(parseInt(m.obtained)==parseInt(m.expected))}else{if(">"==h[e][a].op){m.fulfill=(parseInt(m.obtained)>parseInt(m.expected))}else{if("<"==h[e][a].op){m.fulfill=(parseInt(m.obtained)<parseInt(m.expected))}else{if(">="==h[e][a].op){m.fulfill=(parseInt(m.obtained)>=parseInt(m.expected))}else{if("<="==h[e][a].op){m.fulfill=(parseInt(m.obtained)<=parseInt(m.expected))}else{if("=="==h[e][a].op){m.fulfill=(m.expected==m.obtained)}else{if("!="==h[e][a].op){m.fulfill=(m.expected!=m.obtained)}}}}}}}n.result.push(m);if(m.fulfill===false){n.errors++}}}if((k)&&(typeof g[e]!="undefined")){for(a in g[e]){n.neltos_obtained++;if((typeof h[e]!="undefined")&&(typeof h[e][a]!="undefined")){continue}m={};m.expected=g[e][a].default_value;m.obtained=g[e][a].value;m.fulfill=(m.expected==m.obtained);m.elto_type=e.toLowerCase();m.elto_id=g[e][a].id;m.elto_op="=";n.result.push(m);if(m.fulfill===false){n.errors++}}}}return n}function simcore_simstate_diff_results(d,a){return simcore_simstate_check_results(d,a,true)}function simcore_simstate_diff_states(d,f){var a=simcore_simstate_state2checklist(d).split(";");var e=simcore_simstate_state2checklist(f).split(";");return e.filter(function(g){return !a.includes(g)}).join(";").trim()}function simcore_simstate_checkreport2txt(d){var e="";for(var a=0;a<d.length;a++){if(d[a].fulfill===false){e+=d[a].elto_type+"["+d[a].elto_id+"]='"+d[a].obtained+"' (expected '"+d[a].expected+"'), "}}return e}function simcore_simstate_checkreport2html(f,d){var g="";var a="green";if(typeof d==="undefined"){d=false}g+="<table style='margin:0 0 0 0;'        class='table table-hover table-bordered table-sm'><thead><tr><th>Type</th><th><span class='d-none d-sm-inline-flex'>Identification</span><span class='d-sm-none'>Id.</span></th><th><span class='d-none d-sm-inline-flex'>Values in the</span> clipboard <span class='d-none d-sm-inline-flex'>state</th><th><span class='d-none d-sm-inline-flex'>Values in the</span> selected <span class='d-none d-sm-inline-flex'>state</th></tr></thead><tbody>";for(var e=0;e<f.length;e++){if(f[e].fulfill===false){a="table-danger"}else{a="table-success"}if(d&&f[e].fulfill){continue}g+="<tr class="+a+"><td>"+f[e].elto_type+"</td><td>"+f[e].elto_id+"</td><td>"+f[e].elto_op+"&nbsp;"+f[e].expected+"</td><td>"+f[e].obtained+"</td></tr>"}g+="</tbody></table>";return g}var screen_content="";var keyboard_content="";function get_screen_content(){var a=null;if(typeof document!="undefined"){a=document.getElementById("kdb_con")}if(a!=null){screen_content=a.value}return screen_content}function set_screen_content(a){screen_content=a;if(typeof document=="undefined"){console.log("screen> "+screen_content);return}var d=null;if(typeof document!="undefined"){d=document.getElementById("kdb_con")}if(d!=null){d.value=a}}function get_keyboard_content(){if(typeof document=="undefined"){var a=require("readline-sync");var e=a.question("keyboard> ");keyboard_content=e.toString();return keyboard_content}var d=null;if(typeof document!="undefined"){d=document.getElementById("kdb_key")}if(d!=null){keyboard_content=d.value}return keyboard_content}function set_keyboard_content(d){keyboard_content=d;var a=null;if(typeof document!="undefined"){a=document.getElementById("kdb_key")}if(a!=null){a.value=d}}var show_main_memory_deferred=null;var show_main_memory_redraw=false;function show_main_memory(f,a,e,d){if(get_cfg("DBG_delay")>3){show_main_memory_redraw=e||show_main_memory_redraw}if(null!=show_main_memory_deferred){return}show_main_memory_redraw=e;show_main_memory_deferred=setTimeout(function(){if(show_main_memory_redraw==false){light_refresh_main_memory(f,a,d)}else{hard_refresh_main_memory(f,a,d)}show_main_memory_deferred=null;show_main_memory_updates=false},cfg_show_main_memory_delay)}function hard_refresh_main_memory(g,n,u){if(typeof document=="undefined"){return}var f="";var s="";var e="";var o="";var h=new Array();var p=get_simware();var q=new Object();for(var t in p.labels2){q[p.labels2[t]]=t}var d=new Object();var a=simhw_internalState("segments");for(skey in a){d[parseInt(a[skey].begin)]=skey}for(var t in g){s=main_memory_getword(q,h,g,t);e=d[parseInt(t)];if(typeof e!="undefined"){f+='<div style="position:sticky;top:0px;z-index:1;width:50%;background:#FFFFFF;"><b><small>'+e+"</small></b></div>"}o="<small>0x</small>"+pack5(h[3])+'<span class="d-none d-sm-inline-flex"> </span>-<span class="d-none d-sm-inline-flex"><small> 0x</small></span>'+pack5(h[0]);if(t==n){f+="<div class='row' id='addr"+t+"'     style='color:blue; font-size:small; font-weight:bold;    border-bottom: 1px solid lightgray !important'><div class='col-6 pr-2' align='right'  style='padding:5'>"+o+"</div><div class='col-6'      align='left'   style='padding:5' id='mpval"+t+"'>"+s+"</div></div>"}else{f+="<div class='row' id='addr"+t+"'     style='color:black; font-size:small; font-weight:normal; border-bottom: 1px solid lightgray !important'><div class='col-6 pr-2' align='right'  style='padding:5'>"+o+"</div><div class='col-6'      align='left'   style='padding:5' id='mpval"+t+"'>"+s+"</div></div>"}}if(typeof g[n]=="undefined"){f+="<div class='row' id='addr"+n+"'     style='color:blue; font-size:small; font-weight:bold; border-bottom: 1px solid lightgray !important'><div class='col-6 pr-2' align='right'  style='padding:5'>0x"+parseInt(n).toString(16)+"</div><div class='col-6'      align='left'   style='padding:5' id='mpval>"+n+"'>00 00 00 00</div></div>"}$("#memory_MP").html("<div class='container-fluid'>"+f+"</div>");var m=$("#addr"+n);if((u)&&(m.length>0)){var k=m[0].offsetTop;var m=$("#memory_MP");if(m.length>0){m[0].scrollTop=k-100}}old_main_addr=n}function main_memory_getword(g,a,h,e){if(typeof h[e]=="undefined"){return"00 00 00 00"}var f=h[e].toString(16);f=pack8(f);var d=0;for(d=0;d<4;d++){a[d]=(parseInt(e)+d).toString(16)}value2="";for(d=0;d<4;d++){labeli=g["0x"+a[3-d]];valuei=f[d*2]+f[d*2+1];if(typeof labeli!="undefined"){value2+='<span><span style="border:1px solid gray;">'+valuei+'</span><span class="badge badge-pill badge-info"      style="position:relative;top:-8px;">'+labeli+"</span></span>"}else{value2+=valuei+" "}}return value2}var old_main_addr=0;function light_refresh_main_memory(m,e,k){if(k){var d=new Array();var a=get_simware();var h=new Object();for(var g in a.labels2){h[a.labels2[g]]=g}var f=main_memory_getword(h,d,m,e);o1=$("#mpval"+e);o1.html(f)}o1=$("#addr"+old_main_addr);o1.css("color","black");o1.css("font-weight","normal");old_main_addr=e;o1=$("#addr"+old_main_addr);o1.css("color","blue");o1.css("font-weight","bold")}var show_control_memory_deferred=null;function show_control_memory(f,a,d,e){if(null!=show_control_memory_deferred){return}show_control_memory_deferred=setTimeout(function(){if(false==e){light_refresh_control_memory(f,a,d)}else{hard_refresh_control_memory(f,a,d,e)}show_control_memory_deferred=null},cfg_show_control_memory_delay)}function controlmemory_lineToString(f,a){var d="";for(var e in f[a]){if(1==f[a][e]){d+=e+" ";continue}if("NATIVE"==e){d+="&lt;native&gt; ";continue}if("NATIVE_JIT"==e){d+="&lt;built-in&gt; ";continue}d+=e+"="+parseInt(f[a][e]).toString(2)+" "}return d}function hard_refresh_control_memory(n,h,q,w){if(typeof document=="undefined"){return}var g="";var u="";var d=get_cfg("ICON_theme");var s=get_simware();var t=new Object();for(var v in s.firmware){t[s.firmware[v]["mc-start"]]=s.firmware[v]["name"]}var f="";var e="";var k="";var a=0;for(var v in n){u=controlmemory_lineToString(n,v);f="0x"+parseInt(v).toString(16);if(typeof t[v]!="undefined"){k=t[v];a=5-k.length;if(a>0){for(var m=0;m<a;m++){k=k+"&nbsp;"}}f='<span><span class="badge badge-pill badge-info text-monospace"       style="position:relative;top:4px;">'+k+'</span><span style="border:1px solid gray;">'+f+"</span></span>"}e="&nbsp;";if(true==h[v].breakpoint){e="<img alt='stop icon' height='22' src='images/stop/stop_"+d+".gif'>"}if(v==q){g+="<tr id='maddr"+v+"' class='d-flex'     style='color:blue; font-size:small; font-weight:bold'     onclick='dbg_set_breakpoint("+v+");              if (event.stopPropagation) event.stopPropagation();'><td             class='col-3 col-md-2 py-0' align='right'>"+f+"</td><td width='1%'  class='col-auto py-0 px-0' id='mcpin"+v+"'>"+e+"</td><td             class='col py-0'>"+u+"</td></tr>"}else{g+="<tr id='maddr"+v+"' class='d-flex'     style='color:black; font-size:small; font-weight:normal'     onclick='dbg_set_breakpoint("+v+");              if (event.stopPropagation) event.stopPropagation();'><td             class='col-3 col-md-2 py-0' align='right'>"+f+"</td><td width='1%'  class='col-auto py-0 px-0' id='mcpin"+v+"'>"+e+"</td><td             class='col py-0'>"+u+"</td></tr>"}}if(typeof n[q]=="undefined"){g+="<tr><td width='15%'><font style='color:blue; font-size:small; font-weight:bold'>0x"+parseInt(q).toString(16)+"</font></td><td><font style='color:blue; font-size:small; font-weight:bold'><b>&nbsp;</b></font></td></tr>"}$("#memory_MC").html("<center><table class='table table-hover table-sm'><tbody id='none'>"+g+"</tbody></table></center>");var p=$("#maddr"+q);if((w)&&(p.length>0)){var o=p[0].offsetTop;var p=$("#memory_MC");if(p.length>0){p[0].scrollTop=o}}old_mc_addr=q}var old_mc_addr=0;function light_refresh_control_memory(e,a,d){o1=$("#maddr"+old_mc_addr);o1.css("color","black");o1.css("font-weight","normal");old_mc_addr=d;o1=$("#maddr"+old_mc_addr);o1.css("color","blue");o1.css("font-weight","bold")}function firmware2html(A,C){var p=simhw_internalState("filter_signals");var E="<tr bgcolor='#FF9900'><td bgcolor='white'     style='border-style: solid; border-width:0px; border-color:lightgray;'></td><td bgcolor='lightblue' style='border-style: solid; border-width:1px; border-color:lightgray;'>co</td><td bgcolor='#FFCC00'   style='border-style: solid; border-width:1px; border-color:lightgray;' align='center'><small><b>&#181;dir</b></small></td><td bgcolor='white'     style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;&nbsp;</td>";var B=1;for(var D=0;D<p.length;D++){var t=p[D].split(",")[0];E+="<td align='center' style='border-style: solid; border-width:1px;'><small><b>"+simhw_sim_signals()[t].name+"</b></small></td>";B++}E+="</tr>";var x="<center>";x+="<table style='table-layout:auto; border-style: solid: border-width:0px; border-collapse:collapse;'>";var y=0;var n="";var m="";var G="";for(var D=0;D<A.length;D++){var w=A[D]["mc-start"];var f=A[D].microcode;for(j=0;j<f.length;j++){if(++y%10==1){x=x+E}m="";if(typeof A[D].co!="undefined"){m=parseInt(A[D].co,2)}var u=A[D].signature.split(",")[0];n="";if(j==0){n+="<td style='border-style: solid; border-width:0px; border-color:lightgray;'><span class='badge badge-pill badge-secondary float-left'>"+u+"</span>&nbsp;</td><td style='border-style: solid; border-width:1px; border-color:lightgray;'>"+m+"</td>"}else{n+="<td style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;</td><td style='border-style: solid; border-width:1px; border-color:lightgray;'>&nbsp;</td>"}if(C){G="0x"+(w+j).toString(16)}else{G=w+j}n+="<td align='center'  style='border-style: solid; border-width:1px; border-color:lightgray;' bgcolor='white'>"+G+"</td><td bgcolor='white' style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;</td>";var g=f[j];for(var z=0;z<p.length;z++){var t=p[z].split(",")[0];var F=parseInt(simhw_sim_signals()[t].default_value);var q=false;if((typeof g[t]!="undefined")&&(!isNaN(parseInt(g[t])))){F=parseInt(g[t]);q=true}if((t=="SELA"||t=="SELB"||t=="SELC")&&(typeof g.MADDR!="undefined")&&(!isNaN(parseInt(g.MADDR)))){var d=parseInt(g.MADDR).toString(2);d="000000000000".substring(0,12-d.length)+d+"000";if(t=="SELA"){F=parseInt(d.substring(0,5),2);q=true}if(t=="SELB"){F=parseInt(d.substring(5,10),2);q=true}if(t=="SELC"){F=parseInt(d.substring(10,15),2);q=true}}if(C){var d=F.toString(2);var v=parseInt(simhw_sim_signals()[t].nbits);F="00000000000000000000000000000000".substring(0,v-d.length)+d;var H=p[z].split(",")[1];var e=F.substring(0,H);var a=F.substring(H);F="<font color=green>"+e+"</font>"+a}if(q){n+="<td align='center' style='border-style: solid; border-width:1px;'><b>"+F+"</b></td>"}else{n+="<td align='center' style='border-style: solid; border-width:1px;'><font color='grey'>"+F+"</font></td>"}}x+="<tr>"+n+"</tr>"}}x+="</table></center>";return x}function labels2html_aux(a,h){var g="";var e="";for(var d=3;d>=0;d--){e="0x"+(parseInt(h)+d).toString(16);if(typeof a[e]!="undefined"){for(var f=0;f<a[e].length;f++){g=g+"<span class='badge badge-pill badge-secondary float-left'>"+a[e][f]+"</span>"}}else{g=g+"&nbsp;"}}return g}function mp2html(d,m,h){var g=new Object();for(var e in m){if(typeof g[m[e]]=="undefined"){g[m[e]]=new Array()}g[m[e]].push(e)}var a="";a+="<center><table style='table-layout:auto; border-style: solid; border-width:0px;'><tr><th style='border-style: solid; border-width:0px;'>labels</th><th style='border-style: solid; border-width:1px;'>address</th><th style='border-style: solid; border-width:1px;'><table border=0 width=100%><tr align=center>  <td width='25%' align='center'><small><b>byte 3</b></small></td>  <td width='25%' align='center'><small><b>byte 2</b></small></td>  <td width='25%' align='center'><small><b>byte 1</b></small></td>  <td width='25%' align='center'><small><b>byte 0</b></small></td></tr><tr>  <td width='12%' align='center' >&nbsp;<sup>31&nbsp;&nbsp;......&nbsp;&nbsp;24</sup>&nbsp;</td>  <td width='12%' align='center' >&nbsp;<sup>23&nbsp;&nbsp;......&nbsp;&nbsp;16</sup>&nbsp;</td>  <td width='12%' align='center' >&nbsp;<sup>15&nbsp;&nbsp;......&nbsp;&nbsp;8</sup>&nbsp;</td>  <td width='12%' align='center' >&nbsp;<sup>7&nbsp;&nbsp;......&nbsp;&nbsp;0</sup>&nbsp;</td></tr></table><th style='border-style: solid; border-width:0px;' align='right'>&nbsp;&nbsp;segment</th></tr>";var f="white";for(var p in h){c_begin=parseInt(h[p].begin);c_end=parseInt(h[p].end);f=h[p].color;rows=0;var n="";for(var k=c_begin;k<c_end;k++){c="0x"+k.toString(16);if(typeof d[c]=="undefined"){continue}if(0==rows){a+="<tr style=\"font-family:'Consolas'; font-size:11pt;\"><td align='right'  style='border-style: solid; border-width:0px;'>"+labels2html_aux(g,c)+"</td><td                style='border-style: solid; border-width:1px;' bgcolor="+f+">"+c.toUpperCase()+"</td><td                style='border-style: solid; border-width:1px;' bgcolor="+f+">"+d[c].substr(0,8)+"&nbsp;"+d[c].substr(8,8)+"&nbsp;"+d[c].substr(16,8)+"&nbsp;"+d[c].substr(24,8)+"</td><td rowspan="}else{n+="<tr style=\"font-family:'Consolas'; font-size:11pt;\"><td align='right'  style='border-style: solid; border-width:0px;'>"+labels2html_aux(g,c)+"</td><td                style='border-style: solid; border-width:1px;' bgcolor="+f+">"+c.toUpperCase()+"</td><td                style='border-style: solid; border-width:1px;' bgcolor="+f+">"+d[c].substr(0,8)+"&nbsp;"+d[c].substr(8,8)+"&nbsp;"+d[c].substr(16,8)+"&nbsp;"+d[c].substr(24,8)+"</td></tr>"}rows++}if(0==rows){a+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td style='border-style: solid; border-width:1px;' bgcolor="+f+">0x"+parseInt(h[p].begin).toString(16).toUpperCase()+"</td><td style='border-style: solid; border-width:1px;' bgcolor="+f+">&nbsp;</td><td rowspan=";n+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td style='border-style: solid; border-width:1px;' bgcolor="+f+">0x"+parseInt(h[p].end).toString(16).toUpperCase()+"</td><td style='border-style: solid; border-width:1px;' bgcolor="+f+">&nbsp;</td><td>&nbsp;</td></tr>";rows=2}a+=rows+" align=right>"+h[p].name+"&nbsp;</td></tr>"+n;if(h[p].name!=".stack"){a+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td valign='middle' align='center' height='25px'>...</td><td valign='middle' align='center' height='25px'>...</td><td>&nbsp;</td></tr>"}}a+="</table></center><br>";return a}function segments2html(d){var f="<br>";f+=" <center> <table height='400px'> <tr> <td><table style='border-style: solid' border='1' width='100%' height='100%'>";for(var a in d){if(d[a].name!=".stack"){f+="<tr><td valign='middle' align='center' height='60px' bgcolor='"+d[a].color+"'>"+d[a].name+"</td></tr><tr><td valign='middle' align='center' height='25px'>...</td></tr>"}}f+="<tr><td valign='middle' align='center' bgcolor='"+d[".stack"].color+"'>"+d[".stack"].name+"</td></tr></table> </td> <td width='20px'>&nbsp;</td> <td> <table style='border-style: solid; border-width:0px; width:100%; height:100%'>";var g="";var e="";for(a in d){g="<tr>    <td valign='top' align='left' height='30px' style=''>    <div id='compile_begin_"+d[a].name+"'>"+d[a].begin+"</div>    </td> </tr> <tr>    <td valign='bottom' align='left' height='30px' style=''>    <div id='compile_end_"+d[a].name+"'>"+d[a].end+"</div>    </td> </tr>";if(d[a].name!=".stack"){f+=g+"<tr><td valign='middle' align='center' height='25px'>...</td></tr>"}else{e=g}}f+=e+" </table> </td> </tr> </table> </center>";return f}function assembly2html(e,m,h,g){var f="";var q="";var n="";var d="#F0F0F0";var a="";var s=new Object();for(l in m){if(typeof s[m[l]]=="undefined"){s[m[l]]=new Array()}s[m[l]].push(l)}var p=new Object();for(l in h){laddr="0x"+h[l].begin.toString(16);p[laddr]=l}a+="<center><table data-role='table' class='table ui-responsive table-sm'><tbody>";for(l in g){if(d=="#F0F0F0"){d="#F8F8F8"}else{d="#F0F0F0"}g[l].bgcolor=d;q=g[l].source;n=g[l].source_original;f="";if(typeof s[l]!="undefined"){for(var k=0;k<s[l].length;k++){f=f+"<span class='badge badge-info'>"+s[l][k]+"</span>"}}if(typeof p[l]!="undefined"){a+="<tr bgcolor='#FEFEFE'><td colspan='7' style='line-height:0.3;' align='left'><small><font color='gray'>"+p[l]+"</font></small></td>"}"</tr>";a+="<tr id='asmdbg"+l+"' bgcolor='"+g[l].bgcolor+"'    onclick='asmdbg_set_breakpoint("+l+");              if (event.stopPropagation) event.stopPropagation();'><td                                             width='2%'></td><td class='asm_break show'  style='line-height:0.9; padding:5 0 0 0;' width='10%' align='center' id='bp"+l+"'>&nbsp;</td><td class='asm_addr show'   style='line-height:0.9;' width='15%'>"+l+"</td><td class='asm_label2 show' style='line-height:0.9;' width='10%' align=right>"+f+"</td><td class='asm_pins show'   style='line-height:0.9;' width='20%' align=left>"+n+"</td><td class='asm_label1 show' style='line-height:0.9;' width='10%' align=right>"+f+"</td><td class='asm_ins show'    style='line-height:0.9;' width='25%' align=left>"+q+"</td></tr>"}a+="</tbody></table></center>";return a}var show_asmdbg_pc_deferred=null;function innershow_asmdbg_pc(){fullshow_asmdbg_pc();show_asmdbg_pc_deferred=null}function show_asmdbg_pc(){if(get_cfg("DBG_delay")>5){return fullshow_asmdbg_pc()}if(null==show_asmdbg_pc_deferred){show_asmdbg_pc_deferred=setTimeout(innershow_asmdbg_pc,cfg_show_asmdbg_pc_delay)}}var old_addr=0;function fullshow_asmdbg_pc(){if(typeof document=="undefined"){return}var e=null;var d=get_value(simhw_sim_state("REG_PC"));var f="0x"+d.toString(16);var a=simhw_internalState("FIRMWARE");if(typeof a.assembly[old_addr]!="undefined"){e=$("#asmdbg"+old_addr);e.css("background-color",a.assembly[old_addr].bgcolor)}else{for(l in a.assembly){e=$("#asmdbg"+l);e.css("background-color",a.assembly[l].bgcolor)}}old_addr=f;e=$("#asmdbg"+f);e.css("background-color","#00EE88");return e}function asmdbg_set_breakpoint(h){var d=get_cfg("ICON_theme");var a="0x"+h.toString(16);var e=simhw_internalState("FIRMWARE");var g=document.getElementById("bp"+a);var f=e.assembly[a].breakpoint;if(f===true){f=false;g.innerHTML="&nbsp;"}else{f=true;g.innerHTML="<img alt='stop icon' height=22 src='images/stop/stop_"+d+".gif'>"}e.assembly[a].breakpoint=f}function dbg_set_breakpoint(f){var a=get_cfg("ICON_theme");var e=document.getElementById("mcpin"+f);var d=simhw_internalState_get("MC_dashboard",f).breakpoint;if(d===true){d=false;e.innerHTML="&nbsp;"}else{d=true;e.innerHTML="<img alt='stop icon' height='22' src='images/stop/stop_"+a+".gif'>"}simhw_internalState_get("MC_dashboard",f).breakpoint=d;if(d&&("instruction"==get_cfg("DBG_level"))){wepsim_notify_success("<strong>INFO</strong>","Please remember to change configuration to execute at microinstruction level.")}}function show_dbg_mpc(){show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),get_value(simhw_sim_state("REG_MICROADDR")),false)}var show_dbg_ir_deferred=null;function show_dbg_ir(a){if(null!=show_dbg_ir_deferred){return}show_dbg_ir_deferred=setTimeout(function(){fullshow_dbg_ir(a);show_dbg_ir_deferred=null},cfg_show_dbg_ir_delay)}function fullshow_dbg_ir(a){if(typeof document=="undefined"){return}var d=document.getElementById("svg_p");if(d!=null){d=d.contentDocument}if(d!=null){d=d.getElementById("tspan3899")}if(d!=null){d.innerHTML=a}var d=document.getElementById("svg_cu");if(d!=null){d=d.contentDocument}if(d!=null){d=d.getElementById("text3611")}if(d!=null){d.innerHTML=a}}function request_html_url(a){var d=null;if(false==is_mobile()){if(navigator.onLine){d=fetch(a)}else{d=caches.match(a).then()}}else{d=$.ajax(a,{type:"GET",dataType:"html"})}return d}function update_div_frompartialhtml(a,e,f){var d="<br>Sorry, No more details available for this element.<p>\n";if(""==f){$(a).html(d)}else{$(a).html(f)}if((""==f)||(""==e)){return}var g=$(a).filter(e).html();if(typeof g=="undefined"){g=$(a).find(e).html()}if(typeof g=="undefined"){g=d}$(a).html(g)}function resolve_html_url(a,e,d,f){return request_html_url(e).then(function(g){if(typeof g=="object"){g.text().then(function(h){update_div_frompartialhtml(a,d,h);f()})}else{update_div_frompartialhtml(a,d,g);f()}})}function update_signal_loadhelp(d,g,f){var a=get_cfg("ws_idiom");var e="help/"+g+"/signals-"+a+".html";resolve_html_url(d,e,"#"+f,function(){$(d).trigger("create")});ga("send","event","help","help.signal","help.signal."+g+"."+f)}function update_checker_loadhelp(d,f){var a=get_cfg("ws_idiom");var e="help/simulator-"+a+".html";resolve_html_url(d,e,"#"+f,function(){$(d).trigger("create")});ga("send","event","help","help.checker","help.checker."+f)}function simcoreui_do_notify(k,m,a,d){var f=$("#alerts-container");if(f.length==0){f=$('<div id="alerts-container"      class="col-xs-10 offset-xs-1  col-md-8 offset-md-2  col-lg-6 offset-lg-3"      style="position:fixed; top:10%; z-index:256;">');$("body").append(f)}var e=$('<button type="button" class="close" data-dismiss="alert">');var h=$('<div class="alert alert-'+a+' shadow">');f.prepend(h.append(e.append("&times;")).append(m));if(d!=0){window.setTimeout(function(){h.alert("close")},d)}var g="Notification type "+a+" and title "+k+":"+m+". ";g=$("</p>").html(g).text();simcoreui_voice_speak(g)}var simcoreui_notifications=[];function simcoreui_notifications_get(){return simcoreui_notifications}function simcoreui_notifications_reset(){simcoreui_notifications=[]}function simcoreui_notify(e,f,a,d){simcoreui_do_notify(e,f,a,d);simcoreui_notifications.push({title:$("<p>").html(e).text(),message:$("<p>").html(f).text(),type:a,date:new Date().getTime()})}function simcoreui_notify_close(){$(".alert").alert("close")}function simcoreui_notify_notifications(){var e="";var d=null;e+='<br><div class="alert alert-light p-0 m-0" role="alert">+ Recent</div><div class="card" style="max-height:70vh; overflow:auto; -webkit-overflow-scrolling: touch;"><ul class="list-group list-group-flush">';for(var a=simcoreui_notifications.length-1;a!=0;a--){d=new Date(simcoreui_notifications[a].date);e+='<li class="list-group-item list-group-item-'+simcoreui_notifications[a].type+'"><h5 class="m-0"><span class="badge">('+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()+"."+d.getMilliseconds()+')</span><span class="badge">['+d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()+']</span></h5><span class="text-monospace">'+simcoreui_notifications[a].title+":</span>"+simcoreui_notifications[a].message+"</li>"}e+='</ul></div><div class="alert alert-light p-0 m-0" role="alert">- Recent</div>';simcoreui_notify_close();simcoreui_do_notify("notifications",e,"light",0)};